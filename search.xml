<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title></title>
      <link href="/posts/0/"/>
      <url>/posts/0/</url>
      
        <content type="html"><![CDATA[<hr><p>title: /proc/sysrq-trigger的妙用<br>toc: true<br>date: 2024-06-21 03:07:54<br>tags:</p><ul class="lvl-0"><li class="lvl-2">Linux<br>categories:</li><li class="lvl-2">Linux</li></ul><hr><blockquote><p>sysrq被称为“魔术组合键”，只要内核没有完全锁住，不管内核在做什么事情，使用这些组合键都可以搜集包括系统内存使用、CPU任务处理、进程运行状态等系统运行信息。注意：信息的输出都在/var/log/message下</p></blockquote><p>Linux如何模拟崩溃？如何强制关机？这时候就可以使用到本文提到的<code>/proc/sysrq-trigger</code>文件了。</p><ul class="lvl-0"><li class="lvl-2"><p>故意让系统崩溃，注意这不是重启，崩溃后只能从进行硬重启才能重连上系统。（产生空指针paincz事件，触发kdump，收集vmcore，会在/var/crash目录生成）</p></li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">echo</span> <span class="string">&quot;c&quot;</span> &gt; /proc/sysrq-trigger</span><br></pre></td></tr></table></figure><ul class="lvl-0"><li class="lvl-2"><p>立即重新启动计算机</p></li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">echo</span> <span class="string">&quot;b&quot;</span> &gt; /proc/sysrq-trigger</span><br></pre></td></tr></table></figure><ul class="lvl-0"><li class="lvl-2"><p>立即关闭计算机</p></li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">echo</span> <span class="string">&quot;o&quot;</span> &gt; /proc/sysrq-trigger</span><br></pre></td></tr></table></figure><ul class="lvl-0"><li class="lvl-2"><p>导出内存分配的信息 （可以用/var/log/message 查看）</p></li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">echo</span> <span class="string">&quot;m&quot;</span> &gt; /proc/sysrq-trigger</span><br></pre></td></tr></table></figure><ul class="lvl-0"><li class="lvl-2"><p>导出当前CPU寄存器信息和标志位的信息</p></li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">echo</span> <span class="string">&quot;p&quot;</span> &gt; /proc/sysrq-trigger</span><br></pre></td></tr></table></figure><ul class="lvl-0"><li class="lvl-2"><p>导出线程状态信息</p></li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">echo</span> <span class="string">&quot;t&quot;</span> &gt; /proc/sysrq-trigger</span><br></pre></td></tr></table></figure><ul class="lvl-0"><li class="lvl-2"><p>故意让系统溃</p></li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">echo</span> <span class="string">&quot;c&quot;</span> &gt; /proc/sysrq-trigger</span><br></pre></td></tr></table></figure><ul class="lvl-0"><li class="lvl-2"><p>立即重新挂载所有的文件系统</p></li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">echo</span> <span class="string">&quot;s&quot;</span> &gt; /proc/sysrq-trigger</span><br></pre></td></tr></table></figure><ul class="lvl-0"><li class="lvl-2"><p>立即重新挂载所有的文件系统为只读</p></li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">echo</span> <span class="string">&quot;u&quot;</span> &gt; /proc/sysrq-trigger</span><br></pre></td></tr></table></figure><p>为了安全起见，在红帽企业版Linux里面，默认SysRq组合键是关闭的。 打开这个功能，运行：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">echo</span> 1 &gt; /proc/sys/kernel/sysrq</span><br></pre></td></tr></table></figure><p>关闭这个功能：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">echo</span> 0 &gt; /proc/sys/kernel/sysrq</span><br></pre></td></tr></table></figure><p>如果想让此功能一直生效，在/etc/sysctl.conf里面设置kernel.sysrq的值为1. 重新启动以后，此功能将会自动打开。</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>Jquery禁用按钮，防止重复提交</title>
      <link href="/posts/17c655b1/"/>
      <url>/posts/17c655b1/</url>
      
        <content type="html"><![CDATA[<p>使用<code>对象.prop(&quot;disabled&quot;,true)</code>可以进行禁用，<code>对象.prop(&quot;disabled&quot;,false)</code>取消禁用。</p><ul class="lvl-0"><li class="lvl-2">html代码如下</li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">id</span>=<span class="string">&quot;editEventForm&quot;</span> <span class="attr">novalidate</span>=<span class="string">&quot;novalidate&quot;</span>&gt;</span></span><br><span class="line">.....</span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;card-footer&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;javascript:history.go(-1);&quot;</span> <span class="attr">class</span>=<span class="string">&quot;btn btn-success float-right&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">i</span>&gt;</span> 返回<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">button</span> <span class="attr">type</span>=<span class="string">&quot;submit&quot;</span> <span class="attr">class</span>=<span class="string">&quot;btn btn-primary float-right&quot;</span> <span class="attr">style</span>=<span class="string">&quot;margin-right:5px;&quot;</span>&gt;</span>提交<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br></pre></td></tr></table></figure><ul class="lvl-0"><li class="lvl-2">js代码</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line">    $(<span class="string">&quot;#editEventForm button[type=&#x27;submit&#x27;]&quot;</span>).<span class="title function_">click</span>(<span class="keyword">function</span>(<span class="params">e</span>)&#123;</span><br><span class="line">            $(<span class="string">&quot;#editEventForm button[type=&#x27;submit&#x27;]&quot;</span>).<span class="title function_">prop</span>(<span class="string">&quot;disabled&quot;</span>,<span class="literal">true</span>)</span><br><span class="line">    &#125;)</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure><blockquote><p>注意：如果您的提交按钮设置了ID，可以使用$(“#ID名称”).prop(“disabled”,true)来操作，这样就不用写这么长了。</p></blockquote><ul class="lvl-0"><li class="lvl-2"><p>可以在提交成功或失败后，执行取消禁用</p></li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$(<span class="string">&quot;#editEventForm button[type=&#x27;submit&#x27;]&quot;</span>).<span class="title function_">prop</span>(<span class="string">&quot;disabled&quot;</span>,<span class="literal">false</span>)</span><br></pre></td></tr></table></figure><h2 id="参考资料">参考资料</h2><blockquote><ul class="lvl-1"><li class="lvl-2"><p><a href=""></a></p></li><li class="lvl-2"><p><a href=""></a></p></li></ul></blockquote>]]></content>
      
      
      <categories>
          
          <category> 前端学习 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Jquery </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>systemd怎么查看开机自启动服务</title>
      <link href="/posts/614dd6d8/"/>
      <url>/posts/614dd6d8/</url>
      
        <content type="html"><![CDATA[<p>在CentOS 7及更高的版本中，使用<code>chkconfig</code>命令查看开机自启动信息时，发现只有几个服务被<code>SysV</code>管理的服务，没有包括<code>systemd</code>管理的服务。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">[root@kvm-hkcloud01 var]<span class="comment"># chkconfig --list</span></span><br><span class="line"></span><br><span class="line">Note: This output shows SysV services only and does not include native</span><br><span class="line">      systemd services. SysV configuration data might be overridden by native</span><br><span class="line">      systemd configuration.</span><br><span class="line"></span><br><span class="line">      If you want to list systemd services use <span class="string">&#x27;systemctl list-unit-files&#x27;</span>.</span><br><span class="line">      To see services enabled on particular target use</span><br><span class="line">      <span class="string">&#x27;systemctl list-dependencies [target]&#x27;</span>.</span><br><span class="line"></span><br><span class="line">netconsole      0:off   1:off   2:off   3:off   4:off   5:off   6:off</span><br><span class="line">network         0:off   1:off   2:on    3:on    4:on    5:on    6:off</span><br><span class="line">[root@kvm-hkcloud01 var]<span class="comment">#</span></span><br></pre></td></tr></table></figure><p>如果需要查看被<code>systemd</code>管理的服务，可以使用以下命令进行查询。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@kvm-hkcloud01 var]<span class="comment"># systemctl list-unit-files</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>Linux文件的ACL</title>
      <link href="/posts/de677c90/"/>
      <url>/posts/de677c90/</url>
      
        <content type="html"><![CDATA[<p>在Linux中，一般使用<code>chmod</code>命令对属主、用户组、其它用户为类别对文件权限进行控制，这种方式较为粗略，但也能满足日常需求。在一些特殊的场景中，如只允许某些用户能访问文件的场景，如果使用<code>chmod</code>命令进行配置，一般是将这部分用户加入到组中，然后配置组的权限。</p><p>在Linux中，还提供了一种精细化的文件权限控制方式，那就是ACL（Access Control List）</p><blockquote><p>在没有ACL技术之前,Linux系统对文件的权限控制仅可划分文件的属主、用户组、其他用户三类,随着技术的发展,传统的文件权限控制已经无法适应复杂场景下的权限控制需求,比如说一个部门(即一个用户组group)存在有多名员工(即用户,user01、user02…),针对于部门内不同职责的员工,会为其赋予不同的权限,如为user01赋予可读写权限,为user02赋予只读权限,不为user03赋予任何权限,此时由于这些员工属于同一部门,就无法为这些不同的员工进行权限的细化。为此ACL(Access Control List)访问控制列表技术应运而生,使用ACL权限控制可以提供常见权限(如rwx、ugo)权限之外的权限设,置,可以针对单一用户或组来设置特定的权限。</p></blockquote><p>使用ACL必须要有文件系统的支持，目前ext3/ext4/xfs/zfs都支持文件ACL。</p><h1>相关命令</h1><ul class="lvl-0"><li class="lvl-2"><p>setfacl：设置文件的acl</p></li><li class="lvl-2"><p>getfacl：获取文件的acl</p></li><li class="lvl-2"><p>chacl：更改文件或目录的ACL</p></li></ul><h1>操作实验</h1><h2 id="用户权限配置">用户权限配置</h2><ul class="lvl-0"><li class="lvl-2"><p>user01创建文件并配置600权限</p></li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">[root@txy201-51 data]<span class="comment"># su user01</span></span><br><span class="line">[user01@txy201-51 data]$ <span class="built_in">echo</span> 51yunwei.top &gt; acltest</span><br><span class="line">[user01@txy201-51 data]$ <span class="built_in">chmod</span> 600 acltest</span><br><span class="line">[user01@txy201-51 data]$ getfacl acltest</span><br><span class="line"><span class="comment"># file: acltest</span></span><br><span class="line"><span class="comment"># owner: user01</span></span><br><span class="line"><span class="comment"># group: user01</span></span><br><span class="line">user::rw-</span><br><span class="line">group::---</span><br><span class="line">other::---</span><br><span class="line"></span><br></pre></td></tr></table></figure><ul class="lvl-0"><li class="lvl-2"><p>测试user02有没有访问权限（无）</p></li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[root@txy201-51 data]<span class="comment"># su user02</span></span><br><span class="line">[user02@txy201-51 data]$ <span class="built_in">cat</span> acltest</span><br><span class="line"><span class="built_in">cat</span>: acltest: 权限不够</span><br></pre></td></tr></table></figure><ul class="lvl-0"><li class="lvl-2"><p>使用setfacl给user02配置权限</p></li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">[user01@txy201-51 data]$ setfacl -m user02:r acltest</span><br><span class="line">[user01@txy201-51 data]$ getfacl acltest</span><br><span class="line"><span class="comment"># file: acltest</span></span><br><span class="line"><span class="comment"># owner: user01</span></span><br><span class="line"><span class="comment"># group: user01</span></span><br><span class="line">user::rw-</span><br><span class="line">user:user02:r--</span><br><span class="line">group::---</span><br><span class="line">mask::r--</span><br><span class="line">other::---</span><br></pre></td></tr></table></figure><ul class="lvl-0"><li class="lvl-2"><p>user02测试是否能读（可以）、写文件（不可以）</p></li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[root@txy201-51 data]<span class="comment"># su user02</span></span><br><span class="line">[user02@txy201-51 data]$ <span class="built_in">cat</span> acltest</span><br><span class="line">51yunwei.top</span><br><span class="line">[user02@txy201-51 data]$ <span class="built_in">echo</span> www.51yunwei.top &gt;&gt; acltest</span><br><span class="line">bash: acltest: 权限不够</span><br></pre></td></tr></table></figure><ul class="lvl-0"><li class="lvl-2"><p>修改user02的权限为读写</p></li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[root@txy201-51 data]<span class="comment"># setfacl -m user02:rw acltest</span></span><br><span class="line">[root@txy201-51 data]<span class="comment"># su user02</span></span><br><span class="line">[user02@txy201-51 data]$ <span class="built_in">echo</span> www.51yunwei.top &gt;&gt; acltest</span><br><span class="line">[user02@txy201-51 data]$ <span class="built_in">cat</span> acltest</span><br><span class="line">51yunwei.top</span><br><span class="line">www.51yunwei.top</span><br></pre></td></tr></table></figure><ul class="lvl-0"><li class="lvl-2"><p>删除权限</p></li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">[root@txy201-51 data]<span class="comment"># setfacl -x user02 acltest</span></span><br><span class="line">[root@txy201-51 data]<span class="comment"># getfacl acltest</span></span><br><span class="line"><span class="comment"># file: acltest</span></span><br><span class="line"><span class="comment"># owner: user01</span></span><br><span class="line"><span class="comment"># group: user01</span></span><br><span class="line">user::rw-</span><br><span class="line">group::---</span><br><span class="line">mask::r--</span><br><span class="line">other::---</span><br></pre></td></tr></table></figure><h2 id="组权限">组权限</h2><p>setfacl默认对用户acl进行管理，如果要为组设置acl，只需要加上一个组的标识<code>g:</code>即可。</p><ul class="lvl-0"><li class="lvl-2"><p>当前user03没有访问权限</p></li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[root@txy201-51 data]<span class="comment"># id user03</span></span><br><span class="line">uid=1005(user03) gid=1006(user03) 组=1006(user03),1004(user01)</span><br><span class="line">[root@txy201-51 data]<span class="comment"># su user03</span></span><br><span class="line">[user03@txy201-51 data]$ <span class="built_in">cat</span> acltest</span><br><span class="line"><span class="built_in">cat</span>: acltest: 权限不够</span><br></pre></td></tr></table></figure><ul class="lvl-0"><li class="lvl-2"><p>给user01组设置权限后，user03就能访问文件了（user03也在user01组）</p></li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[root@txy201-51 data]<span class="comment"># setfacl -m g:user01:r acltest</span></span><br><span class="line">[root@txy201-51 data]<span class="comment"># su user03</span></span><br><span class="line">[user03@txy201-51 data]$ <span class="built_in">cat</span> acltest</span><br><span class="line">51yunwei.top</span><br><span class="line">www.51yunwei.top</span><br></pre></td></tr></table></figure><h1>系统文件权限的备份与恢复</h1><p>在运维过程中，最怕误操作将全局的文件权限给修改了，比如执行了<code>chmod 777 -R /</code>或<code>chown -R user01:user01 /</code>，那如果真的遇到了这种情况我们应该怎么做呢？在日常运维中，我们可以把系统权限信息进行备份，在必要时进行恢复。</p><ul class="lvl-0"><li class="lvl-2"><p>备份文件权限</p></li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">getfacl -p &gt; 备份文件</span><br></pre></td></tr></table></figure><ul class="lvl-0"><li class="lvl-2"><p>恢复文件权限</p></li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">setfacl --restore=备份的文件</span><br></pre></td></tr></table></figure><h2 id="实战篇">实战篇</h2><ul class="lvl-0"><li class="lvl-2"><p>实验目录<code>/tmp/data</code>，文件结构如下</p></li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">[root@txy201-51 data]<span class="comment"># ls -lR</span></span><br><span class="line">.:</span><br><span class="line">总用量 8</span><br><span class="line">-rw-r-----+ 1 user01 user01   30 6月  20 16:13 acltest</span><br><span class="line">drwxr-xr-x  2 root   root   4096 6月  20 16:30 yunwei</span><br><span class="line"></span><br><span class="line">./yunwei:</span><br><span class="line">总用量 0</span><br><span class="line">-rw-r--r-- 1 root root 0 6月  20 16:30 51yunwei</span><br><span class="line">-rw-r--r-- 1 root root 0 6月  20 16:30 top</span><br><span class="line">-rw-r--r-- 1 root root 0 6月  20 16:30 www</span><br><span class="line">[root@txy201-51 data]<span class="comment">#</span></span><br></pre></td></tr></table></figure><ul class="lvl-0"><li class="lvl-2"><p>将目录的权限备份到<code>tmp_data_acl.bak下</code></p></li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@txy201-51 data]<span class="comment"># getfacl -R -p /tmp/data &gt; tmp_data_acl.bak</span></span><br></pre></td></tr></table></figure><ul class="lvl-0"><li class="lvl-2"><p>模拟误操作，修改目录下的所有权限和属主</p></li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">[root@txy201-51 data]<span class="comment"># chown user01:user01 -R /tmp/data</span></span><br><span class="line">[root@txy201-51 data]<span class="comment"># chmod 400 -R /tmp/data</span></span><br><span class="line">[root@txy201-51 data]<span class="comment"># ls -lR</span></span><br><span class="line">.:</span><br><span class="line">总用量 12</span><br><span class="line">-r--------+ 1 user01 user01   30 6月  20 16:13 acltest</span><br><span class="line">-r--------  1 user01 user01  670 6月  20 17:24 tmp_data_acl.bak</span><br><span class="line">dr--------  2 user01 user01 4096 6月  20 16:30 yunwei</span><br><span class="line"></span><br><span class="line">./yunwei:</span><br><span class="line">总用量 0</span><br><span class="line">-r-------- 1 user01 user01 0 6月  20 16:30 51yunwei</span><br><span class="line">-r-------- 1 user01 user01 0 6月  20 16:30 top</span><br><span class="line">-r-------- 1 user01 user01 0 6月  20 16:30 www</span><br><span class="line">[root@txy201-51 data]<span class="comment">#</span></span><br></pre></td></tr></table></figure><ul class="lvl-0"><li class="lvl-2"><p>恢复权限，可以看到权限已恢复正常。</p></li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">[root@txy201-51 data]<span class="comment"># setfacl --restore=tmp_data_acl.bak</span></span><br><span class="line">[root@txy201-51 data]<span class="comment"># ls -lR</span></span><br><span class="line">.:</span><br><span class="line">总用量 12</span><br><span class="line">-rw-rw----+ 1 user01 user01   30 6月  20 16:13 acltest</span><br><span class="line">-rw-r--r--  1 root   root    670 6月  20 17:24 tmp_data_acl.bak</span><br><span class="line">drwxr-xr-x  2 root   root   4096 6月  20 16:30 yunwei</span><br><span class="line"></span><br><span class="line">./yunwei:</span><br><span class="line">总用量 0</span><br><span class="line">-rw-r--r-- 1 root root 0 6月  20 16:30 51yunwei</span><br><span class="line">-rw-r--r-- 1 root root 0 6月  20 16:30 top</span><br><span class="line">-rw-r--r-- 1 root root 0 6月  20 16:30 www</span><br><span class="line">[root@txy201-51 data]<span class="comment">#</span></span><br></pre></td></tr></table></figure><blockquote><p>如果没有提前备份的话，可以同其它相同系统做一次备份，将文件拷贝过来做恢复，对于没在备份中的文件，权限不会被修改。</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> Linux </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Linux </tag>
            
            <tag> 权限 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Linux中的用户ID会不会重复？</title>
      <link href="/posts/a0e0543a/"/>
      <url>/posts/a0e0543a/</url>
      
        <content type="html"><![CDATA[<p><code>UID</code>指的是用户的<code>ID</code>(User ID)，一个用户的UID标识一个给定用户，UID是用户的唯一标识符，通过UID可以区分不同的用户类别，比如UID为0的是超级用户，UID为1000-600000之间的是普通用户，而UID为1-999之间的是虚拟用户。</p><ul class="lvl-0"><li class="lvl-2">超级用户：也称为root用户，UID为0，拥有系统的完全控制权限，可以进行修改、删除文件等操作。</li><li class="lvl-2">普通用户：也成为一般用户，UID为1000-60000之间，可以对自己目录下的文件进行访问和修改，也可以对经过授权的文件进行访问。</li><li class="lvl-2">虚拟用户：也称为系统用户，UID为1-999之间，不提供密码登录系统，它们的存在主要是为了方便系统的管理。</li></ul><p>Linux中的用户ID会不会重复？会，可以人为将多个不用户的ID配置为重复的ID。</p><p><strong>用户在登录系统时，是通过UID来区分用户，而不是通过用户名来区分</strong><br>实验步骤：<br>1、创建一个UID为1000的用户user02，再创建一个相同id的user01，通过id命令，发现两个用户都显示为user02</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[root@kvm-hkcloud01 ~]<span class="comment"># useradd -u 1000 user02</span></span><br><span class="line">[root@kvm-hkcloud01 ~]<span class="comment"># useradd -u 1000 -o user01</span></span><br><span class="line">[root@kvm-hkcloud01 ~]<span class="comment"># id user01</span></span><br><span class="line">uid=1000(user02) gid=1002(user02) <span class="built_in">groups</span>=1002(user02)</span><br><span class="line">[root@kvm-hkcloud01 ~]<span class="comment"># id user02</span></span><br><span class="line">uid=1000(user02) gid=1002(user02) <span class="built_in">groups</span>=1002(user02)</span><br></pre></td></tr></table></figure><p>2、切换到user01下，发现名称还是user02，但是组信息变为了user01的</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[root@kvm-hkcloud01 ~]<span class="comment"># su - user01</span></span><br><span class="line">Last login: Tue Jun 18 11:35:27 CST 2024 on pts/0</span><br><span class="line">[user02@kvm-hkcloud01 ~]$ <span class="built_in">id</span></span><br><span class="line">uid=1000(user02) gid=1003(user01) <span class="built_in">groups</span>=1003(user01)</span><br><span class="line">[user02@kvm-hkcloud01 ~]$</span><br></pre></td></tr></table></figure><p>3、当user02的uid发生改变时，再查看user01的信息，因为没有重复的id的情况下，用户名就能正常的显示user01了</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[root@kvm-hkcloud01 ~]<span class="comment"># usermod -u 1001 user02</span></span><br><span class="line">[root@kvm-hkcloud01 ~]<span class="comment"># id user02</span></span><br><span class="line">uid=1001(user02) gid=1002(user02) <span class="built_in">groups</span>=1002(user02)</span><br><span class="line">[root@kvm-hkcloud01 ~]<span class="comment"># id user01</span></span><br><span class="line">uid=1000(user01) gid=1003(user01) <span class="built_in">groups</span>=1003(user01)</span><br></pre></td></tr></table></figure><p>4、当我再将user02的uid修改为1000的时候，再查看user01的信息，发现user01的用户名又显示为user02了</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[root@kvm-hkcloud01 ~]<span class="comment"># usermod -u 1000 -o user02</span></span><br><span class="line">[root@kvm-hkcloud01 ~]<span class="comment"># id user02</span></span><br><span class="line">uid=1000(user02) gid=1002(user02) <span class="built_in">groups</span>=1002(user02)</span><br><span class="line">[root@kvm-hkcloud01 ~]<span class="comment"># id user01</span></span><br><span class="line">uid=1000(user02) gid=1002(user02) <span class="built_in">groups</span>=1002(user02)</span><br></pre></td></tr></table></figure><p><strong>那么，当UID重复的时候，是谁决定了用哪个用户名作为显示呢？</strong><br>想一想，哪个文件记录了UID信息？没错,是<code>/etc/passwd</code>当我将user01和user02的行进行调转之后（user01）在前，使用id查看的时候，显示的用户名就是user01了</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 修改前</span></span><br><span class="line">[root@kvm-hkcloud01 ~]<span class="comment"># tail -n 2 /etc/passwd</span></span><br><span class="line">user02:x:1000:1002::/home/user02:/bin/bash</span><br><span class="line">user01:x:1000:1003::/home/user01:/bin/bash</span><br><span class="line">[root@kvm-hkcloud01 ~]<span class="comment"># id user01</span></span><br><span class="line">uid=1000(user02) gid=1002(user02) <span class="built_in">groups</span>=1002(user02)</span><br><span class="line">[root@kvm-hkcloud01 ~]<span class="comment"># id user02</span></span><br><span class="line">uid=1000(user02) gid=1002(user02) <span class="built_in">groups</span>=1002(user02)</span><br><span class="line">[root@kvm-hkcloud01 ~]<span class="comment"># vi /etc/passwd</span></span><br><span class="line"><span class="comment"># 修改后</span></span><br><span class="line">[root@kvm-hkcloud01 ~]<span class="comment"># tail -n 2 /etc/passwd</span></span><br><span class="line">user01:x:1000:1003::/home/user01:/bin/bash</span><br><span class="line">user02:x:1000:1002::/home/user02:/bin/bash</span><br><span class="line">[root@kvm-hkcloud01 ~]<span class="comment"># id user01</span></span><br><span class="line">uid=1000(user01) gid=1003(user01) <span class="built_in">groups</span>=1003(user01)</span><br><span class="line">[root@kvm-hkcloud01 ~]<span class="comment"># id user02</span></span><br><span class="line">uid=1000(user01) gid=1003(user01) <span class="built_in">groups</span>=1003(user01)</span><br><span class="line"></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> Linux </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Linux基础 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>怎么判断多台虚拟机上的磁盘是不是同一块磁盘呢？</title>
      <link href="/posts/b6ae4c2c/"/>
      <url>/posts/b6ae4c2c/</url>
      
        <content type="html"><![CDATA[<p>在虚拟化环境上，有普通磁盘和共享磁盘，有时候进行扩容后，多台虚拟机上的磁盘大小一样，那怎么判断某个盘是不是共享磁盘呢？这时候我们可以使用<code>blkid</code>命令来查看。</p><p>命令输出结果如下，如果多台虚拟机输出的<code>uuid</code>是一样的，那这个磁盘就是共享磁盘了。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@txy201-51 tmp]<span class="comment"># blkid /dev/vda1</span></span><br><span class="line">/dev/vda1: UUID=<span class="string">&quot;4b499d76-769a-40a0-93dc-4a31a59add28&quot;</span> TYPE=<span class="string">&quot;ext4&quot;</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> Linux </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Linux基础 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Linux中的软链接和硬链接</title>
      <link href="/posts/83a68e5f/"/>
      <url>/posts/83a68e5f/</url>
      
        <content type="html"><![CDATA[<p>在Linux中，可以使<code>ln</code>命令创建链接文件，默认是硬链接，如果加<code>-s</code>参数，就是创建软连接。</p><ul class="lvl-0"><li class="lvl-2">软链接：和Windows中的快捷方式差不多，这个链接文件指向源文件，和源文件不同，源文件被删除时，软链接文件无法访问。</li><li class="lvl-2">硬链接：硬链接更像是源文件的副本，这两个文件指向了相同的inode，源文件被删除时，inode的硬链接数不为0，数据不会删除，此时访问硬链接文件正常。</li></ul><h1>一、软链接和硬链接文件信息</h1><p>1、创建链接文件</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[root@txy201-51 tmp]<span class="comment"># echo 123 &gt; passwd</span></span><br><span class="line">[root@txy201-51 tmp]<span class="comment"># ln passwd link_h_passwd</span></span><br><span class="line">[root@txy201-51 tmp]<span class="comment"># ln -s passwd link_s_passwd</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><p>2、查看源文件信息，inode为51380</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">[root@txy201-51 tmp]<span class="comment"># stat passwd</span></span><br><span class="line">  文件：<span class="string">&quot;passwd&quot;</span></span><br><span class="line">  大小：16              块：8          IO 块：4096   普通文件</span><br><span class="line">设备：fd01h/64769d      Inode：51380       硬链接：2</span><br><span class="line">权限：(0644/-rw-r--r--)  Uid：(    0/    root)   Gid：(    0/    root)</span><br><span class="line">最近访问：2024-05-31 15:45:22.174997597 +0800</span><br><span class="line">最近更改：2024-05-31 15:45:21.844997227 +0800</span><br><span class="line">最近改动：2024-05-31 15:45:21.844997227 +0800</span><br><span class="line">创建时间：-</span><br><span class="line">[root@txy201-51 tmp]<span class="comment">#</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><p>3、查看硬链接文件，inode也是51380，和源文件指向了相同的inode，而且文件属性为普通文件，而不是链接文件。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">[root@txy201-51 tmp]<span class="comment"># stat link_h_passwd</span></span><br><span class="line">  文件：<span class="string">&quot;link_h_passwd&quot;</span></span><br><span class="line">  大小：16              块：8          IO 块：4096   普通文件</span><br><span class="line">设备：fd01h/64769d      Inode：51380       硬链接：2</span><br><span class="line">权限：(0644/-rw-r--r--)  Uid：(    0/    root)   Gid：(    0/    root)</span><br><span class="line">最近访问：2024-05-31 15:45:22.174997597 +0800</span><br><span class="line">最近更改：2024-05-31 15:45:21.844997227 +0800</span><br><span class="line">最近改动：2024-05-31 15:45:21.844997227 +0800</span><br><span class="line">创建时间：-</span><br><span class="line">[root@txy201-51 tmp]<span class="comment">#</span></span><br></pre></td></tr></table></figure><p>4、再看看软连接的状态,文件的大小、指向的inode和源文件不同，文件类型为符号链接</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">[root@txy201-51 tmp]<span class="comment"># stat link_s_passwd</span></span><br><span class="line">  文件：<span class="string">&quot;link_s_passwd&quot;</span> -&gt; <span class="string">&quot;passwd&quot;</span></span><br><span class="line">  大小：6               块：0          IO 块：4096   符号链接</span><br><span class="line">设备：fd01h/64769d      Inode：51379       硬链接：1</span><br><span class="line">权限：(0777/lrwxrwxrwx)  Uid：(    0/    root)   Gid：(    0/    root)</span><br><span class="line">最近访问：2024-05-31 15:38:40.578545132 +0800</span><br><span class="line">最近更改：2024-05-31 15:38:39.634544066 +0800</span><br><span class="line">最近改动：2024-05-31 15:38:39.634544066 +0800</span><br><span class="line">创建时间：-</span><br><span class="line">[root@txy201-51 tmp]<span class="comment">#</span></span><br></pre></td></tr></table></figure><h1>二、修改源文件，链接文件的变化</h1><p>1、修改源源文件，可以看到软链接和硬链接文件的内容也随之改变了</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">[root@txy201-51 tmp]<span class="comment"># echo 456 &gt; passwd</span></span><br><span class="line">[root@txy201-51 tmp]<span class="comment"># cat link_s_passwd</span></span><br><span class="line">456</span><br><span class="line">[root@txy201-51 tmp]<span class="comment"># cat link_h_passwd</span></span><br><span class="line">456</span><br><span class="line">[root@txy201-51 tmp]<span class="comment">#</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><p>2、修改软连接文件，可以看到源文件和硬链接文件也都发生了变化，因为软连接就是指向源文件的，可以理解为对源文件的修改。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[root@txy201-51 tmp]<span class="comment"># echo 789 &gt; link_s_passwd</span></span><br><span class="line">[root@txy201-51 tmp]<span class="comment"># cat passwd</span></span><br><span class="line">789</span><br><span class="line">[root@txy201-51 tmp]<span class="comment"># cat link_h_passwd</span></span><br><span class="line">789</span><br><span class="line">[root@txy201-51 tmp]<span class="comment">#</span></span><br></pre></td></tr></table></figure><p>3、修改硬链接文件，可以看到软链接和源文件的数据也发生了变化，因为修改硬链接，实际上修改的是inode块的数据，源文件指向的也是这个数据块，所以内容也会发生变化。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[root@txy201-51 tmp]<span class="comment"># echo &#x27;abc&#x27; &gt; link_h_passwd</span></span><br><span class="line">[root@txy201-51 tmp]<span class="comment"># cat passwd</span></span><br><span class="line">abc</span><br><span class="line">[root@txy201-51 tmp]<span class="comment"># cat link_s_passwd</span></span><br><span class="line">abc</span><br><span class="line">[root@txy201-51 tmp]<span class="comment">#</span></span><br></pre></td></tr></table></figure><h1>三、删除源文件对链接文件的影响</h1><p>1、删除源文件，软链接文件无法访问，硬链接文件访问正常</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[root@txy201-51 tmp]<span class="comment"># rm -f passwd</span></span><br><span class="line">[root@txy201-51 tmp]<span class="comment"># cat link_s_passwd</span></span><br><span class="line"><span class="built_in">cat</span>: link_s_passwd: 没有那个文件或目录</span><br><span class="line">[root@txy201-51 tmp]<span class="comment"># cat link_h_passwd</span></span><br><span class="line">abc</span><br><span class="line">[root@txy201-51 tmp]<span class="comment">#</span></span><br></pre></td></tr></table></figure><p>2、如果再创建一个和源文件一样的文件，可以看到软链接文件可以正常访问了，但是硬链接的数据和源文件不一致，你知道这是为什么吗？</p><blockquote><p>因为再次创建‘源’文件之后，‘源’文件的inode发生了变化，所以数据肯定不一致。而软连接是对路径的链接，只要这个路径在，就可以访问。</p></blockquote><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[root@txy201-51 tmp]<span class="comment"># echo 123 &gt; passwd</span></span><br><span class="line">[root@txy201-51 tmp]<span class="comment"># cat link_h_passwd</span></span><br><span class="line">abc</span><br><span class="line">[root@txy201-51 tmp]<span class="comment"># cat link_s_passwd</span></span><br><span class="line">123</span><br><span class="line">[root@txy201-51 tmp]<span class="comment">#</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> Linux </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Linux基础 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>openEuler中奇怪的网络管理服务</title>
      <link href="/posts/4cf37030/"/>
      <url>/posts/4cf37030/</url>
      
        <content type="html"><![CDATA[<p>openEuler中的网络服务</p><h1>管理网络服务</h1><p>openEuler没有network服务，当我修改了网卡配置文件之后，使用以下命令进行重启，报错<code>Failed to restart network.service: Unit network.service not found.</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost sshuser]<span class="comment"># systemctl restart network</span></span><br><span class="line">Failed to restart network.service: Unit network.service not found.</span><br><span class="line">[root@localhost sshuser]<span class="comment"># </span></span><br></pre></td></tr></table></figure><p>经过查询才知道，<code>EulerOS</code>没有<code>network</code>服务，而是使用<code>NetworkManager</code>管理网络服务，所以直接重启这个服务即可。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost sshuser]<span class="comment"># systemctl restart NetworkManager</span></span><br></pre></td></tr></table></figure><p>让我感觉到奇怪的点是，在系统中是可以查到<code>network</code>服务的，但用<code>systemctl</code>和<code>service</code>命令却管理不了它。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost sshuser]<span class="comment"># systemctl | grep network</span></span><br><span class="line">  sys-devices-pci0000:00-0000:00:12.0-virtio1-net-ens18.device                                             loaded active plugged   Virtio network device</span><br><span class="line">  sys-subsystem-net-devices-ens18.device                                                                   loaded active plugged   Virtio network device</span><br><span class="line">  network-online.target                                                                                    loaded active active    Network is Online</span><br><span class="line">  network-pre.target                                                                                       loaded active active    Preparation <span class="keyword">for</span> Network</span><br><span class="line">  network.target                                                                                           loaded active active    Network</span><br><span class="line">[root@localhost sshuser]<span class="comment"># </span></span><br></pre></td></tr></table></figure><h1>修改网卡配置</h1><p>第二个奇怪的点是，修改网卡配置文件，掩码只能使用<code>PEREFIX</code>来表示，不能使用<code>NETMASK</code>，不然IP地址修改不成功了</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">IPADDR=192.168.3.138</span><br><span class="line">PREFIX=24</span><br><span class="line">GATEWAY=192.168.3.1</span><br></pre></td></tr></table></figure><h1>查看IP的命令</h1><p>在<code>openEuler</code>中，除了可以使用<code>ip add</code>命令查看地址外，还可以使用<code>nmcli</code>命令查看，默认自带了这两个命令。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost network-scripts]<span class="comment"># nmcli dev show</span></span><br><span class="line">GENERAL.DEVICE:                         ens18</span><br><span class="line">GENERAL.TYPE:                           ethernet</span><br><span class="line">GENERAL.HWADDR:                         8E:F7:F5:E9:2A:78</span><br><span class="line">GENERAL.MTU:                            1500</span><br><span class="line">GENERAL.STATE:                          100 (connected)</span><br><span class="line">GENERAL.CONNECTION:                     ens18</span><br><span class="line">GENERAL.CON-PATH:                       /org/freedesktop/NetworkManager/ActiveConnection/1</span><br><span class="line">WIRED-PROPERTIES.CARRIER:               on</span><br><span class="line">IP4.ADDRESS[1]:                         192.168.3.138/24</span><br><span class="line">IP4.GATEWAY:                            192.168.3.1</span><br><span class="line">IP4.ROUTE[1]:                           dst = 0.0.0.0/0, nh = 192.168.3.1, mt = 100</span><br><span class="line">IP4.ROUTE[2]:                           dst = 192.168.3.0/24, nh = 0.0.0.0, mt = 100</span><br><span class="line">IP6.ADDRESS[1]:                         2409:8a55:8f2:xxa4:8cf7:fxxf:fxe9:xxx/64</span><br><span class="line">IP6.ADDRESS[2]:                         2409:8a55:8f2:xxa4:d4bb:e68f:cx3x:x/128</span><br><span class="line">IP6.ADDRESS[3]:                         fe80::8cf7:f5ff:fee9:2a78/64</span><br><span class="line">IP6.GATEWAY:                            fe80::1</span><br><span class="line">IP6.ROUTE[1]:                           dst = 2409:8a55:8f2:bca4::/64, nh = ::, mt = 100</span><br><span class="line">IP6.ROUTE[2]:                           dst = ::/0, nh = fe80::1, mt = 100</span><br><span class="line">IP6.ROUTE[3]:                           dst = 2409:8a55:8f2:bca4:d4bb:e68f:cb34:3/128, nh = ::, mt = 100</span><br><span class="line">IP6.ROUTE[4]:                           dst = fe80::/64, nh = ::, mt = 100</span><br><span class="line">IP6.DNS[1]:                             fe80::1</span><br><span class="line"></span><br><span class="line">GENERAL.DEVICE:                         lo</span><br><span class="line">GENERAL.TYPE:                           loopback</span><br><span class="line">GENERAL.HWADDR:                         00:00:00:00:00:00</span><br><span class="line">GENERAL.MTU:                            65536</span><br><span class="line">GENERAL.STATE:                          10 (unmanaged)</span><br><span class="line">GENERAL.CONNECTION:                     --</span><br><span class="line">GENERAL.CON-PATH:                       --</span><br><span class="line">IP4.ADDRESS[1]:                         127.0.0.1/8</span><br><span class="line">IP4.GATEWAY:                            --</span><br><span class="line">IP6.ADDRESS[1]:                         ::1/128</span><br><span class="line">IP6.GATEWAY:                            --</span><br><span class="line">IP6.ROUTE[1]:                           dst = ::1/128, nh = ::, mt = 256</span><br><span class="line">[root@localhost network-scripts]<span class="comment"># </span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> Linux </category>
          
      </categories>
      
      
        <tags>
            
            <tag> openEuler </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>给hexo主题添加代码块复制功能</title>
      <link href="/posts/undefined/"/>
      <url>/posts/undefined/</url>
      
        <content type="html"><![CDATA[<blockquote><p>适用于所有的Hexo主题</p></blockquote><h1>创建clipboard_use.js</h1><p>在<code>themes/xxx/source/js</code> 目录下，创建<code>clipboard_use.js</code>，添加内容如下</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">$(<span class="string">&quot;.highlight&quot;</span>).<span class="title function_">wrap</span>(<span class="string">&quot;&lt;div class=&#x27;code-wrapper&#x27; style=&#x27;position:relative&#x27;&gt;&lt;/div&gt;&quot;</span>);</span><br><span class="line"><span class="comment">/*页面载入完成后，创建复制按钮*/</span></span><br><span class="line">!<span class="keyword">function</span> (<span class="params">e, t, a</span>) &#123;</span><br><span class="line">    <span class="comment">/* code */</span></span><br><span class="line">    <span class="keyword">var</span> initCopyCode = <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">var</span> copyHtml = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">        copyHtml += <span class="string">&#x27;&lt;button class=&quot;btn-copy&quot; data-clipboard-snippet=&quot;&quot;&gt;&#x27;</span>;</span><br><span class="line">        copyHtml += <span class="string">&#x27;  &lt;i class=&quot;fa fa-clipboard&quot;&gt;&lt;/i&gt;&lt;span&gt;复制&lt;/span&gt;&#x27;</span>;</span><br><span class="line">        copyHtml += <span class="string">&#x27;&lt;/button&gt;&#x27;</span>;</span><br><span class="line">        <span class="comment">/* $(&quot;.highlight .code&quot;).before(copyHtml); */</span></span><br><span class="line"></span><br><span class="line">        $(<span class="string">&quot;.code-wrapper .highlight table&quot;</span>).<span class="title function_">before</span>(copyHtml);</span><br><span class="line">        <span class="keyword">var</span> clipboard = <span class="keyword">new</span> <span class="title class_">ClipboardJS</span>(<span class="string">&#x27;.btn-copy&#x27;</span>, &#123;</span><br><span class="line">            <span class="attr">target</span>: <span class="keyword">function</span> (<span class="params">trigger</span>) &#123;</span><br><span class="line">                <span class="keyword">var</span> tablee = trigger.<span class="property">nextElementSibling</span>;</span><br><span class="line">               &lt;!--  <span class="keyword">return</span> trigger.<span class="property">nextElementSibling</span>; --&gt;</span><br><span class="line">                <span class="keyword">return</span> tablee.<span class="property">firstElementChild</span>.<span class="property">firstElementChild</span>.<span class="property">firstElementChild</span>.<span class="property">nextElementSibling</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">        clipboard.<span class="title function_">on</span>(<span class="string">&#x27;success&#x27;</span>, <span class="keyword">function</span> (<span class="params">e</span>) &#123;</span><br><span class="line">            e.<span class="property">trigger</span>.<span class="property">innerHTML</span> = <span class="string">&quot;&lt;i class=&#x27;fa fa-clipboard&#x27;&gt;&lt;/i&gt;&lt;span&gt;复制成功&lt;/span&gt;&quot;</span></span><br><span class="line">            <span class="built_in">setTimeout</span>(<span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">                e.<span class="property">trigger</span>.<span class="property">innerHTML</span> = <span class="string">&quot;&lt;i class=&#x27;fa fa-clipboard&#x27;&gt;&lt;/i&gt;&lt;span&gt;复制&lt;/span&gt;&quot;</span></span><br><span class="line">            &#125;, <span class="number">1000</span>)</span><br><span class="line">           </span><br><span class="line">            e.<span class="title function_">clearSelection</span>();</span><br><span class="line">        &#125;);</span><br><span class="line">        clipboard.<span class="title function_">on</span>(<span class="string">&#x27;error&#x27;</span>, <span class="keyword">function</span> (<span class="params">e</span>) &#123;</span><br><span class="line">            e.<span class="property">trigger</span>.<span class="property">innerHTML</span> = <span class="string">&quot;&lt;i class=&#x27;fa fa-clipboard&#x27;&gt;&lt;/i&gt;&lt;span&gt;复制失败&lt;/span&gt;&quot;</span></span><br><span class="line">            <span class="built_in">setTimeout</span>(<span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">                e.<span class="property">trigger</span>.<span class="property">innerHTML</span> = <span class="string">&quot;&lt;i class=&#x27;fa fa-clipboard&#x27;&gt;&lt;/i&gt;&lt;span&gt;复制&lt;/span&gt;&quot;</span></span><br><span class="line">            &#125;, <span class="number">1000</span>)</span><br><span class="line">            e.<span class="title function_">clearSelection</span>();</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="title function_">initCopyCode</span>();</span><br><span class="line">&#125;(<span class="variable language_">window</span>, <span class="variable language_">document</span>);</span><br></pre></td></tr></table></figure><h1>添加CSS</h1><p>在<code>theme/xxx/source/css/style.css</code>样式中添加如下代码：</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* 代码块复制按钮 */</span></span><br><span class="line"><span class="selector-class">.btn-copy</span> &#123;</span><br><span class="line">    <span class="attribute">display</span>: inline-block;</span><br><span class="line">    <span class="attribute">cursor</span>: pointer;</span><br><span class="line">    <span class="attribute">background-color</span>: <span class="number">#eee</span>;</span><br><span class="line">    <span class="attribute">background-image</span>: <span class="built_in">linear-gradient</span>(<span class="number">#fcfcfc</span>, <span class="number">#eee</span>);</span><br><span class="line">    <span class="attribute">border</span>: <span class="number">1px</span> solid <span class="number">#d5d5d5</span>;</span><br><span class="line">    <span class="attribute">border-radius</span>: <span class="number">3px</span>;</span><br><span class="line">    -webkit-user-select: none;</span><br><span class="line">    -moz-user-select: none;</span><br><span class="line">    -ms-user-select: none;</span><br><span class="line">    user-select: none;</span><br><span class="line">    -webkit-appearance: none;</span><br><span class="line">    <span class="attribute">font-size</span>: <span class="number">13px</span>;</span><br><span class="line">    <span class="attribute">font-weight</span>: <span class="number">700</span>;</span><br><span class="line">    <span class="attribute">line-height</span>: <span class="number">20px</span>;</span><br><span class="line">    <span class="attribute">color</span>: <span class="number">#333</span>;</span><br><span class="line">    -webkit-<span class="attribute">transition</span>: opacity .<span class="number">3s</span> ease-in-out;</span><br><span class="line">    -o-<span class="attribute">transition</span>: opacity .<span class="number">3s</span> ease-in-out;</span><br><span class="line">    <span class="attribute">transition</span>: opacity .<span class="number">3s</span> ease-in-out;</span><br><span class="line">    <span class="attribute">padding</span>: <span class="number">2px</span> <span class="number">6px</span>;</span><br><span class="line">    <span class="attribute">position</span>: absolute;</span><br><span class="line">    <span class="attribute">right</span>: <span class="number">5px</span>;</span><br><span class="line">    <span class="attribute">top</span>: <span class="number">5px</span>;</span><br><span class="line">    <span class="attribute">opacity</span>: <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.btn-copy</span> <span class="selector-tag">span</span> &#123;</span><br><span class="line">    <span class="attribute">margin-left</span>: <span class="number">5px</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.code-wrapper</span><span class="selector-pseudo">:hover</span> <span class="selector-class">.btn-copy</span> &#123;</span><br><span class="line">    <span class="attribute">opacity</span>: <span class="number">1</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1>引入font-awesome</h1><p>按钮上面添加了一个小图标美化，需要引入font-awesome.<br>在<code>themes\xxx\layout\_partial\head.ejs</code>或<code>themes\xxx\layout\_common\head.ejs</code>中的<code>&lt;/head&gt;</code>之前添加</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">&quot;stylesheet&quot;</span> <span class="attr">type</span>=<span class="string">&quot;text/css&quot;</span> <span class="attr">href</span>=<span class="string">&quot;//cdn.bootcss.com/font-awesome/4.6.3/css/font-awesome.min.css&quot;</span>&gt;</span></span><br></pre></td></tr></table></figure><h1>引用其他js</h1><p>在<code>themes\xxx\layout\layout.ejs</code>文件中的<code>&lt;/body&gt;</code>标签前也就是<code>body</code>标签之间的最后加入如下代码,这里是将<code>clipboard.min.js</code>和<code>clipboard-use.js</code>保存到CDN上，通过远程引用 或者将他们直接下载到本地直接引用也可</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 代码块复制功能 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">&quot;text/javascript&quot;</span> <span class="attr">src</span>=<span class="string">&quot;https://cdn.jsdelivr.net/npm/clipboard@2.0.4/dist/clipboard.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">&quot;text/javascript&quot;</span> <span class="attr">src</span>=<span class="string">&quot;https://apps.bdimg.com/libs/jquery/2.1.4/jquery.min.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">&quot;text/javascript&quot;</span> <span class="attr">src</span>=<span class="string">&quot;/js/clipboard_use.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure><h1>部署</h1><p>最后就可以使用hexo提交就行啦</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hexo g -d</span><br></pre></td></tr></table></figure><p>参考资料</p><blockquote><ul class="lvl-1"><li class="lvl-2"><p><a href="https://www.ikaqiu.top/posts/f623adca.html">为Hexo主题增加代码块复制功能</a></p></li></ul></blockquote>]]></content>
      
      
      <categories>
          
          <category> 博客搭建 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> hexo </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>当前博客使用主题及部署方式</title>
      <link href="/posts/undefined/"/>
      <url>/posts/undefined/</url>
      
        <content type="html"><![CDATA[<p>当前使用的主题是<code>Wikitten</code></p><p>部署文档链接如下：</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://github.com/zthxxx/hexo-theme-Wikitten/blob/master/README_zh-CN.md</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 博客搭建 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>清除模态框form的内容</title>
      <link href="/posts/undefined/"/>
      <url>/posts/undefined/</url>
      
        <content type="html"><![CDATA[<p>在模态框提交数据后，页面不刷新的情况下，再次点击模态框，上次输入的内容还保留着，可以通过下面的方式清除模态框内容</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 在ajax返回成功时可以执行</span></span><br><span class="line">$(<span class="string">&#x27;.modal-body&#x27;</span>).<span class="title function_">find</span>(<span class="string">&#x27;form&#x27;</span>).<span class="title function_">trigger</span>(<span class="string">&#x27;reset&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 如果在用户点击关闭时也要执行，可以在show.bs.modal事件里设置</span></span><br><span class="line"> $(<span class="string">&#x27;#updatemodal&#x27;</span>).<span class="title function_">on</span>(<span class="string">&#x27;show.bs.modal&#x27;</span>, <span class="keyword">function</span> (<span class="params">event</span>) &#123;</span><br><span class="line">    $(<span class="string">&#x27;.modal-body&#x27;</span>).<span class="title function_">find</span>(<span class="string">&#x27;form&#x27;</span>).<span class="title function_">trigger</span>(<span class="string">&#x27;reset&#x27;</span>);</span><br><span class="line">    <span class="comment">// 其他内容</span></span><br><span class="line"> &#125;)</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 前端学习 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> adminlte </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>modal中使用form</title>
      <link href="/posts/undefined/"/>
      <url>/posts/undefined/</url>
      
        <content type="html"><![CDATA[<ul class="lvl-0"><li class="lvl-2"><p>html</p></li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 更新进展Modal --&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;modal fade&quot;</span> <span class="attr">id</span>=<span class="string">&quot;updatemodal&quot;</span> <span class="attr">data-backdrop</span>=<span class="string">&quot;static&quot;</span> <span class="attr">tabindex</span>=<span class="string">&quot;-1&quot;</span> <span class="attr">role</span>=<span class="string">&quot;dialog&quot;</span> <span class="attr">aria-labelledby</span>=<span class="string">&quot;staticBackdropLabel&quot;</span> <span class="attr">aria-hidden</span>=<span class="string">&quot;true&quot;</span> <span class="attr">name</span>=<span class="string">&quot;updatemodal&quot;</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;modal-dialog modal-xl&quot;</span> <span class="attr">role</span>=<span class="string">&quot;document&quot;</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;modal-content&quot;</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;modal-header&quot;</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">h5</span> <span class="attr">class</span>=<span class="string">&quot;modal-title&quot;</span> <span class="attr">id</span>=<span class="string">&quot;staticBackdropLabel&quot;</span>&gt;</span>更新代办事件<span class="tag">&lt;/<span class="name">h5</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">button</span> <span class="attr">type</span>=<span class="string">&quot;button&quot;</span> <span class="attr">class</span>=<span class="string">&quot;close&quot;</span> <span class="attr">data-dismiss</span>=<span class="string">&quot;modal&quot;</span> <span class="attr">aria-label</span>=<span class="string">&quot;Close&quot;</span>&gt;</span></span><br><span class="line">             <span class="tag">&lt;<span class="name">span</span> <span class="attr">aria-hidden</span>=<span class="string">&quot;true&quot;</span>&gt;</span><span class="symbol">&amp;times;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;modal-body&quot;</span>&gt;</span></span><br><span class="line">          <span class="comment">&lt;!--编辑框开始--&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;card card-primary&quot;</span>&gt;</span></span><br><span class="line">             <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;card-header&quot;</span>&gt;</span></span><br><span class="line">               <span class="tag">&lt;<span class="name">h3</span> <span class="attr">class</span>=<span class="string">&quot;card-title&quot;</span>&gt;</span>更新代办事件<span class="tag">&lt;/<span class="name">h3</span>&gt;</span></span><br><span class="line">             <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">             <span class="comment">&lt;!-- /.card-header --&gt;</span></span><br><span class="line">             <span class="comment">&lt;!-- form start --&gt;</span></span><br><span class="line">             <span class="tag">&lt;<span class="name">form</span> <span class="attr">id</span>=<span class="string">&quot;updateForm&quot;</span> <span class="attr">name</span>=<span class="string">&quot;updateForm&quot;</span> <span class="attr">novalidate</span>=<span class="string">&quot;novalidate&quot;</span>&gt;</span></span><br><span class="line">               <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;card-body&quot;</span>&gt;</span></span><br><span class="line">                 <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;form-group&quot;</span>&gt;</span></span><br><span class="line">                   <span class="tag">&lt;<span class="name">label</span> <span class="attr">for</span>=<span class="string">&quot;detail_title&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">style</span>=<span class="string">&quot;color: red;&quot;</span>&gt;</span>*<span class="tag">&lt;/<span class="name">a</span>&gt;</span>进展标题<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">                   <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">name</span>=<span class="string">&quot;detail_title&quot;</span> <span class="attr">class</span>=<span class="string">&quot;form-control&quot;</span> <span class="attr">id</span>=<span class="string">&quot;detail_title&quot;</span>&gt;</span></span><br><span class="line">                 <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">                 <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;form-group&quot;</span> <span class="attr">data-select2-id</span>=<span class="string">&quot;29&quot;</span>&gt;</span></span><br><span class="line">                 <span class="tag">&lt;<span class="name">label</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">style</span>=<span class="string">&quot;color: red;&quot;</span>&gt;</span>*<span class="tag">&lt;/<span class="name">a</span>&gt;</span>事件状态<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">                 <span class="tag">&lt;<span class="name">select</span> <span class="attr">class</span>=<span class="string">&quot;form-control select2 select2-danger select2-hidden-accessible&quot;</span> <span class="attr">data-dropdown-css-class</span>=<span class="string">&quot;select2-danger&quot;</span> <span class="attr">style</span>=<span class="string">&quot;width: 100%;&quot;</span> <span class="attr">data-select2-id</span>=<span class="string">&quot;12&quot;</span> <span class="attr">tabindex</span>=<span class="string">&quot;-1&quot;</span> <span class="attr">aria-hidden</span>=<span class="string">&quot;true&quot;</span> <span class="attr">id</span>=<span class="string">&quot;event_status&quot;</span> <span class="attr">name</span>=<span class="string">&quot;event_status&quot;</span>&gt;</span></span><br><span class="line">                   <span class="tag">&lt;<span class="name">option</span> <span class="attr">selected</span>=<span class="string">&quot;selected&quot;</span> <span class="attr">data-select2-id</span>=<span class="string">&quot;14&quot;</span> <span class="attr">value</span>=<span class="string">&#x27;0&#x27;</span>&gt;</span>未完成<span class="tag">&lt;/<span class="name">option</span>&gt;</span></span><br><span class="line">                   <span class="tag">&lt;<span class="name">option</span> <span class="attr">data-select2-id</span>=<span class="string">&quot;35&quot;</span> <span class="attr">value</span>=<span class="string">&#x27;1&#x27;</span>&gt;</span>完成<span class="tag">&lt;/<span class="name">option</span>&gt;</span></span><br><span class="line">                   <span class="tag">&lt;<span class="name">option</span> <span class="attr">data-select2-id</span>=<span class="string">&quot;36&quot;</span> <span class="attr">value</span>=<span class="string">&#x27;2&#x27;</span>&gt;</span>终止<span class="tag">&lt;/<span class="name">option</span>&gt;</span></span><br><span class="line">                 <span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line">               <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">                 <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;form-group&quot;</span>&gt;</span></span><br><span class="line">                   <span class="tag">&lt;<span class="name">label</span> <span class="attr">for</span>=<span class="string">&quot;detail_content&quot;</span>&gt;</span>详细信息(选填)<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">                   <span class="tag">&lt;<span class="name">textarea</span> <span class="attr">id</span>=<span class="string">&quot;detail_content&quot;</span> <span class="attr">class</span>=<span class="string">&quot;form-control&quot;</span> <span class="attr">name</span>=<span class="string">&quot;detail_content&quot;</span> <span class="attr">rows</span>=<span class="string">&quot;4&quot;</span> <span class="attr">cols</span>=<span class="string">&quot;50&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">textarea</span>&gt;</span></span><br><span class="line">                 <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">               <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">               <span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line">               <span class="comment">&lt;!-- /.card-body --&gt;</span></span><br><span class="line">           <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">          <span class="comment">&lt;!--编辑框结束--&gt;</span></span><br><span class="line">         <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;modal-footer&quot;</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">button</span> <span class="attr">type</span>=<span class="string">&quot;button&quot;</span> <span class="attr">class</span>=<span class="string">&quot;btn btn-secondary&quot;</span> <span class="attr">data-dismiss</span>=<span class="string">&quot;modal&quot;</span>&gt;</span>取消<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">button</span> <span class="attr">type</span>=<span class="string">&quot;submit&quot;</span> <span class="attr">class</span>=<span class="string">&quot;btn btn-primary&quot;</span>&gt;</span>更新<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        </span><br><span class="line">       <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">       </span><br><span class="line">     <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">   <span class="comment">&lt;!-- 更新进展Modal END Modal --&gt;</span></span><br></pre></td></tr></table></figure><ul class="lvl-0"><li class="lvl-2">js内容</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br></pre></td><td class="code"><pre><span class="line">  <span class="keyword">var</span> updateurl</span><br><span class="line">  $(<span class="string">&#x27;#updatemodal&#x27;</span>).<span class="title function_">on</span>(<span class="string">&#x27;show.bs.modal&#x27;</span>, <span class="keyword">function</span> (<span class="params">event</span>) &#123;</span><br><span class="line">    <span class="keyword">var</span> button = $(event.<span class="property">relatedTarget</span>) <span class="comment">// Button that triggered the modal</span></span><br><span class="line">    <span class="comment">//注意这里的whatever对应前面html代码中button标签下data-whatever属性的后半段</span></span><br><span class="line">    updateurl = button.<span class="title function_">data</span>(<span class="string">&#x27;url&#x27;</span>) <span class="comment">// Extract info from data-* attributes</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// var user = button.data(&#x27;user&#x27;)</span></span><br><span class="line">    <span class="comment">// If necessary, you could initiate an AJAX request here (and then do the updating in a callback).</span></span><br><span class="line">    <span class="comment">// Update the modal&#x27;s content. We&#x27;ll use jQuery here, but you could use a data binding library or other methods instead.</span></span><br><span class="line">    <span class="keyword">var</span> modal = $(<span class="variable language_">this</span>)</span><br><span class="line">    <span class="comment">//此处即为修改modal的标题</span></span><br><span class="line">    <span class="comment">// modal.find(&#x27;.modal-title&#x27;).text(&#x27;New message to &#x27; + recipient)</span></span><br><span class="line">    <span class="comment">// modal.find(&#x27;.modal-body input&#x27;).val(recipient)</span></span><br><span class="line">    <span class="comment">//modal.find(&#x27;.card-primary form&#x27;).attr(&quot;action&quot;,url)</span></span><br><span class="line">  &#125;)</span><br><span class="line">  $(<span class="string">&quot;.modal-footer button[type=&#x27;submit&#x27;]&quot;</span>).<span class="title function_">click</span>(<span class="keyword">function</span>(<span class="params">e</span>)&#123;</span><br><span class="line">    e.<span class="title function_">preventDefault</span>(); <span class="comment">// 阻止表单的默认提交行为</span></span><br><span class="line">    <span class="keyword">if</span> (!$(<span class="string">&quot;#updateForm&quot;</span>).<span class="title function_">valid</span>()) &#123;</span><br><span class="line">        <span class="comment">// 如果验证失败，返回false，不提交数据</span></span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="keyword">var</span> formData = $(<span class="string">&quot;#updateForm&quot;</span>).<span class="title function_">serialize</span>();</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;updateurl&#x27;</span>+updateurl)</span><br><span class="line">    $.<span class="title function_">ajax</span>(&#123;</span><br><span class="line">        <span class="attr">url</span>: updateurl, <span class="comment">// 你的请求地址</span></span><br><span class="line">        <span class="attr">type</span>: <span class="string">&quot;POST&quot;</span>, <span class="comment">// 请求类型，必须是POST</span></span><br><span class="line">        <span class="attr">data</span>: formData, <span class="comment">// 你的表单数据</span></span><br><span class="line">        <span class="attr">dataType</span>: <span class="string">&quot;json&quot;</span>, <span class="comment">// 返回的数据类型，必须是json</span></span><br><span class="line">        <span class="attr">success</span>: <span class="keyword">function</span>(<span class="params">data</span>)&#123;</span><br><span class="line">            <span class="keyword">if</span> (data.<span class="property">result</span> === <span class="number">0</span>) &#123;</span><br><span class="line">                <span class="comment">// 请求成功，显示消息</span></span><br><span class="line">                $(<span class="string">&quot;#updatemodal&quot;</span>).<span class="title function_">modal</span>(<span class="string">&#x27;hide&#x27;</span>)</span><br><span class="line">                toastr.<span class="title function_">success</span>(<span class="string">&#x27;成功：&#x27;</span>+data.<span class="property">message</span>)</span><br><span class="line">                <span class="built_in">setTimeout</span>(<span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">                    $(<span class="string">&#x27;#eventtable&#x27;</span>).<span class="title class_">DataTable</span>().<span class="property">ajax</span>.<span class="title function_">reload</span>();</span><br><span class="line"></span><br><span class="line">                &#125;, <span class="number">1000</span>)</span><br><span class="line">                </span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span> (data.<span class="property">result</span> === <span class="number">1</span>) &#123;</span><br><span class="line">                toastr.<span class="title function_">error</span>(<span class="string">&#x27;失败：&#x27;</span>+data.<span class="property">message</span>)</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">error</span>: <span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">            <span class="comment">// 请求失败的回调函数</span></span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;Error&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">$(<span class="string">&#x27;#updateForm&#x27;</span>).<span class="title function_">validate</span>(&#123;</span><br><span class="line">    <span class="attr">rules</span>: &#123;</span><br><span class="line">    </span><br><span class="line">    <span class="attr">detail_title</span>: &#123;</span><br><span class="line">        <span class="attr">required</span>: <span class="literal">true</span>,</span><br><span class="line">        <span class="attr">minlength</span>: <span class="number">5</span></span><br><span class="line">    &#125;,</span><br><span class="line">    </span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">messages</span>: &#123;</span><br><span class="line">    <span class="attr">detail_title</span>: &#123;</span><br><span class="line">        <span class="attr">required</span>: <span class="string">&quot;请输入更新标题&quot;</span>,</span><br><span class="line">    &#125;,</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">errorElement</span>: <span class="string">&#x27;span&#x27;</span>,</span><br><span class="line">    <span class="attr">errorPlacement</span>: <span class="keyword">function</span> (<span class="params">error, element</span>) &#123;</span><br><span class="line">    error.<span class="title function_">addClass</span>(<span class="string">&#x27;invalid-feedback&#x27;</span>);</span><br><span class="line">    element.<span class="title function_">closest</span>(<span class="string">&#x27;.form-group&#x27;</span>).<span class="title function_">append</span>(error);</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">highlight</span>: <span class="keyword">function</span> (<span class="params">element, errorClass, validClass</span>) &#123;</span><br><span class="line">    $(element).<span class="title function_">addClass</span>(<span class="string">&#x27;is-invalid&#x27;</span>);</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">unhighlight</span>: <span class="keyword">function</span> (<span class="params">element, errorClass, validClass</span>) &#123;</span><br><span class="line">    $(element).<span class="title function_">removeClass</span>(<span class="string">&#x27;is-invalid&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><ul class="lvl-0"><li class="lvl-2"><p>django内容</p></li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;a <span class="keyword">class</span>=<span class="string">&quot;btn btn-primary btn-sm &#123;disabled&#125;&quot;</span> data-url=<span class="string">&quot;&#123;reverse(&#x27;event:eventupdate&#x27;,kwargs=&#123;&#x27;id&#x27;:Event.id&#125;)&#125;&quot;</span> data-toggle=<span class="string">&quot;modal&quot;</span> data-target=<span class="string">&quot;#updatemodal&quot;</span>&gt;</span><br><span class="line">    &lt;i <span class="keyword">class</span>=<span class="string">&quot;fas fa-history&quot;</span>&gt;&lt;/i&gt;</span><br><span class="line">    &lt;/i&gt;</span><br><span class="line">    更新进展</span><br><span class="line">&lt;/a&gt;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 前端 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> adminlte </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>adminlte中使用时间插件</title>
      <link href="/posts/undefined/"/>
      <url>/posts/undefined/</url>
      
        <content type="html"><![CDATA[<h1>daterangepicker</h1><ul class="lvl-0"><li class="lvl-2">引入文件，语言是由moment控制的</li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">&quot;stylesheet&quot;</span> <span class="attr">href</span>=<span class="string">&quot;&#123;% static &#x27;adminlte/plugins/daterangepicker/daterangepicker.css&#x27; %&#125;&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">&quot;stylesheet&quot;</span> <span class="attr">href</span>=<span class="string">&quot;&#123;% static &#x27;adminlte/plugins/tempusdominus-bootstrap-4/css/tempusdominus-bootstrap-4.min.css&#x27; %&#125;&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;&#123;% static &#x27;adminlte/plugins/moment/moment.min.js&#x27; %&#125;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;&#123;% static &#x27;adminlte/plugins/moment/locale/zh-cn.js&#x27; %&#125;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;&#123;% static &#x27;adminlte/plugins/tempusdominus-bootstrap-4/js/tempusdominus-bootstrap-4.min.js&#x27; %&#125;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;&#123;% static &#x27;adminlte/plugins/daterangepicker/daterangepicker.js&#x27; %&#125;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure><ul class="lvl-0"><li class="lvl-2">html</li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;form-group&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">label</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">style</span>=<span class="string">&quot;color: red;&quot;</span>&gt;</span>*<span class="tag">&lt;/<span class="name">a</span>&gt;</span>计划完成时间:<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;input-group date&quot;</span> <span class="attr">id</span>=<span class="string">&quot;reservationdatetime&quot;</span> <span class="attr">data-target-input</span>=<span class="string">&quot;nearest&quot;</span> &gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">class</span>=<span class="string">&quot;form-control datetimepicker-input&quot;</span> <span class="attr">data-target</span>=<span class="string">&quot;#reservationdatetime&quot;</span> <span class="attr">name</span>=<span class="string">&quot;event_deadline&quot;</span> <span class="attr">id</span>=<span class="string">&quot;event_deadline&quot;</span> <span class="attr">value</span>=<span class="string">&quot;&#123;&#123; event_deadline &#125;&#125;&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;input-group-append&quot;</span> <span class="attr">data-target</span>=<span class="string">&quot;#reservationdatetime&quot;</span> <span class="attr">data-toggle</span>=<span class="string">&quot;datetimepicker&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;input-group-text&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">i</span> <span class="attr">class</span>=<span class="string">&quot;fa fa-calendar&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">i</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure><ul class="lvl-0"><li class="lvl-2"><p>验证，选择的时间不能大于当前时间</p></li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 比较时间</span></span><br><span class="line">     $.validator.<span class="title function_">addMethod</span>(<span class="string">&quot;compareDate&quot;</span>, <span class="keyword">function</span>(<span class="params">value, element</span>) &#123;  </span><br><span class="line">         <span class="keyword">var</span> event_deadline = $(<span class="string">&quot;#event_deadline&quot;</span>).<span class="title function_">val</span>();                        </span><br><span class="line">         <span class="keyword">var</span> date1 = <span class="keyword">new</span> <span class="title class_">Date</span>(<span class="title class_">Date</span>.<span class="title function_">parse</span>(event_deadline.<span class="title function_">replace</span>(<span class="string">&quot;-&quot;</span>, <span class="string">&quot;/&quot;</span>))); </span><br><span class="line">         <span class="comment">// 和当前时间比较           </span></span><br><span class="line">         <span class="keyword">var</span> date2 = <span class="keyword">new</span> <span class="title class_">Date</span>();     </span><br><span class="line">         <span class="keyword">return</span> date1 &gt;= date2;        </span><br><span class="line">     &#125;,<span class="string">&quot;结束时间不能早于当前时间&quot;</span>);</span><br><span class="line">       <span class="comment">// 表单验证</span></span><br><span class="line">       $(<span class="string">&#x27;#editEventForm&#x27;</span>).<span class="title function_">validate</span>(&#123;</span><br><span class="line">         <span class="attr">rules</span>: &#123;</span><br><span class="line">           <span class="attr">event_deadline</span>: &#123;</span><br><span class="line">               <span class="attr">required</span>: <span class="literal">true</span>,</span><br><span class="line">               <span class="attr">compareDate</span>: <span class="literal">true</span>,</span><br><span class="line">           &#125;,</span><br><span class="line">         &#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 前端学习 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> adminlte </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>django在windows上开机自启动和打开网页</title>
      <link href="/posts/undefined/"/>
      <url>/posts/undefined/</url>
      
        <content type="html"><![CDATA[<ul class="lvl-0"><li class="lvl-2"><p>bat文件</p></li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">@echo off</span><br><span class="line"># 使用虚拟环境，如果不用虚拟环境，这句去掉</span><br><span class="line">call D:\python\testing\.venv\Scripts\activate.bat</span><br><span class="line"># 执行</span><br><span class="line">python d:python\django-adminlte-template-master\django-adminlte-template-master\manage.py runserver 127.0.0.1:18888</span><br></pre></td></tr></table></figure><ul class="lvl-0"><li class="lvl-2">进入下面这个目录，新建一个vbs文件</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">C:\ProgramData\Microsoft\Windows\Start Menu\Programs\StartUp</span><br></pre></td></tr></table></figure><ul class="lvl-0"><li class="lvl-2"><p>vbs文件内容，后面的路径是上面bat文件的路径，网址自定义</p></li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">CreateObject(&quot;WScript.Shell&quot;).Run&quot;cmd /c D:\python\django-adminlte-template-master\startDjango.bat&quot;,0</span><br><span class="line">CreateObject(&quot;WScript.Shell&quot;).Run&quot;http://127.0.0.1:18888&quot;, 3</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> django </category>
          
      </categories>
      
      
        <tags>
            
            <tag> django </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>django将查询结果转换为字典</title>
      <link href="/posts/undefined/"/>
      <url>/posts/undefined/</url>
      
        <content type="html"><![CDATA[<p>查询的结果默认是只读的，不能直接修改，如下面这样</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">event = event.objects.get(<span class="built_in">id</span>=<span class="number">1</span>)</span><br><span class="line">event[<span class="string">&#x27;name&#x27;</span>] = <span class="number">123</span></span><br></pre></td></tr></table></figure><p>有时候可能需要把数据获取到，然后添加一个字段传给前端，这时候就可以用以下的办法</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> django.forms.models <span class="keyword">import</span> model_to_dict</span><br><span class="line">event = model_to_dict(EventDB.objects.get(<span class="built_in">id</span>=event_id))</span><br><span class="line">event[<span class="string">&#x27;name&#x27;</span>] = <span class="number">123</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> django </category>
          
      </categories>
      
      
        <tags>
            
            <tag> django </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>在adminlte中使用datatable</title>
      <link href="/posts/undefined/"/>
      <url>/posts/undefined/</url>
      
        <content type="html"><![CDATA[<h1>基本使用</h1><ul class="lvl-0"><li class="lvl-2">引入文件</li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">&quot;stylesheet&quot;</span> <span class="attr">href</span>=<span class="string">&quot;&#123;% static &#x27;adminlte/plugins/datatables-bs4/css/dataTables.bootstrap4.min.css&#x27; %&#125;&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;&#123;% static &#x27;adminlte/plugins/datatables/jquery.dataTables.min.js&#x27; %&#125;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;&#123;% static &#x27;adminlte/plugins/datatables-bs4/js/dataTables.bootstrap4.min.js&#x27; %&#125;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;&#123;% static &#x27;adminlte/plugins/datatables-responsive/js/dataTables.responsive.min.js&#x27; %&#125;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;&#123;% static &#x27;adminlte/plugins/datatables-responsive/js/responsive.bootstrap4.min.js&#x27; %&#125;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;&#123;% static &#x27;adminlte/plugins/datatables-buttons/js/dataTables.buttons.min.js&#x27; %&#125;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;&#123;% static &#x27;adminlte/plugins/datatables-buttons/js/buttons.bootstrap4.min.js&#x27; %&#125;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure><ul class="lvl-0"><li class="lvl-2">基本js</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">$(<span class="string">&#x27;#usertable&#x27;</span>).<span class="title class_">DataTable</span>(&#123;</span><br><span class="line">        <span class="string">&quot;ajax&quot;</span>: <span class="string">&quot;&#123;% url &#x27;manager:userlist&#x27; %&#125;&quot;</span>,</span><br><span class="line">        <span class="string">&quot;columns&quot;</span>: [</span><br><span class="line">            &#123;<span class="string">&quot;data&quot;</span>: <span class="string">&quot;username&quot;</span>&#125;,</span><br><span class="line">            &#123;<span class="string">&quot;data&quot;</span>: <span class="string">&quot;create_time&quot;</span>&#125;,</span><br><span class="line">            &#123;<span class="string">&quot;data&quot;</span>: <span class="string">&quot;superuser&quot;</span>&#125;,</span><br><span class="line">            &#123;<span class="string">&quot;data&quot;</span>: <span class="string">&quot;passwd_expire_time&quot;</span>&#125;,</span><br><span class="line">            &#123;<span class="string">&quot;data&quot;</span>: <span class="string">&quot;button&quot;</span>&#125;,</span><br><span class="line">        ],</span><br><span class="line">        <span class="attr">language</span>: &#123;<span class="comment">//自定义语言提示</span></span><br><span class="line">            <span class="string">&quot;processing&quot;</span>: <span class="string">&quot;处理中...&quot;</span>,</span><br><span class="line">            <span class="string">&quot;lengthMenu&quot;</span>: <span class="string">&quot;显示 _MENU_ 条用户数据&quot;</span>,</span><br><span class="line">            <span class="string">&quot;zeroRecords&quot;</span>: <span class="string">&quot;没有找到相应的结果&quot;</span>,</span><br><span class="line">            <span class="string">&quot;info&quot;</span>: <span class="string">&quot;第 _START_ 至 _END_ 行，共 _TOTAL_ 行&quot;</span>,</span><br><span class="line">            <span class="string">&quot;infoEmpty&quot;</span>: <span class="string">&quot;第 0 至 0 项结果，共 0 项&quot;</span>,</span><br><span class="line">            <span class="string">&quot;infoFiltered&quot;</span>: <span class="string">&quot;(由 _MAX_ 项结果过滤)&quot;</span>,</span><br><span class="line">            <span class="string">&quot;infoPostFix&quot;</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">            <span class="string">&quot;url&quot;</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">            <span class="string">&quot;thousands&quot;</span>: <span class="string">&quot;&#x27;&quot;</span>,</span><br><span class="line">            <span class="string">&quot;emptyTable&quot;</span>: <span class="string">&quot;表中数据为空&quot;</span>,</span><br><span class="line">            <span class="string">&quot;loadingRecords&quot;</span>: <span class="string">&quot;载入中...&quot;</span>,</span><br><span class="line">            <span class="string">&quot;infoThousands&quot;</span>: <span class="string">&quot;,&quot;</span>,</span><br><span class="line">            <span class="string">&quot;paginate&quot;</span>: &#123;</span><br><span class="line">                <span class="string">&quot;first&quot;</span>: <span class="string">&quot;首页&quot;</span>,</span><br><span class="line">                <span class="string">&quot;previous&quot;</span>: <span class="string">&quot;上页&quot;</span>,</span><br><span class="line">                <span class="string">&quot;next&quot;</span>: <span class="string">&quot;下页&quot;</span>,</span><br><span class="line">                <span class="string">&quot;last&quot;</span>: <span class="string">&quot;末页&quot;</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="comment">// &quot;stateSave&quot;: true,</span></span><br><span class="line">        <span class="comment">// &quot;bAutoWidth&quot;: true,</span></span><br><span class="line">        <span class="comment">// &quot;scrollX&quot;: &quot;true&quot;,</span></span><br><span class="line">        <span class="comment">// &quot;scrollY&quot;: &quot;600px&quot;,</span></span><br><span class="line">        <span class="comment">// &quot;scrollCollapse&quot;: true,</span></span><br><span class="line">        <span class="string">&quot;sDom&quot;</span>: <span class="string">&quot;&lt;&#x27;row&#x27;&lt;&#x27;col-md-6&#x27;&lt;&#x27;#toolbar&#x27;&gt;&gt;&lt;&#x27;col-md-6&#x27;f&gt;&gt;&quot;</span> +  <span class="comment">//设置表格最上面内容，可以在这里添加按钮等其他设置</span></span><br><span class="line"><span class="string">&quot;t&quot;</span> + <span class="comment">//设置tables</span></span><br><span class="line"><span class="string">&quot;&lt;&#x27;row&#x27;&lt;&#x27;col-md-5 sm-center&#x27;li&gt;&lt;&#x27;col-md-7 text-right sm-center&#x27;p&gt;&gt;&quot;</span>,<span class="comment">//设置表格最下面显示内容</span></span><br><span class="line">    &#125;);</span><br><span class="line">    $(<span class="string">&quot;#toolbar&quot;</span>).<span class="title function_">append</span>(<span class="string">&#x27;&lt;a href=&quot;&#123;% url &quot;manager:usercreate&quot; %&#125;&quot;&gt;&lt;button type=&quot;button&quot; class=&quot;btn btn-primary&quot;&gt;&lt;i class=&quot;fa fa-plus-square&quot;&gt;&lt;/i&gt;&amp;nbsp&amp;nbsp新建用户&lt;/button&gt;&lt;/a&gt;&#x27;</span>)</span><br></pre></td></tr></table></figure><ul class="lvl-0"><li class="lvl-2">html</li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">table</span> <span class="attr">id</span>=<span class="string">&quot;eventtable&quot;</span> <span class="attr">class</span>=<span class="string">&quot;table table-bordered table-striped  display hover&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">thead</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">th</span>&gt;</span><span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">th</span>&gt;</span>标题<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">th</span>&gt;</span>完成时间<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">th</span>&gt;</span>事件等级<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">th</span>&gt;</span>工作量<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">th</span>&gt;</span>标签<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">th</span>&gt;</span>状态<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">th</span>&gt;</span>操作<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">thead</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">table</span>&gt;</span></span><br></pre></td></tr></table></figure><h1>后端分页</h1><p>html不变</p><ul class="lvl-0"><li class="lvl-2">js</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> table = $(<span class="string">&#x27;#eventtable&#x27;</span>).<span class="title class_">DataTable</span>(&#123;</span><br><span class="line">        <span class="string">&quot;processing&quot;</span>:<span class="literal">true</span>,</span><br><span class="line">        <span class="string">&quot;serverSide&quot;</span>:<span class="literal">true</span>,  <span class="comment">// 服务器分页</span></span><br><span class="line">        <span class="string">&quot;stateSave&quot;</span>: <span class="literal">true</span>, <span class="comment">//状态保持</span></span><br><span class="line">        <span class="string">&quot;ajax&quot;</span>: <span class="string">&quot;&#123;% url &#x27;event:eventlist&#x27; %&#125;&quot;</span>,</span><br><span class="line">        <span class="string">&quot;autoWidth&quot;</span>:<span class="literal">true</span>,<span class="comment">////不开启自动宽度，用bootstrap的自适应去调整</span></span><br><span class="line">        <span class="string">&quot;lengthMenu&quot;</span>: [<span class="number">10</span>,<span class="number">50</span>, <span class="number">100</span>],<span class="comment">//表格行数选择框内数目 显示2条,4条,20条,50条</span></span><br><span class="line">        <span class="string">&quot;displayLength&quot;</span>: <span class="number">10</span>,<span class="comment">//默认的显示行数 (也就是每页显示几条数据)</span></span><br><span class="line">        <span class="string">&quot;info&quot;</span>:<span class="literal">false</span>,</span><br><span class="line">        <span class="string">&quot;columns&quot;</span>: [</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="string">&quot;class&quot;</span>:<span class="string">&#x27;details-control&#x27;</span>,</span><br><span class="line">                <span class="string">&quot;orderable&quot;</span>: <span class="literal">true</span>,</span><br><span class="line">                <span class="string">&quot;data&quot;</span>: <span class="literal">null</span>,</span><br><span class="line">                <span class="string">&quot;defaultContent&quot;</span>: <span class="string">&#x27;&#x27;</span>,</span><br><span class="line">            &#125;, </span><br><span class="line">            &#123;<span class="string">&quot;data&quot;</span>: <span class="string">&quot;event_title&quot;</span>&#125;,</span><br><span class="line">            &#123;<span class="string">&quot;data&quot;</span>: <span class="string">&quot;event_deadline&quot;</span>&#125;,</span><br><span class="line">            &#123;<span class="string">&quot;data&quot;</span>: <span class="string">&quot;event_level&quot;</span>&#125;,</span><br><span class="line">            &#123;<span class="string">&quot;data&quot;</span>: <span class="string">&quot;event_workload&quot;</span>&#125;,</span><br><span class="line">            &#123;<span class="string">&quot;data&quot;</span>: <span class="string">&quot;event_label&quot;</span>&#125;,</span><br><span class="line">            &#123;<span class="string">&quot;data&quot;</span>: <span class="string">&quot;event_status&quot;</span>&#125;,</span><br><span class="line">            &#123;<span class="string">&quot;data&quot;</span>: <span class="string">&quot;button&quot;</span>&#125;,</span><br><span class="line">        ],</span><br><span class="line">        <span class="string">&quot;order&quot;</span>: [[<span class="number">2</span>, <span class="string">&#x27;asc&#x27;</span>]],</span><br><span class="line">        <span class="string">&quot;language&quot;</span>: &#123;<span class="comment">//自定义语言提示</span></span><br><span class="line">            <span class="string">&quot;processing&quot;</span>: <span class="string">&quot;处理中...&quot;</span>,</span><br><span class="line">            <span class="string">&quot;lengthMenu&quot;</span>: <span class="string">&quot;显示 _MENU_ 项结果&quot;</span>,</span><br><span class="line">            <span class="string">&quot;zeroRecords&quot;</span>: <span class="string">&quot;没有找到相应的结果&quot;</span>,</span><br><span class="line">            <span class="string">&quot;info&quot;</span>: <span class="string">&quot;第 _START_ 至 _END_ 行，共 _TOTAL_ 行&quot;</span>,</span><br><span class="line">            <span class="string">&quot;infoEmpty&quot;</span>: <span class="string">&quot;第 0 至 0 项结果，共 0 项&quot;</span>,</span><br><span class="line">            <span class="string">&quot;infoFiltered&quot;</span>: <span class="string">&quot;(由 _MAX_ 项结果过滤)&quot;</span>,</span><br><span class="line">            <span class="string">&quot;infoPostFix&quot;</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">            <span class="string">&quot;url&quot;</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">            <span class="string">&quot;thousands&quot;</span>: <span class="string">&quot;&#x27;&quot;</span>,</span><br><span class="line">            <span class="string">&quot;emptyTable&quot;</span>: <span class="string">&quot;表中数据为空&quot;</span>,</span><br><span class="line">            <span class="string">&quot;loadingRecords&quot;</span>: <span class="string">&quot;载入中...&quot;</span>,</span><br><span class="line">            <span class="string">&quot;infoThousands&quot;</span>: <span class="string">&quot;,&quot;</span>,</span><br><span class="line">            <span class="string">&quot;paginate&quot;</span>: &#123;</span><br><span class="line">                <span class="string">&quot;first&quot;</span>: <span class="string">&quot;首页&quot;</span>,</span><br><span class="line">                <span class="string">&quot;previous&quot;</span>: <span class="string">&quot;上页&quot;</span>,</span><br><span class="line">                <span class="string">&quot;next&quot;</span>: <span class="string">&quot;下页&quot;</span>,</span><br><span class="line">                <span class="string">&quot;last&quot;</span>: <span class="string">&quot;末页&quot;</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="string">&quot;sDom&quot;</span>: <span class="string">&quot;&lt;&#x27;row&#x27;&lt;&#x27;col-md-6&#x27;&lt;&#x27;#toolbar&#x27;&gt;&gt;&lt;&#x27;col-md-6&#x27;f&gt;&gt;&quot;</span> +  <span class="comment">//设置表格最上面内容，可以在这里添加按钮等其他设置</span></span><br><span class="line">        <span class="string">&quot;t&quot;</span> + <span class="comment">//设置tables</span></span><br><span class="line">        <span class="string">&quot;&lt;&#x27;row&#x27;&lt;&#x27;col-md-5 sm-center&#x27;li&gt;&lt;&#x27;col-md-7 text-right sm-center&#x27;p&gt;&gt;&quot;</span></span><br><span class="line">    &#125; );</span><br><span class="line">    $(<span class="string">&quot;#toolbar&quot;</span>).<span class="title function_">append</span>(<span class="string">&#x27;&lt;a href=&quot;&#123;% url &quot;event:eventedit&quot; %&#125;&quot;&gt;&lt;button type=&quot;button&quot; class=&quot;btn btn-primary&quot;&gt;&lt;i class=&quot;fa fa-plus-square&quot;&gt;&lt;/i&gt;&amp;nbsp&amp;nbsp新建代办&lt;/button&gt;&lt;/a&gt;&#x27;</span>)</span><br></pre></td></tr></table></figure><ul class="lvl-0"><li class="lvl-2"><p>django</p></li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">_query_data = request.GET</span><br><span class="line"><span class="comment"># 获取开始值</span></span><br><span class="line">start_index = <span class="built_in">int</span>(_query_data.get(<span class="string">&quot;start&quot;</span>,<span class="number">0</span>))</span><br><span class="line"><span class="comment"># 获取列表长度</span></span><br><span class="line">search_length = <span class="built_in">int</span>(_query_data.get(<span class="string">&quot;length&quot;</span>,<span class="number">10</span>))</span><br><span class="line"><span class="comment"># 算出列表区间</span></span><br><span class="line">end_index = start_index + search_length</span><br><span class="line"><span class="comment"># 搜索，前端点搜索，search[value]有数据，根据这个数据去搜索</span></span><br><span class="line"><span class="keyword">if</span> _query_data.get(<span class="string">&#x27;search[value]&#x27;</span>):</span><br><span class="line">    search_str =  _query_data.get(<span class="string">&#x27;search[value]&#x27;</span>)</span><br><span class="line">    <span class="comment"># 搜索有意义的段</span></span><br><span class="line"></span><br><span class="line">    EventInfo = EventDB.objects.<span class="built_in">filter</span>(Q(event_title__icontains=search_str) | Q(event_level__icontains=search_str) | Q(event_detail__icontains=search_str) | Q(event_label__icontains=search_str))</span><br><span class="line"><span class="keyword">else</span>:    </span><br><span class="line">    <span class="comment"># 没搜索就查全部</span></span><br><span class="line">    EventInfo = EventDB.objects.<span class="built_in">all</span>()</span><br><span class="line"><span class="comment"># 获取排序的列，这里循环了10次，可以根据自己的列数进行调整</span></span><br><span class="line">order_args = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="number">10</span>):</span><br><span class="line">    order_column=<span class="string">&#x27;order[%d][column]&#x27;</span> % i</span><br><span class="line">    <span class="keyword">if</span> _query_data.get(order_column):   </span><br><span class="line">        order_col = _query_data.get(<span class="string">f&quot;columns[<span class="subst">&#123;_query_data.get(order_column)&#125;</span>][data]&quot;</span>)</span><br><span class="line">        order_args.append(order_col)</span><br><span class="line">    <span class="keyword">if</span> _query_data.get(<span class="string">&#x27;order[%d][dir]&#x27;</span> % i) == <span class="string">&quot;asc&quot;</span>:</span><br><span class="line">        order_col = <span class="string">&#x27;-&#x27;</span> + order_col</span><br><span class="line">        order_args.append(order_col)</span><br><span class="line"><span class="comment"># order_by可以传入多个值，在不确定要传入多少个值的情况下，可以把值先保存到列表，再通过*args把列表的多个值传入</span></span><br><span class="line">EventInfo = EventInfo.order_by(*order_args)[start_index:end_index]</span><br></pre></td></tr></table></figure><h1>datatable 定时刷新</h1><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">$(<span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">function</span> <span class="title function_">refresh</span>(<span class="params"></span>) &#123;</span><br><span class="line">          <span class="keyword">var</span> table = $(<span class="string">&#x27;#eventtable&#x27;</span>).<span class="title class_">DataTable</span>();</span><br><span class="line">          table.<span class="property">ajax</span>.<span class="title function_">reload</span>(<span class="literal">null</span>, <span class="literal">false</span>); <span class="comment">// 刷新表格数据，分页信息不会重置</span></span><br><span class="line">        &#125;</span><br><span class="line">    <span class="comment">// 每隔5秒刷新一次数据</span></span><br><span class="line">    <span class="built_in">setInterval</span>(refresh, <span class="number">5000</span>);</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> django </category>
          
      </categories>
      
      
        <tags>
            
            <tag> adminlte </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>在adminlte中使用select2</title>
      <link href="/posts/undefined/"/>
      <url>/posts/undefined/</url>
      
        <content type="html"><![CDATA[<p>引入<code>css</code>和<code>js</code></p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">&quot;stylesheet&quot;</span> <span class="attr">href</span>=<span class="string">&quot;&#123;% static &#x27;adminlte/plugins/select2/css/select2.min.css&#x27; %&#125;&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">&quot;stylesheet&quot;</span> <span class="attr">href</span>=<span class="string">&quot;&#123;% static &#x27;adminlte/plugins/select2-bootstrap4-theme/select2-bootstrap4.min.css&#x27; %&#125;&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;&#123;% static &#x27;adminlte/plugins/select2/js/select2.full.min.js&#x27; %&#125;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure><h1>基本使用</h1><ul class="lvl-0"><li class="lvl-2"><p>html 复制的时候把<code>span</code>标签的内容去掉</p></li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;form-group&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">label</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">style</span>=<span class="string">&quot;color: red;&quot;</span>&gt;</span>*<span class="tag">&lt;/<span class="name">a</span>&gt;</span>标签<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;select2-purple&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">select</span> <span class="attr">class</span>=<span class="string">&quot;select2bs4 select2-hidden-accessible&quot;</span> <span class="attr">multiple</span>=<span class="string">&quot;&quot;</span> <span class="attr">data-dropdown-css-class</span>=<span class="string">&quot;select2-purple&quot;</span> <span class="attr">data-placeholder</span>=<span class="string">&quot;Select a State&quot;</span> <span class="attr">style</span>=<span class="string">&quot;width: 100%;&quot;</span> <span class="attr">data-select2-id</span>=<span class="string">&quot;23&quot;</span> <span class="attr">tabindex</span>=<span class="string">&quot;-1&quot;</span> <span class="attr">aria-hidden</span>=<span class="string">&quot;true&quot;</span> <span class="attr">name</span>=<span class="string">&quot;event_label&quot;</span> <span class="attr">id</span>=<span class="string">&quot;event_label&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">option</span> <span class="attr">vlaue</span>=<span class="string">&quot;材料&quot;</span>&gt;</span>材料<span class="tag">&lt;/<span class="name">option</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">option</span> <span class="attr">vlaue</span>=<span class="string">&quot;学习&quot;</span>&gt;</span>学习<span class="tag">&lt;/<span class="name">option</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">option</span> <span class="attr">vlaue</span>=<span class="string">&quot;问题处理&quot;</span>&gt;</span>问题处理<span class="tag">&lt;/<span class="name">option</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">option</span> <span class="attr">vlaue</span>=<span class="string">&quot;会议&quot;</span>&gt;</span>会议<span class="tag">&lt;/<span class="name">option</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">option</span> <span class="attr">vlaue</span>=<span class="string">&quot;其它&quot;</span>&gt;</span>其它<span class="tag">&lt;/<span class="name">option</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure><ul class="lvl-0"><li class="lvl-2"><p>js</p></li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$(<span class="string">&quot;#event_label&quot;</span>).<span class="title function_">select2</span>()</span><br></pre></td></tr></table></figure><h1>默认值</h1><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"># 默认单选</span><br><span class="line">$(<span class="string">&#x27;#event_label&#x27;</span>).<span class="title function_">val</span>(<span class="string">&quot;Low&quot;</span>)</span><br><span class="line"># jquery可以把字符串转换为数组</span><br><span class="line">arrValue = <span class="string">&quot;&#123;&#123; event_label &#125;&#125;&quot;</span>.<span class="title function_">split</span>(<span class="string">&#x27;;&#x27;</span>);</span><br><span class="line"># 多选时，传入数组，可以默认选中多个</span><br><span class="line">$(<span class="string">&#x27;#event_label&#x27;</span>).<span class="title function_">val</span>(arrValue).<span class="title function_">trigger</span>(<span class="string">&#x27;change&#x27;</span>)</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> django </category>
          
      </categories>
      
      
        <tags>
            
            <tag> adminlte </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Linux创建证书</title>
      <link href="/posts/6646b637/"/>
      <url>/posts/6646b637/</url>
      
        <content type="html"><![CDATA[<p>创建证书请求文件CSR和私钥</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">openssl req -new -nodes -sha256 -newkey rsa:2048 -keyout [<span class="variable">$Key_File</span>] -out [<span class="variable">$OpenSSL_CSR</span>]</span><br><span class="line">说明</span><br><span class="line">new：指定生成一个新的 CSR 文件。</span><br><span class="line">nodes：指定密钥文件不被加密。</span><br><span class="line">sha256：指定摘要算法。</span><br><span class="line">newkey rsa:2048：指定密钥类型和长度。</span><br><span class="line">[<span class="variable">$Key_File</span>]：密钥文件名称。</span><br><span class="line">[<span class="variable">$OpenSSL_CSR</span>]：加密后文件的存放路径。new：指定生成一个新的 CSR 文件。</span><br><span class="line">4. 根据系统返回的提示，输入生成 CSR 文件所需的信息。以下是关于提示的说明：</span><br><span class="line">Organization Name：公司名称，可以是中文或英文。</span><br><span class="line">Organizational Unit Name：部门名称，可以是中文或英文。</span><br><span class="line">Country Code：申请单位所属国家，只能是两个字母的国家码。例如，中国填写为 CN。</span><br><span class="line">State or Province Name：州名或省份名称，可以是中文或英文。</span><br><span class="line">Locality Name：城市名称，可以是中文或英文。</span><br><span class="line">Common Name：申请 SSL 证书的具体网站域名。</span><br><span class="line">Email Address：可选择不输入。</span><br><span class="line">Challenge Password：可选择不输入。</span><br><span class="line">5. 按照命令提示输入相应内容后，即可在当前目录下获取密钥文件和 CSR 文件。</span><br></pre></td></tr></table></figure><p>创建证书</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">openssl x509 -signkey xxx.key -<span class="keyword">in</span> xxx.csr -req -days 365 -out xxx.crt</span><br></pre></td></tr></table></figure><p>获取证书过期时间</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">openssl x509 -<span class="keyword">in</span> &lt;cert&gt;.pem -noout -dates</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> Linux </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Linux基础 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>django和adminlte笔记</title>
      <link href="/posts/undefined/"/>
      <url>/posts/undefined/</url>
      
        <content type="html"><![CDATA[<h1>django</h1><h2 id="新增环境">新增环境</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">apt install python3-venv</span><br><span class="line">python3 -m venv django4</span><br><span class="line"><span class="built_in">source</span> django4/bin/active</span><br></pre></td></tr></table></figure><h2 id="安装Django">安装Django</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip install django  -i http://pypi.douban.com/simple/ --trusted-host=pypi.douban.com/simple </span><br></pre></td></tr></table></figure><h2 id="创建和初始化项目">创建和初始化项目</h2><p>创建</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">django-admin startproject mysite</span><br></pre></td></tr></table></figure><p>修改settings文件</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os <span class="comment"># 新增</span></span><br><span class="line">ALLOWED_HOSTS = [<span class="string">&#x27;*&#x27;</span>] <span class="comment">#修改</span></span><br><span class="line"><span class="comment"># 修改</span></span><br><span class="line">TEMPLATES = [</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="string">&#x27;BACKEND&#x27;</span>: <span class="string">&#x27;django.template.backends.django.DjangoTemplates&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;DIRS&#x27;</span>: [os.path.join(BASE_DIR,<span class="string">&#x27;templates&#x27;</span>)], <span class="comment">#修改</span></span><br><span class="line">        <span class="string">&#x27;APP_DIRS&#x27;</span>: <span class="literal">True</span>,</span><br><span class="line">        <span class="string">&#x27;OPTIONS&#x27;</span>: &#123;</span><br><span class="line">            <span class="string">&#x27;context_processors&#x27;</span>: [</span><br><span class="line">                <span class="string">&#x27;django.template.context_processors.debug&#x27;</span>,</span><br><span class="line">                <span class="string">&#x27;django.template.context_processors.request&#x27;</span>,</span><br><span class="line">                <span class="string">&#x27;django.contrib.auth.context_processors.auth&#x27;</span>,</span><br><span class="line">                <span class="string">&#x27;django.contrib.messages.context_processors.messages&#x27;</span>,</span><br><span class="line">            ],</span><br><span class="line">        &#125;,</span><br><span class="line">    &#125;,</span><br><span class="line">]</span><br><span class="line"><span class="comment"># 以下为修改</span></span><br><span class="line">LANGUAGE_CODE = <span class="string">&#x27;zh-hans&#x27;</span></span><br><span class="line">TIME_ZONE = <span class="string">&#x27;Asia/Shanghai&#x27;</span></span><br><span class="line">USE_TZ = <span class="literal">False</span></span><br><span class="line"><span class="comment"># 新增static</span></span><br><span class="line">STATICFILES_DIRS = [</span><br><span class="line">    os.path.join(BASE_DIR, <span class="string">&quot;static&quot;</span>),</span><br><span class="line">]</span><br></pre></td></tr></table></figure><p>新增文件夹</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">mkdir</span> 项目目录/templates 项目目录/static</span><br></pre></td></tr></table></figure><h2 id="自定义用户模型">自定义用户模型</h2><p>新建一个app</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python manage.py startapp manager</span><br></pre></td></tr></table></figure><p>注册到settings.py中</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">INSTALLED_APPS = [</span><br><span class="line">    <span class="string">&#x27;django.contrib.admin&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;django.contrib.auth&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;django.contrib.contenttypes&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;django.contrib.sessions&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;django.contrib.messages&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;django.contrib.staticfiles&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;manager&#x27;</span>, <span class="comment">#新增</span></span><br><span class="line">]</span><br></pre></td></tr></table></figure><p>修改manager/models.py，根据自己的需要修改</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> django.db <span class="keyword">import</span> models</span><br><span class="line"><span class="keyword">from</span> django.contrib.auth.models <span class="keyword">import</span> BaseUserManager,AbstractUser</span><br><span class="line"><span class="keyword">import</span> uuid</span><br><span class="line"><span class="comment"># Create your models here.</span></span><br><span class="line"><span class="comment"># 自定义user，还需要在setting文件中配置AUTH_USER_MODELS</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">UserDB</span>(<span class="title class_ inherited__">AbstractUser</span>):</span><br><span class="line">    uid = models.UUIDField(primary_key=<span class="literal">True</span>,default=uuid.uuid4)</span><br><span class="line">    username = models.CharField(max_length=<span class="number">15</span>,verbose_name=<span class="string">&quot;用户名&quot;</span>, unique=<span class="literal">True</span>)</span><br><span class="line">    phone = models.CharField(max_length=<span class="number">11</span>,verbose_name=<span class="string">&quot;手机号码&quot;</span>, null=<span class="literal">True</span>,blank=<span class="literal">True</span>)</span><br><span class="line">    email = models.EmailField(verbose_name=<span class="string">&#x27;邮箱&#x27;</span>, null=<span class="literal">True</span>,blank=<span class="literal">True</span>)</span><br><span class="line">    create_time = models.DateTimeField(<span class="string">&#x27;创建时间&#x27;</span>,auto_now_add=<span class="literal">True</span>)</span><br><span class="line">    update_time = models.DateTimeField(<span class="string">&#x27;更新时间&#x27;</span>,auto_now=<span class="literal">True</span>)</span><br><span class="line">    <span class="keyword">class</span> <span class="title class_">Meta</span>:</span><br><span class="line">        verbose_name = <span class="string">&#x27;用户信息&#x27;</span></span><br><span class="line">        verbose_name_plural = verbose_name</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__str__</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">return</span> self.username</span><br></pre></td></tr></table></figure><p>编辑settings.py文件</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 新增自定义用户模型</span></span><br><span class="line">AUTH_USER_MODEL = <span class="string">&#x27;manager.UserDB&#x27;</span></span><br></pre></td></tr></table></figure><h2 id="数据库迁移">数据库迁移</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#生成迁移文件</span></span><br><span class="line">python manage.py makemigrations</span><br><span class="line"><span class="comment">#应用迁移文件</span></span><br><span class="line">python manage.py migrate</span><br></pre></td></tr></table></figure><h2 id="创建用户">创建用户</h2><ul class="lvl-0"><li class="lvl-2"><p>管理员用户</p></li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python manage.py createsuperuser</span><br></pre></td></tr></table></figure><ul class="lvl-0"><li class="lvl-2"><p>普通用户进入项目shell</p></li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python manage.py shell</span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> django.contrib.auth.models <span class="keyword">import</span> User(用户数据库，默认为User，如果自定义了这里需要修改)</span><br><span class="line">User.objects.create_user(<span class="string">&#x27;username&#x27;</span>, <span class="string">&#x27;email@example.com&#x27;</span>, <span class="string">&#x27;password&#x27;</span>)</span><br></pre></td></tr></table></figure><h2 id="站点验证和登录">站点验证和登录</h2><p>除了指定界面，用户访问其他界面时，如果没有登录就跳到登录界面，登录完成后跳转到需要访问的界面比如用户访问：<a href="https://51yunwei.top/system/">https://51yunwei.top/system/</a> ，会跳转为 <a href="https://51yunwei.top/login/?next=/system/%EF%BC%8C%E5%AE%8C%E6%88%90%E7%99%BB%E5%BD%95%E5%90%8E%EF%BC%8C%E8%B7%B3%E8%BD%AC%E5%9B%9Ehttps://51yunwei.top/system/">https://51yunwei.top/login/?next=/system/，完成登录后，跳转回https://51yunwei.top/system/</a><br>此处代码来自运维咖啡吧，通过中间件的方式进行处理</p><ul class="lvl-0"><li class="lvl-2"><p>新建一个目录</p></li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">mkdir</span> system/middleware -p</span><br><span class="line"><span class="built_in">cd</span> system/middleware</span><br><span class="line"><span class="built_in">touch</span> __init__.py</span><br><span class="line"><span class="built_in">touch</span> loginrequired.py</span><br></pre></td></tr></table></figure><ul class="lvl-0"><li class="lvl-2"><p>编辑loginrequired.py文件</p></li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> django.shortcuts <span class="keyword">import</span> redirect</span><br><span class="line"><span class="keyword">from</span> django.conf <span class="keyword">import</span> settings</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">LoginRequiredMiddleware</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, get_response</span>): <span class="comment"># 启动django的时候会执行init，用get_resonpse来获取下一个中间件或视图函数的响应</span></span><br><span class="line">        self.get_response = get_response </span><br><span class="line">        self.login_url = settings.LOGIN_URL</span><br><span class="line">        self.open_urls = [self.login_url] + <span class="built_in">getattr</span>(settings, <span class="string">&#x27;OPEN_URLS&#x27;</span>, []) <span class="comment"># 登录界面和OPEN_URLS里面的路径都是开放的</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__call__</span>(<span class="params">self, request</span>): <span class="comment"># 每次有请求到达时，Django都会调用这个方法。</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> request.user.is_authenticated <span class="keyword">and</span> request.path_info <span class="keyword">not</span> <span class="keyword">in</span> self.open_urls:</span><br><span class="line">            <span class="keyword">return</span> redirect(self.login_url + <span class="string">&#x27;?next=&#x27;</span> + request.path)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> self.get_response(request) <span class="comment"># 每个中间件都有一个get_response函数，这个函数会返回下一个中间件或视图函数的响应。</span></span><br></pre></td></tr></table></figure><p>OPEN_URLS：不需要验证就能访问到的界面<br>LOGIN_URL：需要验证才能访问到的界面通过在settings中配置变量实现</p><ul class="lvl-0"><li class="lvl-2"><p>编辑settings文件</p></li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">MIDDLEWARE = [</span><br><span class="line">    <span class="string">&#x27;django.middleware.security.SecurityMiddleware&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;django.contrib.sessions.middleware.SessionMiddleware&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;django.middleware.common.CommonMiddleware&#x27;</span>,</span><br><span class="line">    <span class="comment"># &#x27;django.middleware.csrf.CsrfViewMiddleware&#x27;,</span></span><br><span class="line">    <span class="string">&#x27;django.contrib.auth.middleware.AuthenticationMiddleware&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;django.contrib.messages.middleware.MessageMiddleware&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;django.middleware.clickjacking.XFrameOptionsMiddleware&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;system.middleware.loginrequired.LoginRequiredMiddleware&#x27;</span>, <span class="comment"># 新增，根据自己的路径进行修改</span></span><br><span class="line">]</span><br><span class="line">&gt; 注意：验证的中间件要放最后面，因为最后一个中间件是第一个执行的。</span><br><span class="line"></span><br><span class="line"><span class="comment"># 新增全局登录地址</span></span><br><span class="line">LOGIN_URL=<span class="string">&#x27;/login/&#x27;</span></span><br><span class="line">OPEN_URLS=[]</span><br></pre></td></tr></table></figure><h2 id="在登录的函数中拿到next地址，并返回，如下">在登录的函数中拿到next地址，并返回，如下</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">LoginView</span>(<span class="title class_ inherited__">View</span>):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">get</span>(<span class="params">self,request</span>):</span><br><span class="line">        <span class="keyword">if</span> request.user.is_authenticated:</span><br><span class="line">            <span class="keyword">return</span> render(request,<span class="string">&#x27;base.html&#x27;</span>)</span><br><span class="line">        <span class="keyword">return</span> render(request,<span class="string">&#x27;login.html&#x27;</span>)</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">post</span>(<span class="params">self,request</span>):</span><br><span class="line">        <span class="comment"># 判断用户登录</span></span><br><span class="line">        next_path = request.GET.get(<span class="string">&#x27;next&#x27;</span>,<span class="string">&#x27;/&#x27;</span>) <span class="comment"># 虽然是post方法，但还是可以用GET来获取路径的参数，即 ?key=value</span></span><br><span class="line">        username = request.POST.get(<span class="string">&#x27;username&#x27;</span>,<span class="string">&#x27;&#x27;</span>)</span><br><span class="line">        password = request.POST.get(<span class="string">&#x27;password&#x27;</span>,<span class="string">&#x27;&#x27;</span>)</span><br><span class="line">        <span class="comment"># print(&#x27;post next====&#x27;,request.POST.get(&#x27;next&#x27;,&#x27;&#x27;),request.POST)</span></span><br><span class="line">        user = authenticate(username=username,password=password)</span><br><span class="line">        <span class="keyword">if</span> user:</span><br><span class="line">            login(request,user)</span><br><span class="line">            request.session[<span class="string">&quot;username&quot;</span>] = username</span><br><span class="line">            request.session.set_expiry(<span class="number">0</span>)  <span class="comment"># 设置session过期时间为一周后</span></span><br><span class="line">            <span class="keyword">return</span> redirect(next_path)</span><br><span class="line">        login_error_message = <span class="string">&#x27;用户名或密码错误&#x27;</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;登录失败&#x27;</span>)</span><br><span class="line">        <span class="keyword">return</span> render(request,<span class="string">&#x27;login.html&#x27;</span>,&#123;<span class="string">&#x27;login_error_message&#x27;</span>:login_error_message&#125;)</span><br></pre></td></tr></table></figure><h2 id="返回函数">返回函数</h2><p>一些常见的视图返回函数的导入方式：</p><ol><li class="lvl-3"><p><code>HttpResponse</code>：这是一个Django内置的HTTP响应类，可以直接从<code>django.http</code>模块导入。</p></li></ol><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> django.http <span class="keyword">import</span> HttpResponse</span><br></pre></td></tr></table></figure><ol start="2"><li class="lvl-3"><p><code>HttpResponseRedirect</code>：这也是一个Django内置的HTTP响应类，可以直接从<code>django.http</code>模块导入。</p></li></ol><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> django.http <span class="keyword">import</span> HttpResponseRedirect</span><br></pre></td></tr></table></figure><ol start="3"><li class="lvl-3"><p><code>render</code>：这是一个用于渲染模板并返回HTTP响应的函数，可以从<code>django.shortcuts</code>模块导入。</p></li></ol><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> django.shortcuts <span class="keyword">import</span> render</span><br></pre></td></tr></table></figure><ol start="4"><li class="lvl-3"><p><code>redirect</code>：这是一个用于返回重定向视图的函数，也可以从<code>django.shortcuts</code>模块导入。</p></li></ol><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> django.shortcuts <span class="keyword">import</span> redirect</span><br></pre></td></tr></table></figure><ol start="5"><li class="lvl-3"><p><code>JsonResponse</code>：这是一个用于返回JSON格式HTTP响应的函数，可以从<code>django.http</code>模块导入。</p></li></ol><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> django.http <span class="keyword">import</span> JsonResponse</span><br></pre></td></tr></table></figure><ol start="6"><li class="lvl-3"><p><code>Response</code>：这是Django REST Framework中的一个函数，用于返回HTTP响应，需要从<code>rest_framework.response</code>模块导入。</p></li></ol><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> rest_framework.response <span class="keyword">import</span> Response</span><br></pre></td></tr></table></figure><ol start="7"><li class="lvl-3"><p><code>reverse</code></p></li></ol><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> django.urls <span class="keyword">import</span> reverse</span><br></pre></td></tr></table></figure><h2 id="设置url">设置url</h2><p>在项目根urls.py中配置</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> django.contrib <span class="keyword">import</span> admin</span><br><span class="line"><span class="keyword">from</span> django.urls <span class="keyword">import</span> path,include <span class="comment"># 新增include</span></span><br><span class="line"></span><br><span class="line">urlpatterns = [</span><br><span class="line">    path(<span class="string">&#x27;admin/&#x27;</span>, admin.site.urls),</span><br><span class="line">    path(<span class="string">&#x27;&#x27;</span>, include(<span class="string">&#x27;manager.urls&#x27;</span>)), <span class="comment"># 新增，app名称.urls</span></span><br><span class="line">]</span><br></pre></td></tr></table></figure><p><a href="http://xn--appurls-qw3kg19de2rt2a417co16c.py">在app目录下新建urls.py</a></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> django.urls <span class="keyword">import</span> path</span><br><span class="line"><span class="keyword">from</span> . <span class="keyword">import</span> views</span><br><span class="line">urlpatterns = [</span><br><span class="line">    path(<span class="string">&#x27;&#x27;</span>, views.IndexView),</span><br><span class="line">    path(<span class="string">&#x27;user/&#x27;</span>,views.UserManager.as_view()),</span><br><span class="line">    path(<span class="string">&#x27;login/&#x27;</span>,views.LoginView.as_view()),</span><br><span class="line">    path(<span class="string">&#x27;user/&lt;uuid:uid&gt;/&#x27;</span>,views.UserDetail),</span><br><span class="line">    path(<span class="string">&#x27;logout/&#x27;</span>,views.LogOut),</span><br><span class="line">]</span><br></pre></td></tr></table></figure><h2 id="使用url模板标签生成路径">使用url模板标签生成路径</h2><ul class="lvl-0"><li class="lvl-2"><p>在url中配置name</p></li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">urlpatterns = [</span><br><span class="line">    path(<span class="string">&#x27;&#x27;</span>, views.IndexView),</span><br><span class="line">    path(<span class="string">&#x27;user/&#x27;</span>,views.UserManager.as_view(),name=<span class="string">&#x27;userlist&#x27;</span>), <span class="comment"># 配置name</span></span><br><span class="line">    path(<span class="string">&#x27;login/&#x27;</span>,views.LoginView.as_view()),</span><br><span class="line">    path(<span class="string">&#x27;user/&lt;uuid:uid&gt;/&#x27;</span>,views.UserDetail),</span><br><span class="line">    path(<span class="string">&#x27;logout/&#x27;</span>,views.LogOut),</span><br><span class="line">]</span><br></pre></td></tr></table></figure><ul class="lvl-0"><li class="lvl-2"><p>在前端文件使用</p></li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;&#123;% url &#x27;userlist&#x27; %&#125;&quot;</span> <span class="attr">class</span>=<span class="string">&quot;nav-link&quot;</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- 如果需要用到变量，year为变量 --&gt;</span></span><br><span class="line">&#123;% url &#x27;blog-list&#x27; year %&#125;</span><br></pre></td></tr></table></figure><ul class="lvl-0"><li class="lvl-2"><p>如果有多个相同名称的name，可以在urls.py中设置一个app_name来区分</p></li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># manager/urls.py</span></span><br><span class="line">app_name=<span class="string">&#x27;manager&#x27;</span></span><br></pre></td></tr></table></figure><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;&#123;% url &#x27;manager:userlist&#x27; %&#125;&quot;</span> <span class="attr">class</span>=<span class="string">&quot;nav-link&quot;</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="获取post数据">获取post数据</h2><p>获取post数据</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">username = request.POST.get(<span class="string">&#x27;username&#x27;</span>,<span class="string">&#x27;&#x27;</span>)</span><br></pre></td></tr></table></figure><p>在post方法中也可以用GET</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">post</span>(<span class="params">self,request</span>):</span><br><span class="line">        <span class="comment"># 判断用户登录</span></span><br><span class="line">        next_path = request.GET.get(<span class="string">&#x27;next&#x27;</span>,<span class="string">&#x27;/&#x27;</span>) <span class="comment"># 虽然是post方法，但还是可以用GET来获取路径的参数，即 ?key=value</span></span><br></pre></td></tr></table></figure><h2 id="登录和退出登录和session">登录和退出登录和session</h2><ul class="lvl-0"><li class="lvl-2"><p>登录和session</p></li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> django.contrib.auth <span class="keyword">import</span> authenticate,login,logout</span><br><span class="line">username = request.POST.get(<span class="string">&#x27;username&#x27;</span>,<span class="string">&#x27;&#x27;</span>)</span><br><span class="line">password = request.POST.get(<span class="string">&#x27;password&#x27;</span>,<span class="string">&#x27;&#x27;</span>)</span><br><span class="line"><span class="comment"># print(&#x27;post next====&#x27;,request.POST.get(&#x27;next&#x27;,&#x27;&#x27;),request.POST)</span></span><br><span class="line">user = authenticate(username=username,password=password)</span><br><span class="line"><span class="keyword">if</span> user:</span><br><span class="line">    login(request,user)</span><br><span class="line">    request.session[<span class="string">&quot;username&quot;</span>] = username <span class="comment"># 设置session</span></span><br><span class="line">    request.session.set_expiry(<span class="number">0</span>)  <span class="comment"># 关闭浏览器就过期</span></span><br><span class="line">    <span class="keyword">return</span> redirect(next_path)</span><br></pre></td></tr></table></figure><ul class="lvl-0"><li class="lvl-2"><p>退出登录</p></li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> django.contrib.auth <span class="keyword">import</span> authenticate,login,logout</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">LogOut</span>(<span class="params">request</span>):</span><br><span class="line">    <span class="keyword">if</span> request.user:</span><br><span class="line">        logout(request)</span><br><span class="line">    <span class="keyword">return</span> redirect(<span class="string">&#x27;/login/&#x27;</span>)</span><br></pre></td></tr></table></figure><h2 id="设置密码和检查密码">设置密码和检查密码</h2><p>设置密码使用set_password</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">user.set_password(<span class="string">&#x27;xxxx&#x27;</span>)</span><br></pre></td></tr></table></figure><p>检查密码是否和输入的一致</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> django.contrib.auth.hashers <span class="keyword">import</span> check_password</span><br><span class="line">check_password(request.POST.get(<span class="string">&#x27;currpassword&#x27;</span>),user.password)  <span class="comment"># 输入的密码，数据库中保存的密码</span></span><br></pre></td></tr></table></figure><h2 id="上传到github">上传到github</h2><p>1、生成requirements.txt文件</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip freeze &gt; ./requirements.txt文件</span><br></pre></td></tr></table></figure><h2 id="设置全局可使用的变量">设置全局可使用的变量</h2><p>在template中，我们可以直接使用request变量，现在我们来设置一下可以直接使用的自定义变量<br>system/systeminfo.py</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> manager.models <span class="keyword">import</span> SystemInfoDB</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">SystemInfo</span>(<span class="params">request</span>):</span><br><span class="line">    system_info = SystemInfoDB.objects.<span class="built_in">all</span>()</span><br><span class="line">    <span class="keyword">if</span> system_info.count():</span><br><span class="line">        system_title = system_info.first().system_title <span class="keyword">if</span> system_info.first().system_title <span class="keyword">else</span> <span class="string">&#x27;未设置的title&#x27;</span></span><br><span class="line">        system_name = system_info.first().system_name <span class="keyword">if</span> system_info.first().system_name <span class="keyword">else</span> <span class="string">&#x27;未设置的系统名称&#x27;</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        system_title = <span class="string">&#x27;未设置的title&#x27;</span></span><br><span class="line">        system_name = <span class="string">&#x27;未设置的系统名称&#x27;</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> &#123;<span class="string">&#x27;systeminfo&#x27;</span>:&#123;<span class="string">&#x27;system_title&#x27;</span>:system_title,<span class="string">&#x27;system_name&#x27;</span>:system_name&#125;&#125;</span><br></pre></td></tr></table></figure><p>manager/models.py</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">SystemInfoDB</span>(models.Model):</span><br><span class="line">    system_title = models.CharField(max_length=<span class="number">128</span>,verbose_name=<span class="string">&quot;网页title&quot;</span>)</span><br><span class="line">    system_name = models.CharField(max_length=<span class="number">128</span>,verbose_name=<span class="string">&quot;站点名称&quot;</span>)</span><br><span class="line">    <span class="keyword">class</span> <span class="title class_">Meta</span>:</span><br><span class="line">        verbose_name = <span class="string">&#x27;系统信息&#x27;</span></span><br><span class="line">        verbose_name_plural = verbose_name</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__str__</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">return</span> self.system_name</span><br></pre></td></tr></table></figure><p><a href="http://settings.py">settings.py</a></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">TEMPLATES = [</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="string">&#x27;BACKEND&#x27;</span>: <span class="string">&#x27;django.template.backends.django.DjangoTemplates&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;DIRS&#x27;</span>: [os.path.join(BASE_DIR,<span class="string">&#x27;templates&#x27;</span>)],</span><br><span class="line">        <span class="string">&#x27;APP_DIRS&#x27;</span>: <span class="literal">True</span>,</span><br><span class="line">        <span class="string">&#x27;OPTIONS&#x27;</span>: &#123;</span><br><span class="line">            <span class="string">&#x27;context_processors&#x27;</span>: [</span><br><span class="line">                <span class="string">&#x27;django.template.context_processors.debug&#x27;</span>,</span><br><span class="line">                <span class="string">&#x27;django.template.context_processors.request&#x27;</span>,</span><br><span class="line">                <span class="string">&#x27;django.contrib.auth.context_processors.auth&#x27;</span>,</span><br><span class="line">                <span class="string">&#x27;django.contrib.messages.context_processors.messages&#x27;</span>,</span><br><span class="line">                <span class="string">&#x27;system.systeminfo.SystemInfo&#x27;</span>, <span class="comment"># 新增</span></span><br><span class="line">            ],</span><br><span class="line">        &#125;,</span><br><span class="line">    &#125;,</span><br><span class="line">]</span><br></pre></td></tr></table></figure><p>这样就可以直接在html中使用这个变量了</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">title</span>&gt;</span>&#123;&#123; systeminfo.system_title &#125;&#125;<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br></pre></td></tr></table></figure><h1>adminlte</h1><h2 id="点击菜单加载页面后，菜单没有高亮">点击菜单加载页面后，菜单没有高亮</h2><p>在base.html添加以下代码</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line">  <span class="comment">// 选择所有class为&#x27;nav-sidebar&#x27;的ul元素下的li元素</span></span><br><span class="line">  $(<span class="string">&#x27;ul.nav-sidebar li&#x27;</span>).<span class="title function_">each</span>(<span class="keyword">function</span>(<span class="params">i</span>)&#123;</span><br><span class="line">    <span class="comment">// 检查当前li元素的第一个子元素（即a标签）的href属性值是否为当前路径</span></span><br><span class="line">    <span class="keyword">if</span>($(<span class="variable language_">this</span>).<span class="title function_">find</span>(<span class="string">&#x27;a&#x27;</span>).<span class="title function_">attr</span>(<span class="string">&#x27;href&#x27;</span>)===<span class="string">&#x27;&#123;&#123; request.path &#125;&#125;&#x27;</span>)&#123;</span><br><span class="line">        <span class="comment">// 如果条件满足，则为当前li元素的第一个子元素（即a标签）添加&#x27;active&#x27;类</span></span><br><span class="line">        $(<span class="variable language_">this</span>).<span class="title function_">find</span>(<span class="string">&#x27;a&#x27;</span>).<span class="title function_">addClass</span>(<span class="string">&#x27;active&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;);</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure><p>优化版：比如用户管理一个菜单，里面有编辑用户、查看用户等，url为/user/xxxx/edit/、/user/xxx/detail/，这样的话上面的方法就不管用了，因为菜单是/user/，匹配不到/user/xxx/edit/，所以修改如下：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line">  <span class="comment">// 选择所有class为&#x27;nav-sidebar&#x27;的ul元素下的li元素</span></span><br><span class="line">  $(<span class="string">&#x27;ul.nav-sidebar li&#x27;</span>).<span class="title function_">each</span>(<span class="keyword">function</span>(<span class="params">i</span>)&#123;</span><br><span class="line">    <span class="comment">// 把patharr切割为列表，如[user,xxxx,eidt]</span></span><br><span class="line">    <span class="keyword">var</span> patharr = <span class="string">&#x27;&#123;&#123; request.path &#125;&#125;&#x27;</span>.<span class="title function_">split</span>(<span class="string">&quot;/&quot;</span>);</span><br><span class="line">    <span class="comment">// 循环列表</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> i = patharr.<span class="property">length</span>; i &gt; <span class="number">0</span>; i--) &#123;</span><br><span class="line">      <span class="comment">// 获取列表的值，并转换为字符串</span></span><br><span class="line">      <span class="comment">// 比如一开始获取的值为 /user/xxx/edit/,如果没有匹配，下次循环为/user/xxx/，最后为/user/，只要有一个能匹配上，就把菜单高亮</span></span><br><span class="line">      <span class="keyword">var</span> newpatharr = patharr.<span class="title function_">slice</span>(<span class="number">0</span>, i);</span><br><span class="line">      <span class="keyword">var</span> path = newpatharr.<span class="title function_">join</span>(<span class="string">&quot;/&quot;</span>)+<span class="string">&#x27;/&#x27;</span>;</span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">log</span>(path)</span><br><span class="line">       <span class="comment">// 检查当前li元素的第一个子元素（即a标签）的href属性值是否为当前路径</span></span><br><span class="line">      <span class="keyword">if</span>($(<span class="variable language_">this</span>).<span class="title function_">find</span>(<span class="string">&#x27;a&#x27;</span>).<span class="title function_">attr</span>(<span class="string">&#x27;href&#x27;</span>)===path)&#123;</span><br><span class="line">        <span class="comment">// 如果条件满足，则为当前li元素的第一个子元素（即a标签）添加&#x27;active&#x27;类</span></span><br><span class="line">        $(<span class="variable language_">this</span>).<span class="title function_">find</span>(<span class="string">&#x27;a&#x27;</span>).<span class="title function_">addClass</span>(<span class="string">&#x27;active&#x27;</span>);</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;);</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure><h2 id="data-widget属性">data-widget属性</h2><p>AdminLTE框架中就使用data-widget属性来激活一些插件，如iframe插件、todo list插件等。</p><p>以下是一个使用data-widget属性的例子：</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;col-lg-6&quot;</span> <span class="attr">id</span>=<span class="string">&quot;calendar_widget&quot;</span> <span class="attr">data-widget</span>=<span class="string">&quot;chat-init&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure><p>在这个例子中，data-widget=&quot;chat-init&quot;表示激活了一个名为&quot;chat-init&quot;的插件。</p><p>需要注意的是，data-widget属性并不是Bootstrap的标准属性，而是一些第三方框架（如AdminLTE）扩展出来的属性。因此，如果你在使用这些框架时遇到data-widget属性，可以参考相应的文档来了解其具体用法。</p><h2 id="ajax提交数据">ajax提交数据</h2><p>html代码如下</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">id</span>=<span class="string">&quot;editUserForm&quot;</span> <span class="attr">novalidate</span>=<span class="string">&quot;novalidate&quot;</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;card-body&quot;</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;form-group&quot;</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">label</span> <span class="attr">for</span>=<span class="string">&quot;username&quot;</span>&gt;</span>用户名<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">name</span>=<span class="string">&quot;username&quot;</span> <span class="attr">class</span>=<span class="string">&quot;form-control&quot;</span> <span class="attr">id</span>=<span class="string">&quot;username&quot;</span> <span class="attr">value</span>=<span class="string">&quot;&#123;&#123; username &#125;&#125;&quot;</span> <span class="attr">readonly</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;form-group&quot;</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">label</span> <span class="attr">for</span>=<span class="string">&quot;Email&quot;</span>&gt;</span>邮箱地址<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;email&quot;</span> <span class="attr">name</span>=<span class="string">&quot;email&quot;</span> <span class="attr">class</span>=<span class="string">&quot;form-control&quot;</span> <span class="attr">id</span>=<span class="string">&quot;Email&quot;</span> <span class="attr">value</span>=<span class="string">&quot;&#123;&#123; email &#125;&#125;&quot;</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;form-group&quot;</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">label</span> <span class="attr">for</span>=<span class="string">&quot;phone&quot;</span>&gt;</span>手机号码<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">name</span>=<span class="string">&quot;phone&quot;</span> <span class="attr">class</span>=<span class="string">&quot;form-control&quot;</span> <span class="attr">id</span>=<span class="string">&quot;phone&quot;</span> <span class="attr">value</span>=<span class="string">&quot;&#123;&#123; phone &#125;&#125;&quot;</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">              <span class="comment">&lt;!-- /.card-body --&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;card-footer&quot;</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">button</span> <span class="attr">type</span>=<span class="string">&quot;submit&quot;</span> <span class="attr">class</span>=<span class="string">&quot;btn btn-primary&quot;</span>&gt;</span>修改&amp;保存<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;&#123;% url &#x27;manager:userlist&#x27; %&#125;&quot;</span> <span class="attr">class</span>=<span class="string">&quot;btn btn-success float-right&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">i</span>&gt;</span> 返回列表<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br></pre></td></tr></table></figure><p>ajax代码：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">$(<span class="string">&quot;#editUserForm button[type=&#x27;submit&#x27;]&quot;</span>).<span class="title function_">click</span>(<span class="keyword">function</span>(<span class="params">e</span>)&#123;</span><br><span class="line">    e.<span class="title function_">preventDefault</span>(); <span class="comment">// 阻止表单的默认提交行为</span></span><br><span class="line">    <span class="keyword">var</span> formData = $( <span class="string">&quot;#editUserForm&quot;</span> ).<span class="title function_">serialize</span>();</span><br><span class="line">    $.<span class="title function_">ajax</span>(&#123;</span><br><span class="line">        <span class="attr">url</span>: <span class="string">&quot;&#123;% url &#x27;manager:useredit&#x27; uid %&#125;&quot;</span>, <span class="comment">// 你的请求地址</span></span><br><span class="line">        <span class="attr">type</span>: <span class="string">&quot;POST&quot;</span>, <span class="comment">// 请求类型，必须是POST</span></span><br><span class="line">        <span class="attr">data</span>: formData, <span class="comment">// 你的表单数据</span></span><br><span class="line">        <span class="attr">dataType</span>: <span class="string">&quot;json&quot;</span>, <span class="comment">// 返回的数据类型，必须是json</span></span><br><span class="line">        <span class="attr">success</span>: <span class="keyword">function</span>(<span class="params">data</span>)&#123;</span><br><span class="line">            <span class="keyword">if</span> (data.<span class="property">result</span> === <span class="number">0</span>) &#123;</span><br><span class="line">                <span class="comment">// 请求成功，显示消息</span></span><br><span class="line">                toastr.<span class="title function_">success</span>(data.<span class="property">message</span>)</span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span> (data.<span class="property">result</span> === <span class="number">1</span>) &#123;</span><br><span class="line">                toastr.<span class="title function_">success</span>(data.<span class="property">message</span>)</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">error</span>: <span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">            <span class="comment">// 请求失败的回调函数</span></span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;Error&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>python代码</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">post</span>(<span class="params">self,request,uid</span>):</span><br><span class="line">    op_user = request.user</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> op_user.is_superuser <span class="keyword">or</span> op_user.uid != uid: <span class="comment"># 如果不是管理员或者修改的不是自己的用户信息</span></span><br><span class="line">        resultdict = &#123;<span class="string">&#x27;result&#x27;</span>:<span class="number">1</span>,<span class="string">&#x27;message&#x27;</span>:<span class="string">&#x27;无权限修改其他用户的信息&#x27;</span>&#125;</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        user = UserDB.objects.<span class="built_in">filter</span>(uid=uid).first()</span><br><span class="line">        user.email = request.POST.get(<span class="string">&#x27;email&#x27;</span>,<span class="string">&#x27;&#x27;</span>)</span><br><span class="line">        user.phone = request.POST.get(<span class="string">&#x27;phone&#x27;</span>,<span class="string">&#x27;&#x27;</span>)</span><br><span class="line">        user.save()</span><br><span class="line">        resultdict = &#123;<span class="string">&#x27;result&#x27;</span>:<span class="number">0</span>,<span class="string">&#x27;message&#x27;</span>:<span class="string">&#x27;修改成功&#x27;</span>&#125;</span><br><span class="line">    <span class="keyword">except</span> Exception <span class="keyword">as</span> err :</span><br><span class="line">        resultdict = &#123;<span class="string">&#x27;result&#x27;</span>:<span class="number">1</span>,<span class="string">&#x27;message&#x27;</span>:<span class="string">&#x27;修改用户信息失败%s&#x27;</span> % err&#125;</span><br><span class="line">    <span class="keyword">finally</span>:</span><br><span class="line">        <span class="keyword">return</span> JsonResponse(resultdict)</span><br></pre></td></tr></table></figure><h2 id="吐司">吐司</h2><p>引入文件</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- toastr需要导入的css文件 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">&quot;stylesheet&quot;</span> <span class="attr">href</span>=<span class="string">&quot;&#123;% static &#x27;adminlte/plugins/toastr/toastr.min.css&#x27; %&#125;&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">&quot;stylesheet&quot;</span> <span class="attr">href</span>=<span class="string">&quot;&#123;% static &#x27;adminlte/plugins/sweetalert2/sweetalert2.min.css&#x27; %&#125;&quot;</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- 吐司需要导入的js --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;&#123;% static &#x27;adminlte/plugins/toastr/toastr.min.js&#x27; %&#125;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;&#123;% static &#x27;adminlte/plugins/sweetalert2/sweetalert2.min.js&#x27; %&#125;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure><p>初始化</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> <span class="title class_">Toast</span> = <span class="title class_">Swal</span>.<span class="title function_">mixin</span>(&#123;</span><br><span class="line">            <span class="attr">toast</span>: <span class="literal">true</span>,</span><br><span class="line">            <span class="attr">position</span>: <span class="string">&#x27;top-end&#x27;</span>,</span><br><span class="line">            <span class="attr">showConfirmButton</span>: <span class="literal">false</span>,</span><br><span class="line">            <span class="attr">timer</span>: <span class="number">3000</span> # 多少秒后消失</span><br><span class="line">        &#125;);</span><br></pre></td></tr></table></figure><h2 id="返回上一个url">返回上一个url</h2><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;javascript:history.go(-1);&quot;</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="在datatable头添加一个按钮，和search平行">在datatable头添加一个按钮，和search平行</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line">  $(<span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">    $(<span class="string">&quot;#usertable&quot;</span>).<span class="title class_">DataTable</span>(&#123;</span><br><span class="line">      <span class="string">&quot;responsive&quot;</span>: <span class="literal">true</span>, <span class="string">&quot;lengthChange&quot;</span>: <span class="literal">false</span>, <span class="string">&quot;autoWidth&quot;</span>: <span class="literal">false</span>,</span><br><span class="line">      <span class="string">&quot;buttons&quot;</span>: [<span class="string">&quot;copy&quot;</span>, <span class="string">&quot;csv&quot;</span>, <span class="string">&quot;excel&quot;</span>, <span class="string">&quot;pdf&quot;</span>, <span class="string">&quot;print&quot;</span>, <span class="string">&quot;colvis&quot;</span>],</span><br><span class="line">      <span class="string">&quot;sDom&quot;</span>: <span class="string">&quot;&lt;&#x27;row&#x27;&lt;&#x27;col-md-6&#x27;&lt;&#x27;#toolbar&#x27;&gt;&gt;&lt;&#x27;col-md-6&#x27;f&gt;&gt;&quot;</span>,<span class="comment">//这里新增</span></span><br><span class="line">    &#125;).<span class="title function_">buttons</span>().<span class="title function_">container</span>().<span class="title function_">appendTo</span>(<span class="string">&#x27;#example1_wrapper .col-md-6:eq(0)&#x27;</span>);</span><br><span class="line">    $(<span class="string">&quot;#toolbar&quot;</span>).<span class="title function_">append</span>(<span class="string">&#x27;&lt;a href=&quot;&#123;% url &quot;manager:usercreate&quot; %&#125;&quot;&gt;&lt;button type=&quot;button&quot; class=&quot;btn btn-primary&quot;&gt;&lt;i class=&quot;fa fa-plus-square&quot;&gt;&lt;/i&gt;&amp;nbsp&amp;nbsp新建主机&lt;/button&gt;&lt;/a&gt;&#x27;</span>) <span class="comment">//这里新增</span></span><br><span class="line">  &#125;);</span><br><span class="line">  <span class="comment">// document.querySelector(&#x27;div.toolbar&#x27;).innerHTML = &#x27;&lt;b&gt;Custom tool bar! Text/images etc.&lt;/b&gt;&#x27;;</span></span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure><h2 id="post后url显示参数，如何修改？">post后url显示参数，如何修改？</h2><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 在form标签增加以下字段 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">onsubmit</span>=<span class="string">&quot;return false&quot;</span> &gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="提交数据后，通过request-POST获取不到">提交数据后，通过request.POST获取不到</h2><p>前端post后，django是通过标签中的name='xxx’获取到数据的，比如<input name='username'>，后端通过reqeust.POST.get(‘username’)获取数据所以template一定要设置name属性</p><h2 id="自定义模态框的内容">自定义模态框的内容</h2><p>模态框html，id为mymodal</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 模态框 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;modal fade&quot;</span> <span class="attr">id</span>=<span class="string">&quot;mymodal&quot;</span> <span class="attr">style</span>=<span class="string">&quot;display: none;&quot;</span> <span class="attr">aria-hidden</span>=<span class="string">&quot;true&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;modal-dialog&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;modal-content&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;modal-header&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">h4</span> <span class="attr">class</span>=<span class="string">&quot;modal-title&quot;</span> <span class="attr">id</span>=<span class="string">&quot;mymodaltitle&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">h4</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">button</span> <span class="attr">type</span>=<span class="string">&quot;button&quot;</span> <span class="attr">class</span>=<span class="string">&quot;close&quot;</span> <span class="attr">data-dismiss</span>=<span class="string">&quot;modal&quot;</span> <span class="attr">aria-label</span>=<span class="string">&quot;Close&quot;</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">span</span> <span class="attr">aria-hidden</span>=<span class="string">&quot;true&quot;</span>&gt;</span>×<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;modal-body&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">p</span> <span class="attr">id</span>=<span class="string">&quot;mymodalcontent&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;modal-footer justify-content-between&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">button</span> <span class="attr">type</span>=<span class="string">&quot;button&quot;</span> <span class="attr">class</span>=<span class="string">&quot;btn btn-default&quot;</span> <span class="attr">data-dismiss</span>=<span class="string">&quot;modal&quot;</span>&gt;</span>取消<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">a</span> <span class="attr">id</span>=<span class="string">&quot;mymodelhref&quot;</span> <span class="attr">style</span>=<span class="string">&quot;color: white;&quot;</span> <span class="attr">role</span>=<span class="string">&quot;button&quot;</span> <span class="attr">class</span>=<span class="string">&quot;btn btn-primary&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- /.modal-content --&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!-- /.modal-dialog --&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- 模态框结束 --&gt;</span></span><br></pre></td></tr></table></figure><p>js代码</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 这里用的是模态框的id</span></span><br><span class="line">  $(<span class="string">&#x27;#mymodal&#x27;</span>).<span class="title function_">on</span>(<span class="string">&#x27;show.bs.modal&#x27;</span>, <span class="keyword">function</span> (<span class="params">event</span>) &#123;</span><br><span class="line">    <span class="keyword">var</span> button = $(event.<span class="property">relatedTarget</span>) <span class="comment">// Button that triggered the modal</span></span><br><span class="line">    <span class="comment">//注意这里的whatever对应前面html代码中button标签下data-whatever属性的后半段，这里只要定义了data-xxx，就可以通过js获取</span></span><br><span class="line">    <span class="comment">// var recipient = button.data(&#x27;whatever&#x27;) // Extract info from data-* attributes</span></span><br><span class="line">    <span class="comment">// If necessary, you could initiate an AJAX request here (and then do the updating in a callback).</span></span><br><span class="line">    <span class="comment">// Update the modal&#x27;s content. We&#x27;ll use jQuery here, but you could use a data binding library or other methods instead.</span></span><br><span class="line">    <span class="keyword">var</span> modal = $(<span class="variable language_">this</span>)</span><br><span class="line">    <span class="comment">//此处即为修改modal的标题，都是通过class获取</span></span><br><span class="line">    modal.<span class="title function_">find</span>(<span class="string">&#x27;.modal-title&#x27;</span>).<span class="title function_">text</span>(<span class="string">&#x27;退出登录&#x27;</span>)</span><br><span class="line">    modal.<span class="title function_">find</span>(<span class="string">&#x27;.modal-body p&#x27;</span>).<span class="title function_">text</span>(<span class="string">&quot;是否确认退出登录？&quot;</span>)</span><br><span class="line">    modal.<span class="title function_">find</span>(<span class="string">&#x27;.modal-footer a&#x27;</span>).<span class="title function_">text</span>(<span class="string">&quot;确认退出&quot;</span>)</span><br><span class="line">    modal.<span class="title function_">find</span>(<span class="string">&#x27;.modal-footer a&#x27;</span>).<span class="title function_">attr</span>(<span class="string">&quot;href&quot;</span>,<span class="string">&quot;&#123;% url &#x27;manager:logout&#x27; %&#125;&quot;</span>)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><p>按钮的html只要设置了<code>data-toggle=&quot;modal&quot; data-target=&quot;#mymodal&quot;</code>就行，其中<code>data-target</code>是要弹出的模态框</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">class</span>=<span class="string">&quot;nav-link&quot;</span>  <span class="attr">href</span>=<span class="string">&quot;/logout/&quot;</span> <span class="attr">role</span>=<span class="string">&quot;button&quot;</span> <span class="attr">id</span>=<span class="string">&quot;logoutbtn&quot;</span> <span class="attr">data-toggle</span>=<span class="string">&quot;modal&quot;</span> <span class="attr">data-target</span>=<span class="string">&quot;#mymodal&quot;</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="jQuery表单校验">jQuery表单校验</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br></pre></td><td class="code"><pre><span class="line">&lt;script src=<span class="string">&quot;&#123;% static &#x27;adminlte/plugins/jquery-validation/jquery.validate.min.js&#x27; %&#125;&quot;</span>&gt;&lt;/script&gt;</span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;&#123;% static &#x27;adminlte/plugins/jquery-validation/additional-methods.min.js&#x27; %&#125;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"><span class="comment">// ajax提交的时候要验证一下</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">$(<span class="string">&quot;#createUserForm button[type=&#x27;submit&#x27;]&quot;</span>).<span class="title function_">click</span>(<span class="keyword">function</span>(<span class="params">e</span>)&#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">            e.<span class="title function_">preventDefault</span>(); <span class="comment">// 阻止表单的默认提交行为</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">            <span class="keyword">if</span> (!$(<span class="string">&quot;#createUserForm&quot;</span>).<span class="title function_">valid</span>()) &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">                <span class="comment">// 如果验证失败，返回false，不提交数据</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">                <span class="keyword">return</span> <span class="literal">false</span>;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">            &#125;;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">            <span class="keyword">var</span> formData = $( <span class="string">&quot;#createUserForm&quot;</span> ).<span class="title function_">serialize</span>();</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">            $.<span class="title function_">ajax</span>(&#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">                <span class="attr">url</span>: <span class="string">&quot;&#123;% url &#x27;manager:usercreate&#x27; %&#125;&quot;</span>, <span class="comment">// 你的请求地址</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">                <span class="attr">type</span>: <span class="string">&quot;POST&quot;</span>, <span class="comment">// 请求类型，必须是POST</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">                <span class="attr">data</span>: formData, <span class="comment">// 你的表单数据</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">                <span class="attr">dataType</span>: <span class="string">&quot;json&quot;</span>, <span class="comment">// 返回的数据类型，必须是json</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">                <span class="attr">success</span>: <span class="keyword">function</span>(<span class="params">data</span>)&#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">                    <span class="keyword">if</span> (data.<span class="property">result</span> === <span class="number">0</span>) &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">                        <span class="comment">// 请求成功，显示消息</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">                        toastr.<span class="title function_">success</span>(data.<span class="property">message</span>)</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">                        <span class="comment">// window.location.href = &quot;&#123;% url &#x27;manager:userlist&#x27; %&#125;&quot;;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">                        <span class="built_in">setTimeout</span>(<span class="keyword">function</span>(<span class="params"></span>) &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">                          <span class="variable language_">window</span>.<span class="property">location</span>.<span class="property">href</span> = <span class="string">&quot;&#123;% url &#x27;manager:userlist&#x27; %&#125;&quot;</span>;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">                        &#125;, <span class="number">1000</span>);</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">                    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (data.<span class="property">result</span> === <span class="number">1</span>) &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">                        toastr.<span class="title function_">error</span>(data.<span class="property">message</span>)</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">                    &#125;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">                &#125;,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">                <span class="attr">error</span>: <span class="keyword">function</span>(<span class="params"></span>)&#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">                    <span class="comment">// 请求失败的回调函数</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">                    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;Error&quot;</span>);</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">                &#125;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">            &#125;);</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        &#125;);</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"><span class="comment">// 验证规则</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">$.validator.<span class="title function_">addMethod</span>(<span class="string">&quot;letterswithnumber&quot;</span>, <span class="keyword">function</span>(<span class="params">value,element</span>) &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="title function_">optional</span>(element) || <span class="regexp">/^(?=.*[a-z])(?=.*[0-9]).*$/i</span>.<span class="title function_">test</span>(value);</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    &#125;, <span class="string">&quot;密码中必须包含字母、数字和特殊字符&quot;</span>);</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    $.validator.<span class="title function_">addMethod</span>(<span class="string">&quot;specialchar&quot;</span>, <span class="keyword">function</span>(<span class="params">value,element</span>) &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="title function_">optional</span>(element) || <span class="regexp">/^(?=.*[!@#\$%\^&amp;\*\(\)\-_=+&#123;&#125;:\,\&lt;\&gt;\?]).*$/i</span>.<span class="title function_">test</span>(value);</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    &#125;, <span class="string">&quot;密码中必须包含字母、数字和特殊字符&quot;</span>);</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    $(<span class="string">&#x27;#createUserForm&#x27;</span>).<span class="title function_">validate</span>(&#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">          <span class="attr">rules</span>: &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">            <span class="attr">email</span>: &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">              <span class="attr">required</span>: <span class="literal">false</span>,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">              <span class="attr">email</span>: <span class="literal">true</span>,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">            &#125;,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">            <span class="attr">password</span>: &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">              <span class="attr">required</span>: <span class="literal">true</span>,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">              <span class="attr">letterswithnumber</span>: <span class="literal">true</span>,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">              <span class="attr">specialchar</span>: <span class="literal">true</span>,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">              <span class="attr">minlength</span>: <span class="number">8</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">            &#125;,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">            <span class="attr">confirmpassword</span>: &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">              <span class="attr">required</span>: <span class="literal">true</span>,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">              <span class="attr">equalTo</span>: <span class="string">&quot;#password&quot;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">            &#125;,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">            <span class="attr">username</span>: &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">              <span class="attr">required</span>: <span class="literal">true</span>,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">              <span class="attr">pattern</span>: <span class="regexp">/^[a-zA-Z0-9]+$/</span>,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">              <span class="attr">minlength</span>: <span class="number">5</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">            &#125;,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">          &#125;,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">          <span class="attr">messages</span>: &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">            <span class="attr">email</span>: &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">              <span class="attr">email</span>: <span class="string">&quot;请输入正确的邮箱&quot;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">            &#125;,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">            <span class="attr">password</span>: &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">              <span class="attr">required</span>: <span class="string">&quot;请提供密码&quot;</span>,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">              <span class="attr">etterswithnumber</span>: <span class="string">&quot;密码中必须包含字母和数字&quot;</span>,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">              <span class="attr">specialchar</span>: <span class="string">&quot;密码中必须包含特殊字符&quot;</span>,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">              <span class="attr">minlength</span>: <span class="string">&quot;密码至少 8 个字符，至少包含三种符号&quot;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">            &#125;,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">            <span class="attr">username</span>: &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">              <span class="attr">required</span>: <span class="string">&quot;请输入用户名&quot;</span>,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">              <span class="attr">minlength</span>: <span class="string">&quot;用户名至少 5 个字符，仅允许字母和数字&quot;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">            &#125;,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">            <span class="attr">confirmpassword</span>: &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">              <span class="attr">required</span>: <span class="string">&quot;请提供确认密码&quot;</span>,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">              <span class="attr">equalTo</span>: <span class="string">&quot;确认密码与密码不一致&quot;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">            &#125;,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">          &#125;,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">          <span class="attr">errorElement</span>: <span class="string">&#x27;span&#x27;</span>,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">          <span class="attr">errorPlacement</span>: <span class="keyword">function</span> (<span class="params">error, element</span>) &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">            error.<span class="title function_">addClass</span>(<span class="string">&#x27;invalid-feedback&#x27;</span>);</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">            element.<span class="title function_">closest</span>(<span class="string">&#x27;.form-group&#x27;</span>).<span class="title function_">append</span>(error);</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">          &#125;,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">          <span class="attr">highlight</span>: <span class="keyword">function</span> (<span class="params">element, errorClass, validClass</span>) &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">            $(element).<span class="title function_">addClass</span>(<span class="string">&#x27;is-invalid&#x27;</span>);</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">          &#125;,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">          <span class="attr">unhighlight</span>: <span class="keyword">function</span> (<span class="params">element, errorClass, validClass</span>) &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">            $(element).<span class="title function_">removeClass</span>(<span class="string">&#x27;is-invalid&#x27;</span>);</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">          &#125;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        &#125;);</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br></pre></td></tr></table></figure><h2 id="使用datatable">使用datatable</h2><p>html代码</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">table</span> <span class="attr">id</span>=<span class="string">&quot;usertable&quot;</span> <span class="attr">class</span>=<span class="string">&quot;table table-bordered table-striped&quot;</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">thead</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">                      <span class="tag">&lt;<span class="name">th</span>&gt;</span>用户名<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">                      <span class="tag">&lt;<span class="name">th</span>&gt;</span>创建时间<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">                      <span class="tag">&lt;<span class="name">th</span>&gt;</span>邮箱<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">                      <span class="tag">&lt;<span class="name">th</span>&gt;</span>手机号码<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">                      <span class="tag">&lt;<span class="name">th</span>&gt;</span>操作<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;/<span class="name">thead</span>&gt;</span></span><br><span class="line">                    </span><br><span class="line">                  <span class="tag">&lt;/<span class="name">table</span>&gt;</span></span><br></pre></td></tr></table></figure><p>js代码</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line">$(<span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">    $(<span class="string">&#x27;#usertable&#x27;</span>).<span class="title class_">DataTable</span>(&#123;</span><br><span class="line">                <span class="string">&quot;ajax&quot;</span>: <span class="string">&quot;&#123;% url &#x27;manager:userlist&#x27; %&#125;&quot;</span>,</span><br><span class="line">                <span class="string">&quot;columns&quot;</span>: [</span><br><span class="line">                    &#123;<span class="string">&quot;data&quot;</span>: <span class="string">&quot;username&quot;</span>&#125;,</span><br><span class="line">                    &#123;<span class="string">&quot;data&quot;</span>: <span class="string">&quot;create_time&quot;</span>&#125;,</span><br><span class="line">                    &#123;<span class="string">&quot;data&quot;</span>: <span class="string">&quot;email&quot;</span>&#125;,</span><br><span class="line">                    &#123;<span class="string">&quot;data&quot;</span>: <span class="string">&quot;phone&quot;</span>&#125;,</span><br><span class="line">                    &#123;<span class="string">&quot;data&quot;</span>: <span class="string">&quot;button&quot;</span>&#125;,</span><br><span class="line">                ],</span><br><span class="line">                <span class="attr">language</span>: &#123;<span class="comment">//自定义语言提示</span></span><br><span class="line">                    <span class="string">&quot;processing&quot;</span>: <span class="string">&quot;处理中...&quot;</span>,</span><br><span class="line">                    <span class="string">&quot;lengthMenu&quot;</span>: <span class="string">&quot;显示 _MENU_ 条用户数据&quot;</span>,</span><br><span class="line">                    <span class="string">&quot;zeroRecords&quot;</span>: <span class="string">&quot;没有找到相应的结果&quot;</span>,</span><br><span class="line">                    <span class="string">&quot;info&quot;</span>: <span class="string">&quot;第 _START_ 至 _END_ 行，共 _TOTAL_ 行&quot;</span>,</span><br><span class="line">                    <span class="string">&quot;infoEmpty&quot;</span>: <span class="string">&quot;第 0 至 0 项结果，共 0 项&quot;</span>,</span><br><span class="line">                    <span class="string">&quot;infoFiltered&quot;</span>: <span class="string">&quot;(由 _MAX_ 项结果过滤)&quot;</span>,</span><br><span class="line">                    <span class="string">&quot;infoPostFix&quot;</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">                    <span class="string">&quot;url&quot;</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">                    <span class="string">&quot;thousands&quot;</span>: <span class="string">&quot;&#x27;&quot;</span>,</span><br><span class="line">                    <span class="string">&quot;emptyTable&quot;</span>: <span class="string">&quot;表中数据为空&quot;</span>,</span><br><span class="line">                    <span class="string">&quot;loadingRecords&quot;</span>: <span class="string">&quot;载入中...&quot;</span>,</span><br><span class="line">                    <span class="string">&quot;infoThousands&quot;</span>: <span class="string">&quot;,&quot;</span>,</span><br><span class="line">                    <span class="string">&quot;paginate&quot;</span>: &#123;</span><br><span class="line">                        <span class="string">&quot;first&quot;</span>: <span class="string">&quot;首页&quot;</span>,</span><br><span class="line">                        <span class="string">&quot;previous&quot;</span>: <span class="string">&quot;上页&quot;</span>,</span><br><span class="line">                        <span class="string">&quot;next&quot;</span>: <span class="string">&quot;下页&quot;</span>,</span><br><span class="line">                        <span class="string">&quot;last&quot;</span>: <span class="string">&quot;末页&quot;</span></span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;,</span><br><span class="line">                </span><br><span class="line">                <span class="string">&quot;sDom&quot;</span>: <span class="string">&quot;&lt;&#x27;row&#x27;&lt;&#x27;col-md-6&#x27;&lt;&#x27;#toolbar&#x27;&gt;&gt;&lt;&#x27;col-md-6&#x27;f&gt;&gt;&quot;</span> +  <span class="comment">//设置表格最上面内容，可以在这里添加按钮等其他设置</span></span><br><span class="line">        <span class="string">&quot;t&quot;</span> + <span class="comment">//设置tables</span></span><br><span class="line">        <span class="string">&quot;&lt;&#x27;row&#x27;&lt;&#x27;col-md-5 sm-center&#x27;li&gt;&lt;&#x27;col-md-7 text-right sm-center&#x27;p&gt;&gt;&quot;</span>,<span class="comment">//设置表格最下面显示内容</span></span><br><span class="line">                <span class="attr">buttons</span>: [&#123;</span><br><span class="line">                    <span class="attr">text</span>: <span class="string">&#x27;&lt;i class=&quot;fa fa-download&quot; title=&quot;导出execl&quot;&gt;&lt;/i&gt;&#x27;</span>,</span><br><span class="line">                    <span class="attr">extend</span>: <span class="string">&#x27;excel&#x27;</span>, <span class="comment">// 导出为execl</span></span><br><span class="line">                    <span class="attr">title</span>: <span class="string">&#x27;用户列表&#x27;</span>+<span class="title class_">Date</span>.<span class="title function_">now</span>(), <span class="comment">// 导出文件的名字</span></span><br><span class="line">                    <span class="attr">className</span>: <span class="string">&#x27;btn btn-primary&#x27;</span>, <span class="comment">// 按钮样式</span></span><br><span class="line">                    <span class="attr">exportOptions</span>:&#123;</span><br><span class="line">                        <span class="attr">columns</span>:[<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>], <span class="comment">// 导出哪些列</span></span><br><span class="line">                        <span class="comment">// rows:[1,2,3,4] //导出哪些行</span></span><br><span class="line">                        <span class="attr">modifier</span>: &#123;</span><br><span class="line">                            <span class="attr">page</span>: <span class="string">&#x27;all&#x27;</span>, <span class="comment">// 导出哪些页的数据，all为所有，current为当前页</span></span><br><span class="line">                        &#125;,</span><br><span class="line">                        <span class="title class_">Headers</span>: <span class="literal">true</span>,<span class="comment">// 导出表格表头</span></span><br><span class="line">                        <span class="attr">footer</span>: <span class="literal">true</span>,<span class="comment">// 导出表格表尾</span></span><br><span class="line">                        <span class="attr">extension</span>: <span class="string">&quot;.xlsx&quot;</span>, <span class="comment">// 导出的文件后缀</span></span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;]</span><br><span class="line">          &#125;);</span><br><span class="line">          $(<span class="string">&quot;#toolbar&quot;</span>).<span class="title function_">append</span>(<span class="string">&#x27;&lt;a href=&quot;&#123;% url &quot;manager:usercreate&quot; %&#125;&quot;&gt;&lt;button type=&quot;button&quot; class=&quot;btn btn-primary&quot;&gt;&lt;i class=&quot;fa fa-plus-square&quot;&gt;&lt;/i&gt;&amp;nbsp&amp;nbsp新建用户&lt;/button&gt;&lt;/a&gt;&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  &#125;);</span><br><span class="line">  </span><br></pre></td></tr></table></figure><p>后端代码，返回的格式UserDict[“data”]，data要和js的columns data名称一致</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">UserIndex</span>(<span class="params">request</span>):</span><br><span class="line">    <span class="keyword">return</span> render(request,<span class="string">&#x27;user/index.html&#x27;</span>)</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">UserManager</span>(<span class="title class_ inherited__">View</span>):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">get</span>(<span class="params">self,request</span>):</span><br><span class="line">        <span class="comment"># if not  request.META.get(&#x27;HTTP_X_REQUESTED_WITH&#x27;) == &#x27;XMLHttpRequest&#x27;:</span></span><br><span class="line">        <span class="comment">#     return render(request,&#x27;user/index.html&#x27;)</span></span><br><span class="line">        <span class="comment"># print(&#x27;not ajax request&#x27;)</span></span><br><span class="line">        UserInfo = UserDB.objects.<span class="built_in">all</span>()</span><br><span class="line">        <span class="comment"># print(user)</span></span><br><span class="line">        UserList = []</span><br><span class="line">        <span class="keyword">for</span> User <span class="keyword">in</span> UserInfo:</span><br><span class="line">            username = User.username</span><br><span class="line">            create_time =User.create_time</span><br><span class="line">            email = User.email</span><br><span class="line">            phone = User.phone</span><br><span class="line">            button = <span class="string">&quot;&quot;&quot;&lt;div style=&quot;display: block;text-align: center;margin: auto;&quot;&gt;</span></span><br><span class="line"><span class="string">            &lt;a class=&quot;btn btn-primary btn-sm&quot; href=&quot;&#123;0&#125;&quot;&gt;</span></span><br><span class="line"><span class="string">                                &lt;i class=&quot;fas fa-folder&quot;&gt;</span></span><br><span class="line"><span class="string">                                &lt;/i&gt;</span></span><br><span class="line"><span class="string">                                详情</span></span><br><span class="line"><span class="string">                            &lt;/a&gt;</span></span><br><span class="line"><span class="string">                            &lt;a class=&quot;btn btn-info btn-sm&quot; href=&quot;&#123;1&#125;&quot;&gt;</span></span><br><span class="line"><span class="string">                                &lt;i class=&quot;fas fa-pencil-alt&quot;&gt;</span></span><br><span class="line"><span class="string">                                &lt;/i&gt;</span></span><br><span class="line"><span class="string">                                编辑</span></span><br><span class="line"><span class="string">                            &lt;/a&gt;</span></span><br><span class="line"><span class="string">                            &lt;a class=&quot;btn btn-danger btn-sm&quot; data-url=&quot;&#123;2&#125;&quot; data-user=&#x27;&#123;3&#125;&#x27; data-toggle=&quot;modal&quot; data-target=&quot;#mymodal&quot;&gt;</span></span><br><span class="line"><span class="string">                                &lt;i class=&quot;fas fa-trash&quot;&gt;</span></span><br><span class="line"><span class="string">                                &lt;/i&gt;</span></span><br><span class="line"><span class="string">                                删除</span></span><br><span class="line"><span class="string">                            &lt;/a&gt;</span></span><br><span class="line"><span class="string">            &lt;/div&gt;</span></span><br><span class="line"><span class="string">            &quot;&quot;&quot;</span>.<span class="built_in">format</span>(reverse(<span class="string">&#x27;manager:userdetail&#x27;</span>,kwargs=&#123;<span class="string">&#x27;uid&#x27;</span>:User.uid&#125;),reverse(<span class="string">&#x27;manager:useredit&#x27;</span>,kwargs=&#123;<span class="string">&#x27;uid&#x27;</span>:User.uid&#125;),reverse(<span class="string">&#x27;manager:userdel&#x27;</span>,kwargs=&#123;<span class="string">&#x27;uid&#x27;</span>:User.uid&#125;),User.username)</span><br><span class="line">            UserList.append(&#123;<span class="string">&#x27;username&#x27;</span>: User.username,<span class="string">&#x27;create_time&#x27;</span>:User.create_time.strftime(<span class="string">&#x27;%Y-%m-%d %H:%M:%S&#x27;</span>),<span class="string">&#x27;email&#x27;</span>:User.email,<span class="string">&#x27;phone&#x27;</span>: User.phone,<span class="string">&#x27;uid&#x27;</span>:<span class="built_in">str</span>(User.uid),<span class="string">&#x27;button&#x27;</span>:button&#125;)</span><br><span class="line">            <span class="built_in">print</span>(username)</span><br><span class="line"></span><br><span class="line">        UserDict = &#123;&#125;</span><br><span class="line">        UserDict[<span class="string">&quot;data&quot;</span>] = UserList</span><br><span class="line">  </span><br><span class="line">        <span class="keyword">return</span> HttpResponse(json.dumps(UserDict))</span><br></pre></td></tr></table></figure><p><a href="http://urls.py">urls.py</a></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">path(<span class="string">&#x27;user/&#x27;</span>,views.UserIndex,name=<span class="string">&#x27;userindex&#x27;</span>),</span><br><span class="line">path(<span class="string">&#x27;user/list/&#x27;</span>,views.UserManager.as_view(),name=<span class="string">&#x27;userlist&#x27;</span>),</span><br></pre></td></tr></table></figure><h2 id="刷新datatable的数据">刷新datatable的数据</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$(<span class="string">&#x27;#usertable&#x27;</span>).<span class="title class_">DataTable</span>().<span class="property">ajax</span>.<span class="title function_">reload</span>();</span><br></pre></td></tr></table></figure><h2 id="截断datatable数据">截断datatable数据</h2><p>使用DataTables提供的ellipsis插件，它专门用于文本的截断显示。这个插件可以对过长的文本进行截断，并在结尾添加省略号。使用这个插件非常简单，首先需要在HTML中引入相应的JS文件：</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;https://cdn.datatables.net/plug-ins/1.11.3/dataRender/ellipsis.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure><p>然后在DataTables的配置中使用render.ellipsis方法：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">$(<span class="string">&#x27;#example&#x27;</span>).<span class="title class_">DataTable</span>(&#123;</span><br><span class="line">  <span class="comment">// 其他配置</span></span><br><span class="line">  <span class="string">&quot;columnDefs&quot;</span>: [</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="string">&quot;targets&quot;</span>: [ <span class="number">0</span> ],</span><br><span class="line">      <span class="string">&quot;render&quot;</span>: $.fn.<span class="property">dataTable</span>.<span class="property">render</span>.<span class="title function_">ellipsis</span>( <span class="number">40</span> ) <span class="comment">// 截断长度为40个字符</span></span><br><span class="line">    &#125;</span><br><span class="line">  ]</span><br><span class="line">&#125;);</span><br><span class="line"><span class="string">``</span><span class="string">`js</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">## datatables默认排序</span></span><br><span class="line"><span class="string">`</span><span class="string">``</span>js</span><br><span class="line"><span class="string">&quot;order&quot;</span>: [[ <span class="number">1</span>, <span class="string">&quot;desc&quot;</span> ]]</span><br></pre></td></tr></table></figure><h2 id="bootstrap-switch监听按钮变化事件">bootstrap-switch监听按钮变化事件</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$(<span class="string">&quot;#userstat_value&quot;</span>).<span class="title function_">on</span>(<span class="string">&#x27;switchChange.bootstrapSwitch&#x27;</span>, <span class="keyword">function</span> (<span class="params">event,state</span>) &#123; </span><br><span class="line">      <span class="keyword">var</span> status = <span class="variable language_">this</span>.<span class="property">checked</span> ? <span class="string">&#x27;True&#x27;</span> : <span class="string">&#x27;False&#x27;</span>;</span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;userstat&#x27;</span>+status)</span><br><span class="line">      $(<span class="string">&#x27;input[name=&quot;userstat&quot;]&#x27;</span>).<span class="title function_">val</span>(status);</span><br><span class="line">  &#125;);</span><br></pre></td></tr></table></figure><h2 id="文件上传">文件上传</h2><p>html</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 不在form表单中 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;card-body&quot;</span> <span class="attr">style</span>=<span class="string">&quot;display: block;&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;form-group&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">label</span> <span class="attr">for</span>=<span class="string">&quot;logoimg&quot;</span>&gt;</span>站点图标(33x33)<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;file-loading&quot;</span>&gt;</span> </span><br><span class="line">        <span class="tag">&lt;<span class="name">input</span> <span class="attr">id</span>=<span class="string">&quot;logoimg&quot;</span> <span class="attr">name</span>=<span class="string">&quot;logoimg&quot;</span> <span class="attr">type</span>=<span class="string">&quot;file&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure><p>js文件</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line">&lt;script src=<span class="string">&quot;&#123;% static &#x27;adminlte/plugins/bs-custom-file-input/bs-custom-file-input.js&#x27; %&#125;&quot;</span>&gt;&lt;/script&gt;</span><br><span class="line">&lt;!-- bootstrap <span class="number">5.</span>x or <span class="number">4.</span>x is supported. <span class="title class_">You</span> can also use the bootstrap css <span class="number">3.3</span>.<span class="property">x</span> versions --&gt;</span><br><span class="line">&lt;!-- &lt;link rel=&quot;stylesheet&quot; href=&quot;https://cdn.jsdelivr.net/npm/bootstrap@5.2.0/dist/css/bootstrap.min.css&quot; crossorigin=&quot;anonymous&quot;&gt; --&gt;</span><br><span class="line"></span><br><span class="line">&lt;!-- default icons used in the plugin are from Bootstrap 5.x icon library (which can be enabled by loading CSS below) --&gt;</span><br><span class="line">&lt;!-- &lt;link rel=&quot;stylesheet&quot; href=&quot;https://cdn.jsdelivr.net/npm/bootstrap-icons@1.5.0/font/bootstrap-icons.min.css&quot; crossorigin=&quot;anonymous&quot;&gt; --&gt;</span><br><span class="line"></span><br><span class="line">&lt;!-- alternatively you can use the font awesome icon library if using with `fas` theme (or Bootstrap 4.x) by uncommenting below. --&gt;</span><br><span class="line">&lt;!-- link rel=&quot;stylesheet&quot; href=&quot;https://use.fontawesome.com/releases/v5.15.4/css/all.css&quot; crossorigin=&quot;anonymous&quot; --&gt;</span><br><span class="line"></span><br><span class="line">&lt;!-- the fileinput plugin styling CSS file --&gt;</span><br><span class="line">&lt;link href=&quot;https://cdn.jsdelivr.net/gh/kartik-v/bootstrap-fileinput@5.5.2/css/fileinput.min.css&quot; media=&quot;all&quot; rel=&quot;stylesheet&quot; type=&quot;text/css&quot; /&gt;</span><br><span class="line"></span><br><span class="line">&lt;!-- if using RTL (Right-To-Left) orientation, load the RTL CSS file after fileinput.css by uncommenting below --&gt;</span><br><span class="line">&lt;!-- link href=&quot;https://cdn.jsdelivr.net/gh/kartik-v/bootstrap-fileinput@5.5.2/css/fileinput-rtl.min.css&quot; media=&quot;all&quot; rel=&quot;stylesheet&quot; type=&quot;text/css&quot; /--&gt;</span><br><span class="line"></span><br><span class="line">&lt;!-- the jQuery Library --&gt;</span><br><span class="line">&lt;!-- &lt;script src=&quot;https://code.jquery.com/jquery-3.6.0.min.js&quot; crossorigin=&quot;anonymous&quot;&gt;&lt;/script&gt; --&gt;</span><br><span class="line"></span><br><span class="line">&lt;!-- buffer.min.js and filetype.min.js are necessary in the order listed for advanced mime type parsing and more correct</span><br><span class="line">     preview. This is a feature available since v5.5.0 and is needed if you want to ensure file mime type is parsed </span><br><span class="line">     correctly even if the local file&#x27;s extension is named incorrectly. This will ensure more correct preview of the</span><br><span class="line">     selected file (note: this will involve a small processing overhead in scanning of file contents locally). If you </span><br><span class="line">     do not load these scripts then the mime type parsing will largely be derived using the extension in the filename</span><br><span class="line">     and some basic file content parsing signatures. --&gt;</span><br><span class="line">&lt;script src=&quot;https://cdn.jsdelivr.net/gh/kartik-v/bootstrap-fileinput@5.5.2/js/plugins/buffer.min.js&quot; type=&quot;text/javascript&quot;&gt;&lt;/script&gt;</span><br><span class="line">&lt;script src=&quot;https://cdn.jsdelivr.net/gh/kartik-v/bootstrap-fileinput@5.5.2/js/plugins/filetype.min.js&quot; type=&quot;text/javascript&quot;&gt;&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;!-- piexif.min.js is needed for auto orienting image files OR when restoring exif data in resized images and when you</span><br><span class="line">    wish to resize images before upload. This must be loaded before fileinput.min.js --&gt;</span><br><span class="line">&lt;script src=&quot;https://cdn.jsdelivr.net/gh/kartik-v/bootstrap-fileinput@5.5.2/js/plugins/piexif.min.js&quot; type=&quot;text/javascript&quot;&gt;&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;!-- sortable.min.js is only needed if you wish to sort / rearrange files in initial preview. </span><br><span class="line">    This must be loaded before fileinput.min.js --&gt;</span><br><span class="line">&lt;script src=&quot;https://cdn.jsdelivr.net/gh/kartik-v/bootstrap-fileinput@5.5.2/js/plugins/sortable.min.js&quot; type=&quot;text/javascript&quot;&gt;&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;!-- bootstrap.bundle.min.js below is needed if you wish to zoom and preview file content in a detail modal</span><br><span class="line">    dialog. bootstrap 5.x or 4.x is supported. You can also use the bootstrap js 3.3.x versions. --&gt;</span><br><span class="line">&lt;!-- &lt;script src=&quot;https://cdn.jsdelivr.net/npm/bootstrap@5.2.0/dist/js/bootstrap.bundle.min.js&quot; crossorigin=&quot;anonymous&quot;&gt;&lt;/script&gt; --&gt;</span><br><span class="line"></span><br><span class="line">&lt;!-- the main fileinput plugin script JS file --&gt;</span><br><span class="line">&lt;script src=&quot;https://cdn.jsdelivr.net/gh/kartik-v/bootstrap-fileinput@5.5.2/js/fileinput.min.js&quot;&gt;&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;!-- following theme script is needed to use the Font Awesome 5.x theme (`fas`). Uncomment if needed. --&gt;</span><br><span class="line">&lt;!-- script src=&quot;https://cdn.jsdelivr.net/gh/kartik-v/bootstrap-fileinput@5.5.2/themes/fas/theme.min.js&quot;&gt;&lt;/script --&gt;</span><br><span class="line"></span><br><span class="line">&lt;!-- optionally if you need translation for your language then include the locale file as mentioned below (replace LANG.js with your language locale) --&gt;</span><br><span class="line">&lt;script src=&quot;https://cdn.jsdelivr.net/gh/kartik-v/bootstrap-fileinput@5.5.2/js/locales/LANG.js&quot;&gt;&lt;/script&gt;</span><br><span class="line">&lt;script&gt;</span><br><span class="line">  $(&quot;#logoimg&quot;).fileinput(&#123;</span><br><span class="line">        showUpload: true,  //显示上传按钮</span><br><span class="line">        dropZoneEnabled: false,</span><br><span class="line">        maxFileCount: 1, //最大选择的文件数</span><br><span class="line">        inputGroupClass: &quot;input-group-lg&quot;,</span><br><span class="line">        allowedFileExtensions: [&quot;png&quot;], // 允许的文件扩展名</span><br><span class="line">        language: &#x27;zh&#x27;,</span><br><span class="line">        uploadUrl: &quot;&#123;% url &#x27;manager:system&#x27; %&#125;&quot;, // 上传的URL</span><br><span class="line">        </span><br><span class="line">    &#125;).on(&quot;fileuploaded&quot;, function (e,data,previewId,index) &#123;</span><br><span class="line">                // 上传成功后触发的事件</span><br><span class="line">                toastr.success(&#x27;修改站点图标成功,当前界面可能有缓存,如未更新,请强制刷新一次&#x27;)</span><br><span class="line">                setTimeout(function() &#123;</span><br><span class="line">                    location.reload();</span><br><span class="line">                &#125;, 3000);</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="ace编辑器">ace编辑器</h3><p>引入</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 地址 --&gt;</span></span><br><span class="line">https://cdnjs.cloudflare.com/ajax/libs/ace/1.32.3/ace.min.js</span><br></pre></td></tr></table></figure><p>使用</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"> <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;form-group&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">label</span> <span class="attr">for</span>=<span class="string">&quot;password&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">style</span>=<span class="string">&quot;color: red;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">a</span>&gt;</span>IP地址（选择黑/白名单时需配置，每行一个IP或网段，如1.1.1.1 或者 1.1.1.0/24）<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;col-md-12&quot;</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">textarea</span> <span class="attr">class</span>=<span class="string">&quot;form-control&quot;</span> <span class="attr">id</span>=<span class="string">&quot;form_content&quot;</span> <span class="attr">name</span>=<span class="string">&quot;content&quot;</span> <span class="attr">rows</span>=<span class="string">&quot;5&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">textarea</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">pre</span> <span class="attr">id</span>=<span class="string">&quot;content&quot;</span> <span class="attr">style</span>=<span class="string">&quot;height:415px&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">pre</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;&#123;% static &#x27;ace/ace.min.js&#x27; %&#125;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ACE配置</span></span><br><span class="line">     <span class="keyword">var</span> editor = ace.<span class="title function_">edit</span>(<span class="string">&quot;content&quot;</span>);</span><br><span class="line">     <span class="keyword">var</span> textarea = $(<span class="string">&#x27;textarea[name=&quot;content&quot;]&#x27;</span>).<span class="title function_">hide</span>();</span><br><span class="line">     editor.<span class="title function_">getSession</span>().<span class="title function_">on</span>(<span class="string">&#x27;change&#x27;</span>, <span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">       textarea.<span class="title function_">val</span>(editor.<span class="title function_">getSession</span>().<span class="title function_">getValue</span>());</span><br><span class="line">     &#125;);</span><br><span class="line">     editor.<span class="title function_">setShowPrintMargin</span>(<span class="literal">false</span>);</span><br><span class="line">     <span class="comment">// 字体大小</span></span><br><span class="line">     editor.<span class="title function_">setFontSize</span>(<span class="number">18</span>);</span><br><span class="line">     editor.<span class="title function_">resize</span>()</span><br></pre></td></tr></table></figure><h2 id="js换行">js换行</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> multiLineString = <span class="string">`这是第一行</span></span><br><span class="line"><span class="string">这是第二行`</span>;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> django </category>
          
      </categories>
      
      
        <tags>
            
            <tag> django </tag>
            
            <tag> adminlte </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>测试图片</title>
      <link href="/posts/undefined/"/>
      <url>/posts/undefined/</url>
      
        <content type="html"><![CDATA[]]></content>
      
      
      <categories>
          
          <category> 博客测试 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>Hello World</title>
      <link href="/posts/undefined/"/>
      <url>/posts/undefined/</url>
      
        <content type="html"><![CDATA[<p>Welcome to <a href="https://hexo.io/">Hexo</a>! This is your very first post. Check <a href="https://hexo.io/docs/">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="https://hexo.io/docs/troubleshooting.html">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues">GitHub</a>.</p><h2 id="Quick-Start">Quick Start</h2><h3 id="Create-a-new-post">Create a new post</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo new <span class="string">&quot;My New Post&quot;</span></span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/writing.html">Writing</a></p><h3 id="Run-server">Run server</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo server</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/server.html">Server</a></p><h3 id="Generate-static-files">Generate static files</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo generate</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/generating.html">Generating</a></p><h3 id="Deploy-to-remote-sites">Deploy to remote sites</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo deploy</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/one-command-deployment.html">Deployment</a></p>]]></content>
      
      
      <categories>
          
          <category> 博客测试 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>Github Page + Hexo 搭建个人博客问题小记</title>
      <link href="/posts/undefined/"/>
      <url>/posts/undefined/</url>
      
        <content type="html"><![CDATA[<blockquote><p>在使用Github Page + Hexo搭建个人博客的时候遇到了一些问题，现记录如下，主题使用的是cactus</p></blockquote><h1>问题1 hexo-deployer-git 提示输入用户名/密码</h1><p>在<code>deploy</code>中配置了<code>token</code>后，使用<code>hexo g -d</code>部署到<code>Github</code>，提示输入用户名密码，但是现在<code>Github</code>已经不支持命令行使用用户名密码登录了，所以需要改为<code>SSH</code>的方式，将<code>deploy</code>的<code>token</code>去掉，<code>repo</code>配置为<code>git@github.com/用户名/仓库名</code>在Github仓库下，选择<code>Settings &gt; Deploy keys &gt;添加一个Deploy key</code>，将系统的<code>~/.ssh/xxxx.pub</code>文件的内容布置上去，然后在GitHub界面勾选<code>Allow write access</code>即可。</p><h1>问题2 部署hexo后用自定义域名访问显示404，使用用户名.github.io访问正常</h1><p>方法1 这是因为部署hexo后，原来的CNAME文件被清除了，需要重新设置一下自定义域名。然后在hexo的<code>public</code>文件夹下，新建一个CNAME文件，内容为自定义的域名。如果不写这个文件的话，后面使用<code>hexo g -d</code>，有得重新设置一下自定义域名了。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cat</span> public/CNAME</span><br><span class="line">www.51yunwei.top</span><br></pre></td></tr></table></figure><p>方法2 一劳永逸的方法，在_config.yml中设置url和插件</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># URL</span></span><br><span class="line"><span class="comment">## Set your site url here. For example, if you use GitHub Page, set url as &#x27;https://username.github.io/project&#x27;</span></span><br><span class="line"><span class="attr">url:</span> <span class="string">https://www.51yunwei.top</span></span><br><span class="line"><span class="attr">Plugins:</span></span><br><span class="line"><span class="bullet">-</span> <span class="string">hexo-generator-cname</span></span><br></pre></td></tr></table></figure><p>安装插件</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install hexo-generator-cname</span><br></pre></td></tr></table></figure><h1>问题3 修改cactus主题样式不生效</h1><p>按照官方文档修改了<code>_config.yml</code>文件中的<code>colorscheme</code>参数不生效，需要重新执行以下命令，执行完之后自定义域名又不能访问了，按照问题1进行处理。</p><p>只要修改了配置文件，都要执行以下命令生成新的新的静态文件</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hexo clean &amp;&amp; hexo deploy</span><br></pre></td></tr></table></figure><h1>问题4 如何为每篇文章添加文字/图片？</h1><p>可以在主题下的<code>layout/post.ejs</code>中添加，把需要添加的内容放在<code>&lt;%- page.content %&gt;</code>后面，如：</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;%- page.content %&gt;</span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span> <span class="attr">style</span>=<span class="string">&quot;text-align: center;&quot;</span>&gt;</span> 感谢浏览，如对您有帮助或需联系我，欢迎关注我的微信公众号~<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 博客搭建 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 博客搭建 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>测试文章</title>
      <link href="/posts/undefined/"/>
      <url>/posts/undefined/</url>
      
        <content type="html"><![CDATA[<p>Test PageFrom 2023<br>Test PageForm Gzhou</p><p>图片测试</p><p>Django学习<br><a href="https://zhuanlan.zhihu.com/p/113447102">https://zhuanlan.zhihu.com/p/113447102</a></p><p>simpleui官网<br><a href="https://newpanjing.github.io/simpleui_docs/">https://newpanjing.github.io/simpleui_docs/</a></p>]]></content>
      
      
      <categories>
          
          <category> 博客测试 </category>
          
      </categories>
      
      
    </entry>
    
    
  
  
</search>

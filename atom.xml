<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>运维少年</title>
  
  <subtitle>运维少年的博客</subtitle>
  <link href="https://www.esearch.top/atom.xml" rel="self"/>
  
  <link href="https://www.esearch.top/"/>
  <updated>2024-10-03T03:18:01.798Z</updated>
  <id>https://www.esearch.top/</id>
  
  <author>
    <name>运维少年</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>nginx 代理设置访问密码（不依赖htpasswd工具）</title>
    <link href="https://www.esearch.top/posts/f2baa4c/"/>
    <id>https://www.esearch.top/posts/f2baa4c/</id>
    <published>2024-10-03T03:12:29.000Z</published>
    <updated>2024-10-03T03:18:01.798Z</updated>
    
    <content type="html"><![CDATA[<h1>Nginx访问密码配置（无需htpasswd）</h1><p>要在Nginx中配置访问密码而不依赖于<code>htpasswd</code>等第三方工具，可以按照以下步骤手动创建密码文件并在Nginx配置中引用它。</p><h2 id="步骤1：创建密码文件">步骤1：创建密码文件</h2><ol><li class="lvl-3"><p><strong>生成加密密码</strong>：使用编程语言或在线工具生成加密密码。例如，使用Python的<code>crypt</code>模块：</p></li></ol><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> crypt</span><br><span class="line"><span class="built_in">print</span>(crypt.crypt(<span class="string">&quot;your_password&quot;</span>, <span class="string">&quot;salt&quot;</span>))</span><br></pre></td></tr></table></figure><ol start="2"><li class="lvl-3"><p><strong>保存密码文件</strong>：创建一个文本文件（如<code>passwords</code>），并将加密后的密码保存在其中，格式为：</p></li></ol><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">username:$apr1$...$...</span><br></pre></td></tr></table></figure><ol start="3"><li class="lvl-3"><p><strong>存放密码文件</strong>：将<code>passwords</code>文件放置在安全的位置，如<code>/etc/nginx/</code>目录下。</p></li></ol><h2 id="步骤2：编辑Nginx配置文件">步骤2：编辑Nginx配置文件</h2><ol><li class="lvl-3"><p><strong>打开配置文件</strong>：编辑<code>Nginx</code>主配置文件<code>/etc/nginx/nginx.conf</code>或相关虚拟主机配置文件。</p></li><li class="lvl-3"><p><strong>添加认证指令</strong>：在相应的<code>server</code>块或<code>location</code>块中添加以下指令以启用基本认证：</p></li></ol><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">location</span> / &#123;</span><br><span class="line">    <span class="attribute">auth_basic</span> <span class="string">&quot;Restricted&quot;</span>;</span><br><span class="line">    <span class="attribute">auth_basic_user_file</span> /etc/nginx/passwords;</span><br><span class="line">    <span class="comment"># 其他配置...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul class="lvl-0"><li class="lvl-2"><p><code>auth_basic &quot;Restricted&quot;</code>;定义了认证提示信息。</p></li><li class="lvl-2"><p><code>auth_basic_user_file</code>指定之前创建的密码文件路径。</p></li></ul><h2 id="步骤3：重新加载">步骤3：重新加载</h2><p>保存配置文件更改后，重启Nginx服务以应用新设置：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nginx -s reload</span><br></pre></td></tr></table></figure><h2 id="步骤4：测试访问">步骤4：测试访问</h2><p>尝试访问网站，系统应提示输入用户名和密码。使用在<code>passwords</code>文件中定义的凭据登录，若正确，可正常访问网站。</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1&gt;Nginx访问密码配置（无需htpasswd）&lt;/h1&gt;
&lt;p&gt;要在Nginx中配置访问密码而不依赖于&lt;code&gt;htpasswd&lt;/code&gt;等第三方工具，可以按照以下步骤手动创建密码文件并在Nginx配置中引用它。&lt;/p&gt;
&lt;h2 id=&quot;步骤1：创建密码文件&quot;&gt;步骤</summary>
      
    
    
    
    <category term="Linux" scheme="https://www.esearch.top/categories/Linux/"/>
    
    
    <category term="Linux" scheme="https://www.esearch.top/tags/Linux/"/>
    
    <category term="Nginx" scheme="https://www.esearch.top/tags/Nginx/"/>
    
  </entry>
  
  <entry>
    <title>Debian脚本中使用了&amp;&gt;/dev/null，$?总是返回0</title>
    <link href="https://www.esearch.top/posts/78eb14d2/"/>
    <id>https://www.esearch.top/posts/78eb14d2/</id>
    <published>2024-09-30T09:33:10.000Z</published>
    <updated>2024-09-30T09:52:48.976Z</updated>
    
    <content type="html"><![CDATA[<h1>一、问题现象</h1><p>在<code>CentOS</code>中编写了一段<code>Shell</code>脚本，作用很简单，就是监控nginx的配置文件是否发生了变化，如果发生了变化就自动<code>reload</code>一次，脚本如下：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"><span class="keyword">while</span> <span class="literal">true</span></span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">  md5=`<span class="built_in">md5sum</span> /etc/nginx/conf.d/port-to-domain.conf | awk <span class="string">&#x27;&#123;print $1&#125;&#x27;</span>`</span><br><span class="line">  grep <span class="variable">$&#123;md5&#125;</span> /tmp/md5result &amp;&gt;/dev/null</span><br><span class="line">  <span class="keyword">if</span> [ $? -ne 0 ];<span class="keyword">then</span> </span><br><span class="line">    <span class="built_in">echo</span> `<span class="built_in">date</span>` <span class="string">&#x27;Config File Change&#x27;</span></span><br><span class="line">    <span class="built_in">echo</span> `<span class="built_in">date</span>` <span class="string">&#x27;Command nginx -t exec&#x27;</span></span><br><span class="line">    nginx -t</span><br><span class="line">    <span class="keyword">if</span> [ $? -eq 0 ];<span class="keyword">then</span></span><br><span class="line">      <span class="built_in">echo</span> `<span class="built_in">date</span>` <span class="string">&#x27;Command nginx -t exec success&#x27;</span></span><br><span class="line">      nginx -s reload</span><br><span class="line">      <span class="built_in">echo</span> `<span class="built_in">date</span>` <span class="string">&#x27;Command nginx -s reload exec&#x27;</span></span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">      <span class="built_in">echo</span> `<span class="built_in">date</span>` <span class="string">&#x27;Command nginx -t exec failed&#x27;</span></span><br><span class="line">    <span class="keyword">fi</span></span><br><span class="line">    </span><br><span class="line">    <span class="built_in">echo</span> <span class="variable">$&#123;md5&#125;</span> &gt; /tmp/md5result</span><br><span class="line">    <span class="built_in">echo</span> `<span class="built_in">date</span>` <span class="string">&#x27;Change md5result&#x27;</span></span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">    <span class="built_in">echo</span> `<span class="built_in">date</span>` <span class="string">&#x27;Config File NoChange&#x27;</span></span><br><span class="line">  <span class="keyword">fi</span></span><br><span class="line">  <span class="built_in">sleep</span> 5</span><br><span class="line"><span class="keyword">done</span></span><br></pre></td></tr></table></figure><p>在<code>CentOS</code>中运行一切正常，但是在Debian中运行异常，具体是<code>grep $&#123;md5&#125; /tmp/md5result &amp;&gt;/dev/null</code>的返回值总是0</p><ul class="lvl-0"><li class="lvl-2"><p>Centos执行过程</p></li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">[root@txy201-51 ~]<span class="comment"># sh -x monitor.sh </span></span><br><span class="line">+ <span class="literal">true</span></span><br><span class="line">++ <span class="built_in">md5sum</span> /etc/nginx/conf.d/port-to-domain.conf</span><br><span class="line">++ awk <span class="string">&#x27;&#123;print $1&#125;&#x27;</span></span><br><span class="line">+ md5=37e9863c68386613dd0ee4b3a5183380</span><br><span class="line">+ grep 37e9863c68386613dd0ee4b3a5183380 /tmp/md5result</span><br><span class="line">+ <span class="string">&#x27;[&#x27;</span> 1 -ne 0 <span class="string">&#x27;]&#x27;</span> <span class="comment"># 正常返回非0值</span></span><br><span class="line">+ <span class="built_in">echo</span> <span class="string">&#x27;Config File Change&#x27;</span></span><br><span class="line">Config File Change</span><br></pre></td></tr></table></figure><ul class="lvl-0"><li class="lvl-2"><p>Debian系统执行过程</p></li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">root@cd3b9bf29db3:/<span class="comment"># sh -x monitor.sh </span></span><br><span class="line">+ <span class="literal">true</span></span><br><span class="line">+ <span class="built_in">md5sum</span> /etc/nginx/conf.d/port-to-domain.conf</span><br><span class="line">+ awk &#123;<span class="built_in">print</span> <span class="variable">$1</span>&#125;</span><br><span class="line">+ md5=bca7fa98ab245fa12a4a70a9b15e8b9a</span><br><span class="line">+ </span><br><span class="line">+ [ 0 -ne 0 ]  <span class="comment"># 结果返回0，即使/tmp/md5result不存在也返回0</span></span><br><span class="line">+ grep bca7fa98ab245fa12a4a70a9b15e8b9a /tmp/md5result</span><br><span class="line">+ <span class="built_in">date</span></span><br><span class="line">+ <span class="built_in">echo</span> Mon Sep 30 09:21:43 UTC 2024 Config File NoChange</span><br></pre></td></tr></table></figure><h1>二、问题排查</h1><ul class="lvl-0"><li class="lvl-2"><p>我在Debian的命令行手动执行以上命令，均无问题。</p></li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">root@cd3b9bf29db3:/<span class="comment"># md5=`md5sum /etc/nginx/conf.d/port-to-domain.conf | awk &#x27;&#123;print $1&#125;&#x27;`</span></span><br><span class="line">root@cd3b9bf29db3:/<span class="comment"># grep $&#123;md5&#125; /tmp/md5result &amp;&gt;/dev/null</span></span><br><span class="line">root@cd3b9bf29db3:/<span class="comment"># echo $?</span></span><br><span class="line">2 <span class="comment"># 返回正常</span></span><br><span class="line">root@cd3b9bf29db3:/<span class="comment">#  </span></span><br></pre></td></tr></table></figure><ul class="lvl-0"><li class="lvl-2"><p>尝试将<code>&amp;&gt;/dev/null</code>删除掉，再测试，发现正常了，不知道是啥原因导致的异常。</p></li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">root@cd3b9bf29db3:/<span class="comment"># sh -x monitor.sh </span></span><br><span class="line">+ <span class="literal">true</span></span><br><span class="line">+ <span class="built_in">md5sum</span> /etc/nginx/conf.d/port-to-domain.conf</span><br><span class="line">+ awk &#123;<span class="built_in">print</span> <span class="variable">$1</span>&#125;</span><br><span class="line">+ md5=bca7fa98ab245fa12a4a70a9b15e8b9a</span><br><span class="line">+ grep bca7fa98ab245fa12a4a70a9b15e8b9a /tmp/md5result</span><br><span class="line">grep: /tmp/md5result: No such file or directory</span><br><span class="line">+ [ 2 -ne 0 ] <span class="comment"># 返回值正常了</span></span><br></pre></td></tr></table></figure><ul class="lvl-0"><li class="lvl-2"><p>我尝试修改了运行脚本的方式，从<code>sh scritp.sh</code> 修改为<code>bash script.sh</code>，结果成功了</p></li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">root@cd3b9bf29db3:/<span class="comment"># echo &gt; /tmp/md5result </span></span><br><span class="line"><span class="comment"># bash 与预期相符</span></span><br><span class="line">root@cd3b9bf29db3:/<span class="comment"># bash monitor.sh </span></span><br><span class="line">Mon Sep 30 09:48:11 UTC 2024 Config File Change</span><br><span class="line">Mon Sep 30 09:48:11 UTC 2024 Command nginx -t <span class="built_in">exec</span></span><br><span class="line">nginx: the configuration file /etc/nginx/nginx.conf syntax is ok</span><br><span class="line">nginx: configuration file /etc/nginx/nginx.conf <span class="built_in">test</span> is successful</span><br><span class="line">Mon Sep 30 09:48:11 UTC 2024 Command nginx -t <span class="built_in">exec</span> success</span><br><span class="line">2024/09/30 09:48:11 [notice] 592<span class="comment">#592: signal process started</span></span><br><span class="line">Mon Sep 30 09:48:11 UTC 2024 Command nginx -s reload <span class="built_in">exec</span></span><br><span class="line">Mon Sep 30 09:48:11 UTC 2024 Change md5result</span><br><span class="line">Mon Sep 30 09:48:16 UTC 2024 Config File NoChange</span><br><span class="line">^C</span><br><span class="line">root@cd3b9bf29db3:/<span class="comment"># echo 1 &gt; /tmp/md5result </span></span><br><span class="line"><span class="comment"># sh 与预期不相符</span></span><br><span class="line">root@cd3b9bf29db3:/<span class="comment"># sh monitor.sh </span></span><br><span class="line">Mon Sep 30 09:48:38 UTC 2024 Config File NoChange</span><br><span class="line">Mon Sep 30 09:48:43 UTC 2024 Config File NoChange</span><br></pre></td></tr></table></figure><h1>三、结论</h1><blockquote><p>这个结论是问AI的您遇到的问题很可能是由于sh和bash在处理某些命令或脚本构造时的行为差异所致。在Linux系统中，sh通常指的是POSIX shell，而bash是Bourne Again SHell的简称，它是GNU项目的一个兼容sh的shell程序，提供了许多sh没有的特性和改进。</p></blockquote><p><strong>为啥CentOS可以，Debian不行?</strong><br>应该是sh的版本等不同造成的。</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1&gt;一、问题现象&lt;/h1&gt;
&lt;p&gt;在&lt;code&gt;CentOS&lt;/code&gt;中编写了一段&lt;code&gt;Shell&lt;/code&gt;脚本，作用很简单，就是监控nginx的配置文件是否发生了变化，如果发生了变化就自动&lt;code&gt;reload&lt;/code&gt;一次，脚本如下：&lt;/p&gt;
&lt;fig</summary>
      
    
    
    
    <category term="Linux" scheme="https://www.esearch.top/categories/Linux/"/>
    
    
    <category term="Linux" scheme="https://www.esearch.top/tags/Linux/"/>
    
    <category term="Shell" scheme="https://www.esearch.top/tags/Shell/"/>
    
  </entry>
  
  <entry>
    <title>使用docker安装webssh</title>
    <link href="https://www.esearch.top/posts/e0c5f301/"/>
    <id>https://www.esearch.top/posts/e0c5f301/</id>
    <published>2024-09-24T09:31:30.000Z</published>
    <updated>2024-09-24T15:19:14.058Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>部署webssh，可以实现使用浏览器ssh登录，摆脱工具的限制</p></blockquote><h1>部署</h1><ul class="lvl-0"><li class="lvl-2"><p>docker运行</p></li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker run -d --log-driver json-file --log-opt max-file=1 --log-opt max-size=100m -p 8032:5032 --restart always --name webssh -e TZ=Asia/Shanghai -e authInfo=用户名:密码 -e savePass=<span class="literal">false</span> jrohy/webssh</span><br></pre></td></tr></table></figure><ul class="lvl-0"><li class="lvl-2"><p>支持添加的环境变量：</p></li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">port: web使用端口, 默认5032</span><br><span class="line">savePass: 是否保存密码, 默认true</span><br><span class="line">authInfo: 开启账号密码登录验证, &#x27;user:pass&#x27;的格式设置</span><br></pre></td></tr></table></figure><ul class="lvl-0"><li class="lvl-2"><p>打开网页<br><img src="/img/webssh2.png" alt="webssh"></p></li></ul><h1>nginx反向代理(可选)</h1><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">map <span class="variable">$http_upgrade</span> <span class="variable">$connection_upgrade</span> &#123;</span><br><span class="line">    default keep-alive;</span><br><span class="line">    <span class="string">&#x27;websocket&#x27;</span> upgrade;</span><br><span class="line">&#125;</span><br><span class="line">server &#123;</span><br><span class="line">    listen  80;</span><br><span class="line">    client_max_body_size 1024m;</span><br><span class="line">    server_name     webssh.域名.top;</span><br><span class="line">    location / &#123;</span><br><span class="line">        proxy_set_header        Host <span class="variable">$host</span>;</span><br><span class="line">        proxy_pass      http://0.0.0.0:8032; <span class="comment"># 转发</span></span><br><span class="line">        proxy_set_header X-Real-IP <span class="variable">$remote_addr</span>;  <span class="comment">#获取客户端真实IP</span></span><br><span class="line">        proxy_set_header REMOTE-HOST <span class="variable">$remote_addr</span>;</span><br><span class="line">        proxy_set_header Upgrade <span class="variable">$http_upgrade</span>;</span><br><span class="line">        proxy_set_header Connection <span class="variable">$connection_upgrade</span>;</span><br><span class="line">        proxy_set_header X-Forwarded-For <span class="variable">$proxy_add_x_forwarded_for</span>;</span><br><span class="line">        add_header Access-Control-Allow-Origin *;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;blockquote&gt;
&lt;p&gt;部署webssh，可以实现使用浏览器ssh登录，摆脱工具的限制&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h1&gt;部署&lt;/h1&gt;
&lt;ul class=&quot;lvl-0&quot;&gt;
&lt;li class=&quot;lvl-2&quot;&gt;
&lt;p&gt;docker运行&lt;/p&gt;
&lt;/li&gt;
&lt;/</summary>
      
    
    
    
    <category term="工具类" scheme="https://www.esearch.top/categories/%E5%B7%A5%E5%85%B7%E7%B1%BB/"/>
    
    
    <category term="工具" scheme="https://www.esearch.top/tags/%E5%B7%A5%E5%85%B7/"/>
    
    <category term="Docker" scheme="https://www.esearch.top/tags/Docker/"/>
    
  </entry>
  
  <entry>
    <title>gitpage 套上 cloudflare后显示过多重定向问题解决</title>
    <link href="https://www.esearch.top/posts/6c7d376/"/>
    <id>https://www.esearch.top/posts/6c7d376/</id>
    <published>2024-09-17T08:07:35.000Z</published>
    <updated>2024-09-17T08:12:04.818Z</updated>
    
    <content type="html"><![CDATA[<h1>一、现象</h1><p>在<code>cloudflare</code>设置好dns之后，gitpage页面无法打开，显示<strong>将您重定向的次数过多</strong></p><h1>二、解决办法</h1><p>在<code>cloudflare</code>的<code>SSL/TLS</code> &gt; <code>概述</code>中，将<code>SSL/TLS加密</code>修改为灵活即可。</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1&gt;一、现象&lt;/h1&gt;
&lt;p&gt;在&lt;code&gt;cloudflare&lt;/code&gt;设置好dns之后，gitpage页面无法打开，显示&lt;strong&gt;将您重定向的次数过多&lt;/strong&gt;&lt;/p&gt;
&lt;h1&gt;二、解决办法&lt;/h1&gt;
&lt;p&gt;在&lt;code&gt;cloudflare&lt;/code</summary>
      
    
    
    
    <category term="博客搭建" scheme="https://www.esearch.top/categories/%E5%8D%9A%E5%AE%A2%E6%90%AD%E5%BB%BA/"/>
    
    
    <category term="博客搭建" scheme="https://www.esearch.top/tags/%E5%8D%9A%E5%AE%A2%E6%90%AD%E5%BB%BA/"/>
    
  </entry>
  
  <entry>
    <title>OpenEuler 安装MySql</title>
    <link href="https://www.esearch.top/posts/b5a91e2c/"/>
    <id>https://www.esearch.top/posts/b5a91e2c/</id>
    <published>2024-09-10T01:22:10.000Z</published>
    <updated>2024-09-10T01:29:18.330Z</updated>
    
    <content type="html"><![CDATA[<p><strong>安装mysql</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum install mysql-server -y</span><br></pre></td></tr></table></figure><p><strong>初始化</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysqld --initialize --console</span><br></pre></td></tr></table></figure><p><strong>目录授权</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">chown</span> -R mysql:mysql /var/lib/mysql/</span><br></pre></td></tr></table></figure><blockquote><p>注意，如果在/etc/my.cnf.d/my.cnf中修改了目录路径，需要对相关路径进行权限修改。</p></blockquote><p><strong>设置登录密码</strong></p><ul class="lvl-0"><li class="lvl-2"><p>修改配置</p></li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">vi /etc/my.cnf</span><br><span class="line"><span class="comment">#在mysqld模块下添加</span></span><br><span class="line">skip-grant-tables</span><br></pre></td></tr></table></figure><ul class="lvl-0"><li class="lvl-2"><p>重启服务</p></li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">systemctl restart mysqld</span><br></pre></td></tr></table></figure><ul class="lvl-0"><li class="lvl-2"><p>进入数据库</p></li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">mysql -u root -p</span><br><span class="line"><span class="comment"># 在提示密码时直接按回车</span></span><br></pre></td></tr></table></figure><ul class="lvl-0"><li class="lvl-2"><p>在数据库中刷新权限</p></li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; flush privileges;</span><br><span class="line">Query OK, 0 rows affected (0.05 sec)</span><br></pre></td></tr></table></figure><ul class="lvl-0"><li class="lvl-2"><p>修改密码</p></li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; alter user <span class="string">&#x27;root&#x27;</span>@<span class="string">&#x27;localhost&#x27;</span> identified by <span class="string">&#x27;newpassword&#x27;</span>;</span><br><span class="line">Query OK, 0 rows affected (0.01 sec)</span><br></pre></td></tr></table></figure><ul class="lvl-0"><li class="lvl-2"><p>删除配置</p></li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">vi /etc/my.cnf</span><br><span class="line"><span class="comment">#在mysqld模块下删除</span></span><br><span class="line">skip-grant-tables</span><br></pre></td></tr></table></figure><ul class="lvl-0"><li class="lvl-2"><p>重启服务就可以使用密码登录了</p></li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">systemctl restart mysqld</span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;&lt;strong&gt;安装mysql&lt;/strong&gt;&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;</summary>
      
    
    
    
    <category term="Linux" scheme="https://www.esearch.top/categories/Linux/"/>
    
    
    <category term="Linux" scheme="https://www.esearch.top/tags/Linux/"/>
    
    <category term="Database" scheme="https://www.esearch.top/tags/Database/"/>
    
  </entry>
  
  <entry>
    <title>openEuler开启kdump失败</title>
    <link href="https://www.esearch.top/posts/1c033694/"/>
    <id>https://www.esearch.top/posts/1c033694/</id>
    <published>2024-06-24T07:23:00.000Z</published>
    <updated>2024-06-26T03:17:26.486Z</updated>
    
    <content type="html"><![CDATA[<h1>一、现象</h1><p>openEuler启动kdump失败，显示<code>No memory reserved for crash kernel</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">[root@kvm-hkcloud01 ~]<span class="comment"># systemctl status kdump</span></span><br><span class="line"> kdump.service - Crash recovery kernel arming</span><br><span class="line">     Loaded: loaded (/usr/lib/systemd/system/kdump.service; enabled; vendor preset: enabled)</span><br><span class="line">     Active: failed (Result: exit-code) since Mon 2024-06-24 14:50:48 CST; 26min ago</span><br><span class="line">    Process: 1004 ExecStart=/usr/bin/kdumpctl start (code=exited, status=1/FAILURE)</span><br><span class="line">   Main PID: 1004 (code=exited, status=1/FAILURE)</span><br><span class="line"></span><br><span class="line">Jun 24 14:50:47 kvm-hkcloud01 systemd[1]: Starting Crash recovery kernel arming...</span><br><span class="line">Jun 24 14:50:48 kvm-hkcloud01 kdumpctl[1015]: No memory reserved <span class="keyword">for</span> crash kernel</span><br><span class="line">Jun 24 14:50:48 kvm-hkcloud01 kdumpctl[1015]: Starting kdump: [FAILED]</span><br><span class="line">Jun 24 14:50:48 kvm-hkcloud01 systemd[1]: kdump.service: Main process exited, code=exited, status=1/FAILURE</span><br><span class="line">Jun 24 14:50:48 kvm-hkcloud01 systemd[1]: kdump.service: Failed with result <span class="string">&#x27;exit-code&#x27;</span>.</span><br><span class="line">Jun 24 14:50:48 kvm-hkcloud01 systemd[1]: Failed to start Crash recovery kernel arming.</span><br></pre></td></tr></table></figure><h1>二、问题分析</h1><p>根据提示来看，应该是申请不到内存导致的，但从<code>free</code>的结果来看，是可以满足kdump的要求的</p><ul class="lvl-0"><li class="lvl-2">资源剩余700M+</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[root@kvm-hkcloud01 ~]<span class="comment"># free -h</span></span><br><span class="line">               total        used        free      shared  buff/cache   available</span><br><span class="line">Mem:           967Mi        89Mi       442Mi        23Mi       436Mi       715Mi</span><br><span class="line">Swap:             0B          0B          0B</span><br><span class="line">[root@kvm-hkcloud01 ~]<span class="comment">#</span></span><br></pre></td></tr></table></figure><ul class="lvl-0"><li class="lvl-2">kdump的需求是512M</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[root@kvm-hkcloud01 ~]<span class="comment"># cat /proc/cmdline</span></span><br><span class="line">BOOT_IMAGE=/boot/vmlinuz-5.10.0-136.12.0.86.oe2203sp1.x86_64 root=UUID=d372d015-87b7-44ed-9860-33c9d47eedb6 ro cgroup_disable=files apparmor=0 crashkernel=512M</span><br><span class="line">[root@kvm-hkcloud01 ~]<span class="comment">#</span></span><br></pre></td></tr></table></figure><p><strong>为什么会分配不到资源呢？难道是启动期间资源不足导致？</strong></p><p>接下来我将crash的内存修改为128M，发现可以启动成功。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 查看当前配置</span></span><br><span class="line">[root@kvm-hkcloud01 ~]<span class="comment"># cat /etc/default/grub</span></span><br><span class="line">GRUB_TIMEOUT=5</span><br><span class="line">GRUB_DISTRIBUTOR=<span class="string">&quot;<span class="subst">$(sed &#x27;s, release .*$,,g&#x27; /etc/system-release)</span>&quot;</span></span><br><span class="line">GRUB_DEFAULT=saved</span><br><span class="line">GRUB_DISABLE_SUBMENU=<span class="literal">true</span></span><br><span class="line">GRUB_TERMINAL_OUTPUT=<span class="string">&quot;console&quot;</span></span><br><span class="line">GRUB_CMDLINE_LINUX=<span class="string">&quot;cgroup_disable=files apparmor=0 crashkernel=512M&quot;</span></span><br><span class="line">GRUB_DISABLE_RECOVERY=<span class="string">&quot;true&quot;</span></span><br><span class="line"><span class="comment"># 修改为128</span></span><br><span class="line">[root@kvm-hkcloud01 ~]<span class="comment"># sed -i &#x27;s/512/128/g&#x27; /etc/default/grub</span></span><br><span class="line"><span class="comment"># 重新生成grub.cfg</span></span><br><span class="line">[root@kvm-hkcloud01 ~]<span class="comment"># grub2-mkconfig -o /boot/grub2/grub.cfg</span></span><br><span class="line">Generating grub configuration file ...</span><br><span class="line">Found linux image: /boot/vmlinuz-5.10.0-136.12.0.86.oe2203sp1.x86_64</span><br><span class="line">Found initrd image: /boot/initramfs-5.10.0-136.12.0.86.oe2203sp1.x86_64.img</span><br><span class="line">Found linux image: /boot/vmlinuz-0-rescue-7c27015c30d4409fb116e3795e6126c4</span><br><span class="line">Found initrd image: /boot/initramfs-0-rescue-7c27015c30d4409fb116e3795e6126c4.img</span><br><span class="line">Adding boot menu entry <span class="keyword">for</span> UEFI Firmware Settings ...</span><br><span class="line"><span class="keyword">done</span></span><br><span class="line"><span class="comment"># 重启主机</span></span><br><span class="line">[root@kvm-hkcloud01 ~]<span class="comment"># reboot</span></span><br><span class="line"><span class="comment"># 查看服务</span></span><br><span class="line">[root@kvm-hkcloud01 ~]<span class="comment"># systemctl status kdump</span></span><br><span class="line">● kdump.service - Crash recovery kernel arming</span><br><span class="line">     Loaded: loaded (/usr/lib/systemd/system/kdump.service; enabled; vendor preset: enabled)</span><br><span class="line">     Active: active (exited) since Wed 2024-06-26 10:25:09 CST; 1min 12s ago</span><br><span class="line">    Process: 1002 ExecStart=/usr/bin/kdumpctl start (code=exited, status=0/SUCCESS)</span><br><span class="line">   Main PID: 1002 (code=exited, status=0/SUCCESS)</span><br><span class="line"></span><br><span class="line">Jun 26 10:25:03 kvm-hkcloud01 systemd[1]: Starting Crash recovery kernel arming...</span><br><span class="line">Jun 26 10:25:09 kvm-hkcloud01 kdumpctl[1009]: kexec: loaded kdump kernel</span><br><span class="line">Jun 26 10:25:09 kvm-hkcloud01 kdumpctl[1009]: Starting kdump: [OK]</span><br><span class="line">Jun 26 10:25:09 kvm-hkcloud01 systemd[1]: Finished Crash recovery kernel arming.</span><br><span class="line">[root@kvm-hkcloud01 ~]<span class="comment">#</span></span><br><span class="line"><span class="comment"># 查看内存，可以看到内存的总量比之前少了128M，说明128M的内存已经分配给crash了。</span></span><br><span class="line">[root@kvm-hkcloud01 ~]<span class="comment"># free -h</span></span><br><span class="line">               total        used        free      shared  buff/cache   available</span><br><span class="line">Mem:           839Mi        85Mi       559Mi       6.2Mi       195Mi       623Mi</span><br><span class="line">Swap:             0B          0B          0B</span><br><span class="line">[root@kvm-hkcloud01 ~]<span class="comment">#</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><blockquote><p>不能分配太少的内存，如果内存太少，会有<code> Could not find a free area of memory of 0x1ddd000 bytes...</code>错误，可以通过<code> makedumpfile --mem-usage /proc/kcore</code>来估算需要多少内存。</p></blockquote><h1>结论</h1><p>虚拟机内存少，而crash设置的内存比较多，会出现因资源不足没办法给crash分配内存的情况，导致kdump启动失败，可以通过修改crash内存参数来解决。</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1&gt;一、现象&lt;/h1&gt;
&lt;p&gt;openEuler启动kdump失败，显示&lt;code&gt;No memory reserved for crash kernel&lt;/code&gt;&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td cla</summary>
      
    
    
    
    <category term="Linux" scheme="https://www.esearch.top/categories/Linux/"/>
    
    
    <category term="openEuler" scheme="https://www.esearch.top/tags/openEuler/"/>
    
    <category term="kdump" scheme="https://www.esearch.top/tags/kdump/"/>
    
  </entry>
  
  <entry>
    <title>Linux重装系统后恢复LVM</title>
    <link href="https://www.esearch.top/posts/1208ed6f/"/>
    <id>https://www.esearch.top/posts/1208ed6f/</id>
    <published>2024-06-21T09:16:37.000Z</published>
    <updated>2024-06-21T09:23:43.453Z</updated>
    
    <content type="html"><![CDATA[<p>最近重装了操作系统，仅格式化了操作系统盘，数据盘没有动，因为数据盘之前使用<code>lvm</code>进行管理的，不能直接挂在，要先恢复<code>lvm</code>信息才能挂载。</p><blockquote><p>恢复的前提是要知道vg的名称！！！</p></blockquote><p>步骤如下：</p><ul class="lvl-0"><li class="lvl-2"><p>扫描和识别<code>pv</code>信息</p></li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[root@kvm-hkcloud01 ~]<span class="comment"># pvscan</span></span><br><span class="line">  PV /dev/vdb   VG vg_data         lvm2 [&lt;30.00 GiB / 1020.00 MiB free]</span><br><span class="line">  Total: 1 [&lt;30.00 GiB] / <span class="keyword">in</span> use: 1 [&lt;30.00 GiB] / <span class="keyword">in</span> no VG: 0 [0   ]</span><br></pre></td></tr></table></figure><ul class="lvl-0"><li class="lvl-2"><p>激活vg（前提是要知道vg的名称）</p></li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@kvm-hkcloud01 ~]<span class="comment"># vgchange -ay vg_data</span></span><br><span class="line">  1 logical volume(s) <span class="keyword">in</span> volume group <span class="string">&quot;vg_data&quot;</span> now active</span><br></pre></td></tr></table></figure><ul class="lvl-0"><li class="lvl-2"><p>查看是否有<code>lv</code>数据</p></li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">[root@kvm-hkcloud01 ~]<span class="comment"># lvdisplay</span></span><br><span class="line">  --- Logical volume ---</span><br><span class="line">  LV Path                /dev/vg_data/lv_data</span><br><span class="line">  LV Name                lv_data</span><br><span class="line">  VG Name                vg_data</span><br><span class="line">  LV UUID                JJOdQt-2l5h-fEHJ-MkIo-bwG3-G3YV-mfjz72</span><br><span class="line">  LV Write Access        <span class="built_in">read</span>/write</span><br><span class="line">  LV Creation host, time kvm-hkcloud01.local, 2024-02-23 11:41:13 +0800</span><br><span class="line">  LV Status              available</span><br><span class="line">  <span class="comment"># open                 0</span></span><br><span class="line">  LV Size                29.00 GiB</span><br><span class="line">  Current LE             7424</span><br><span class="line">  Segments               1</span><br><span class="line">  Allocation             inherit</span><br><span class="line">  Read ahead sectors     auto</span><br><span class="line">  - currently <span class="built_in">set</span> to     8192</span><br><span class="line">  Block device           252:0</span><br><span class="line"></span><br><span class="line">[root@kvm-hkcloud01 ~]<span class="comment">#</span></span><br></pre></td></tr></table></figure><ul class="lvl-0"><li class="lvl-2"><p>挂载</p></li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">[root@kvm-hkcloud01 ~]<span class="comment"># mount /dev/mapper/vg_data-lv_data /data</span></span><br><span class="line">[root@kvm-hkcloud01 ~]<span class="comment"># df -h</span></span><br><span class="line">Filesystem                   Size  Used Avail Use% Mounted on</span><br><span class="line">devtmpfs                     4.0M     0  4.0M   0% /dev</span><br><span class="line">tmpfs                        484M     0  484M   0% /dev/shm</span><br><span class="line">tmpfs                        194M  5.4M  189M   3% /run</span><br><span class="line">tmpfs                        4.0M     0  4.0M   0% /sys/fs/cgroup</span><br><span class="line">/dev/vda1                     50G  1.8G   46G   4% /</span><br><span class="line">tmpfs                        484M     0  484M   0% /tmp</span><br><span class="line">/dev/mapper/vg_data-lv_data   29G  3.4G   26G  12% /data</span><br></pre></td></tr></table></figure><h2 id="参考资料">参考资料</h2><blockquote><ul class="lvl-1"><li class="lvl-2"><p><a href=""></a></p></li><li class="lvl-2"><p><a href=""></a></p></li></ul></blockquote>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;最近重装了操作系统，仅格式化了操作系统盘，数据盘没有动，因为数据盘之前使用&lt;code&gt;lvm&lt;/code&gt;进行管理的，不能直接挂在，要先恢复&lt;code&gt;lvm&lt;/code&gt;信息才能挂载。&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;恢复的前提是要知道vg的名称！！！&lt;/p&gt;
&lt;</summary>
      
    
    
    
    <category term="Linux" scheme="https://www.esearch.top/categories/Linux/"/>
    
    
    <category term="Linux" scheme="https://www.esearch.top/tags/Linux/"/>
    
    <category term="文件系统" scheme="https://www.esearch.top/tags/%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F/"/>
    
  </entry>
  
  <entry>
    <title>Linux中sysrq-trigger的妙用</title>
    <link href="https://www.esearch.top/posts/c0f21a4/"/>
    <id>https://www.esearch.top/posts/c0f21a4/</id>
    <published>2024-06-21T08:13:01.000Z</published>
    <updated>2024-06-21T08:14:16.879Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>sysrq被称为魔术组合键，只要内核没有完全锁住，不管内核在做什么事情，使用这些组合键都可以搜集包括系统内存使用、CPU任务处理、进程运行状态等系统运行信息。 注意：信息的输出都在/var/log/message下</p></blockquote><p>Linux如何模拟崩溃？如何强制关机？这时候就可以使用到本文提到的<code>/proc/sysrq-trigger</code>文件了。</p><ul class="lvl-0"><li class="lvl-2"><p>故意让系统崩溃，注意这不是重启，崩溃后只能从进行硬重启才能重连上系统。（产生空指针paincz事件，触发kdump，收集vmcore，会在/var/crash目录生成）</p></li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">echo</span> <span class="string">&quot;c&quot;</span> &gt; /proc/sysrq-trigger</span><br></pre></td></tr></table></figure><ul class="lvl-0"><li class="lvl-2"><p>立即重新启动计算机</p></li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">echo</span> <span class="string">&quot;b&quot;</span> &gt; /proc/sysrq-trigger</span><br></pre></td></tr></table></figure><ul class="lvl-0"><li class="lvl-2"><p>立即关闭计算机</p></li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">echo</span> <span class="string">&quot;o&quot;</span> &gt; /proc/sysrq-trigger</span><br></pre></td></tr></table></figure><ul class="lvl-0"><li class="lvl-2"><p>导出内存分配的信息 （可以用/var/log/message 查看）</p></li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">echo</span> <span class="string">&quot;m&quot;</span> &gt; /proc/sysrq-trigger</span><br></pre></td></tr></table></figure><ul class="lvl-0"><li class="lvl-2"><p>导出当前CPU寄存器信息和标志位的信息</p></li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">echo</span> <span class="string">&quot;p&quot;</span> &gt; /proc/sysrq-trigger</span><br></pre></td></tr></table></figure><ul class="lvl-0"><li class="lvl-2"><p>导出线程状态信息</p></li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">echo</span> <span class="string">&quot;t&quot;</span> &gt; /proc/sysrq-trigger</span><br></pre></td></tr></table></figure><ul class="lvl-0"><li class="lvl-2"><p>故意让系统溃</p></li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">echo</span> <span class="string">&quot;c&quot;</span> &gt; /proc/sysrq-trigger</span><br></pre></td></tr></table></figure><ul class="lvl-0"><li class="lvl-2"><p>立即重新挂载所有的文件系统</p></li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">echo</span> <span class="string">&quot;s&quot;</span> &gt; /proc/sysrq-trigger</span><br></pre></td></tr></table></figure><ul class="lvl-0"><li class="lvl-2"><p>立即重新挂载所有的文件系统为只读</p></li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">echo</span> <span class="string">&quot;u&quot;</span> &gt; /proc/sysrq-trigger</span><br></pre></td></tr></table></figure><p>为了安全起见，在红帽企业版Linux里面，默认SysRq组合键是关闭的。 打开这个功能，运行：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">echo</span> 1 &gt; /proc/sys/kernel/sysrq</span><br></pre></td></tr></table></figure><p>关闭这个功能：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">echo</span> 0 &gt; /proc/sys/kernel/sysrq</span><br></pre></td></tr></table></figure><p>如果想让此功能一直生效，在/etc/sysctl.conf里面设置kernel.sysrq的值为1. 重新启动以后，此功能将会自动打开。</p>]]></content>
    
    
      
      
    <summary type="html">&lt;blockquote&gt;
&lt;p&gt;sysrq被称为魔术组合键，只要内核没有完全锁住，不管内核在做什么事情，使用这些组合键都可以搜集包括系统内存使用、CPU任务处理、进程运行状态等系统运行信息。 注意：信息的输出都在/var/log/message下&lt;/p&gt;
&lt;/blockquote</summary>
      
    
    
    
    <category term="Linux" scheme="https://www.esearch.top/categories/Linux/"/>
    
    
    <category term="Linux" scheme="https://www.esearch.top/tags/Linux/"/>
    
  </entry>
  
  <entry>
    <title>Jquery禁用按钮，防止重复提交</title>
    <link href="https://www.esearch.top/posts/17c655b1/"/>
    <id>https://www.esearch.top/posts/17c655b1/</id>
    <published>2024-06-21T07:58:07.000Z</published>
    <updated>2024-06-21T08:08:06.651Z</updated>
    
    <content type="html"><![CDATA[<p>使用<code>对象.prop(&quot;disabled&quot;,true)</code>可以进行禁用，<code>对象.prop(&quot;disabled&quot;,false)</code>取消禁用。</p><ul class="lvl-0"><li class="lvl-2">html代码如下</li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">id</span>=<span class="string">&quot;editEventForm&quot;</span> <span class="attr">novalidate</span>=<span class="string">&quot;novalidate&quot;</span>&gt;</span></span><br><span class="line">.....</span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;card-footer&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;javascript:history.go(-1);&quot;</span> <span class="attr">class</span>=<span class="string">&quot;btn btn-success float-right&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">i</span>&gt;</span> 返回<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">button</span> <span class="attr">type</span>=<span class="string">&quot;submit&quot;</span> <span class="attr">class</span>=<span class="string">&quot;btn btn-primary float-right&quot;</span> <span class="attr">style</span>=<span class="string">&quot;margin-right:5px;&quot;</span>&gt;</span>提交<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br></pre></td></tr></table></figure><ul class="lvl-0"><li class="lvl-2">js代码</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line">    $(<span class="string">&quot;#editEventForm button[type=&#x27;submit&#x27;]&quot;</span>).<span class="title function_">click</span>(<span class="keyword">function</span>(<span class="params">e</span>)&#123;</span><br><span class="line">            $(<span class="string">&quot;#editEventForm button[type=&#x27;submit&#x27;]&quot;</span>).<span class="title function_">prop</span>(<span class="string">&quot;disabled&quot;</span>,<span class="literal">true</span>)</span><br><span class="line">    &#125;)</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure><blockquote><p>注意：如果您的提交按钮设置了ID，可以使用$(“#ID名称”).prop(“disabled”,true)来操作，这样就不用写这么长了。</p></blockquote><ul class="lvl-0"><li class="lvl-2"><p>可以在提交成功或失败后，执行取消禁用</p></li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$(<span class="string">&quot;#editEventForm button[type=&#x27;submit&#x27;]&quot;</span>).<span class="title function_">prop</span>(<span class="string">&quot;disabled&quot;</span>,<span class="literal">false</span>)</span><br></pre></td></tr></table></figure><h2 id="参考资料">参考资料</h2><blockquote><ul class="lvl-1"><li class="lvl-2"><p><a href=""></a></p></li><li class="lvl-2"><p><a href=""></a></p></li></ul></blockquote>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;使用&lt;code&gt;对象.prop(&amp;quot;disabled&amp;quot;,true)&lt;/code&gt;可以进行禁用，&lt;code&gt;对象.prop(&amp;quot;disabled&amp;quot;,false)&lt;/code&gt;取消禁用。&lt;/p&gt;
&lt;ul class=&quot;lvl-0&quot;&gt;
&lt;li </summary>
      
    
    
    
    <category term="前端学习" scheme="https://www.esearch.top/categories/%E5%89%8D%E7%AB%AF%E5%AD%A6%E4%B9%A0/"/>
    
    
    <category term="Jquery" scheme="https://www.esearch.top/tags/Jquery/"/>
    
  </entry>
  
  <entry>
    <title>systemd怎么查看开机自启动服务</title>
    <link href="https://www.esearch.top/posts/614dd6d8/"/>
    <id>https://www.esearch.top/posts/614dd6d8/</id>
    <published>2024-06-21T03:31:50.000Z</published>
    <updated>2024-06-21T09:54:03.126Z</updated>
    
    <content type="html"><![CDATA[<p>在CentOS 7及更高的版本中，使用<code>chkconfig</code>命令查看开机自启动信息时，发现只有几个服务被<code>SysV</code>管理的服务，没有包括<code>systemd</code>管理的服务。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">[root@kvm-hkcloud01 var]<span class="comment"># chkconfig --list</span></span><br><span class="line"></span><br><span class="line">Note: This output shows SysV services only and does not include native</span><br><span class="line">      systemd services. SysV configuration data might be overridden by native</span><br><span class="line">      systemd configuration.</span><br><span class="line"></span><br><span class="line">      If you want to list systemd services use <span class="string">&#x27;systemctl list-unit-files&#x27;</span>.</span><br><span class="line">      To see services enabled on particular target use</span><br><span class="line">      <span class="string">&#x27;systemctl list-dependencies [target]&#x27;</span>.</span><br><span class="line"></span><br><span class="line">netconsole      0:off   1:off   2:off   3:off   4:off   5:off   6:off</span><br><span class="line">network         0:off   1:off   2:on    3:on    4:on    5:on    6:off</span><br><span class="line">[root@kvm-hkcloud01 var]<span class="comment">#</span></span><br></pre></td></tr></table></figure><p>如果需要查看被<code>systemd</code>管理的服务，可以使用以下命令进行查询。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@kvm-hkcloud01 var]<span class="comment"># systemctl list-unit-files</span></span><br></pre></td></tr></table></figure><p>更多systemd内容，可参考<a href="https://ruanyifeng.com/blog/2016/03/systemd-tutorial-commands.html">https://ruanyifeng.com/blog/2016/03/systemd-tutorial-commands.html</a></p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;在CentOS 7及更高的版本中，使用&lt;code&gt;chkconfig&lt;/code&gt;命令查看开机自启动信息时，发现只有几个服务被&lt;code&gt;SysV&lt;/code&gt;管理的服务，没有包括&lt;code&gt;systemd&lt;/code&gt;管理的服务。&lt;/p&gt;
&lt;figure class=&quot;h</summary>
      
    
    
    
    <category term="Linux" scheme="https://www.esearch.top/categories/Linux/"/>
    
    
    <category term="Linux" scheme="https://www.esearch.top/tags/Linux/"/>
    
  </entry>
  
  <entry>
    <title>Linux文件的ACL</title>
    <link href="https://www.esearch.top/posts/de677c90/"/>
    <id>https://www.esearch.top/posts/de677c90/</id>
    <published>2024-06-20T07:26:54.000Z</published>
    <updated>2024-06-20T09:28:59.270Z</updated>
    
    <content type="html"><![CDATA[<p>在Linux中，一般使用<code>chmod</code>命令对属主、用户组、其它用户为类别对文件权限进行控制，这种方式较为粗略，但也能满足日常需求。在一些特殊的场景中，如只允许某些用户能访问文件的场景，如果使用<code>chmod</code>命令进行配置，一般是将这部分用户加入到组中，然后配置组的权限。</p><p>在Linux中，还提供了一种精细化的文件权限控制方式，那就是ACL（Access Control List）</p><blockquote><p>在没有ACL技术之前,Linux系统对文件的权限控制仅可划分文件的属主、用户组、其他用户三类,随着技术的发展,传统的文件权限控制已经无法适应复杂场景下的权限控制需求,比如说一个部门(即一个用户组group)存在有多名员工(即用户,user01、user02…),针对于部门内不同职责的员工,会为其赋予不同的权限,如为user01赋予可读写权限,为user02赋予只读权限,不为user03赋予任何权限,此时由于这些员工属于同一部门,就无法为这些不同的员工进行权限的细化。为此ACL(Access Control List)访问控制列表技术应运而生,使用ACL权限控制可以提供常见权限(如rwx、ugo)权限之外的权限设,置,可以针对单一用户或组来设置特定的权限。</p></blockquote><p>使用ACL必须要有文件系统的支持，目前ext3/ext4/xfs/zfs都支持文件ACL。</p><h1>相关命令</h1><ul class="lvl-0"><li class="lvl-2"><p>setfacl：设置文件的acl</p></li><li class="lvl-2"><p>getfacl：获取文件的acl</p></li><li class="lvl-2"><p>chacl：更改文件或目录的ACL</p></li></ul><h1>操作实验</h1><h2 id="用户权限配置">用户权限配置</h2><ul class="lvl-0"><li class="lvl-2"><p>user01创建文件并配置600权限</p></li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">[root@txy201-51 data]<span class="comment"># su user01</span></span><br><span class="line">[user01@txy201-51 data]$ <span class="built_in">echo</span> 51yunwei.top &gt; acltest</span><br><span class="line">[user01@txy201-51 data]$ <span class="built_in">chmod</span> 600 acltest</span><br><span class="line">[user01@txy201-51 data]$ getfacl acltest</span><br><span class="line"><span class="comment"># file: acltest</span></span><br><span class="line"><span class="comment"># owner: user01</span></span><br><span class="line"><span class="comment"># group: user01</span></span><br><span class="line">user::rw-</span><br><span class="line">group::---</span><br><span class="line">other::---</span><br><span class="line"></span><br></pre></td></tr></table></figure><ul class="lvl-0"><li class="lvl-2"><p>测试user02有没有访问权限（无）</p></li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[root@txy201-51 data]<span class="comment"># su user02</span></span><br><span class="line">[user02@txy201-51 data]$ <span class="built_in">cat</span> acltest</span><br><span class="line"><span class="built_in">cat</span>: acltest: 权限不够</span><br></pre></td></tr></table></figure><ul class="lvl-0"><li class="lvl-2"><p>使用setfacl给user02配置权限</p></li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">[user01@txy201-51 data]$ setfacl -m user02:r acltest</span><br><span class="line">[user01@txy201-51 data]$ getfacl acltest</span><br><span class="line"><span class="comment"># file: acltest</span></span><br><span class="line"><span class="comment"># owner: user01</span></span><br><span class="line"><span class="comment"># group: user01</span></span><br><span class="line">user::rw-</span><br><span class="line">user:user02:r--</span><br><span class="line">group::---</span><br><span class="line">mask::r--</span><br><span class="line">other::---</span><br></pre></td></tr></table></figure><ul class="lvl-0"><li class="lvl-2"><p>user02测试是否能读（可以）、写文件（不可以）</p></li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[root@txy201-51 data]<span class="comment"># su user02</span></span><br><span class="line">[user02@txy201-51 data]$ <span class="built_in">cat</span> acltest</span><br><span class="line">51yunwei.top</span><br><span class="line">[user02@txy201-51 data]$ <span class="built_in">echo</span> www.51yunwei.top &gt;&gt; acltest</span><br><span class="line">bash: acltest: 权限不够</span><br></pre></td></tr></table></figure><ul class="lvl-0"><li class="lvl-2"><p>修改user02的权限为读写</p></li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[root@txy201-51 data]<span class="comment"># setfacl -m user02:rw acltest</span></span><br><span class="line">[root@txy201-51 data]<span class="comment"># su user02</span></span><br><span class="line">[user02@txy201-51 data]$ <span class="built_in">echo</span> www.51yunwei.top &gt;&gt; acltest</span><br><span class="line">[user02@txy201-51 data]$ <span class="built_in">cat</span> acltest</span><br><span class="line">51yunwei.top</span><br><span class="line">www.51yunwei.top</span><br></pre></td></tr></table></figure><ul class="lvl-0"><li class="lvl-2"><p>删除权限</p></li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">[root@txy201-51 data]<span class="comment"># setfacl -x user02 acltest</span></span><br><span class="line">[root@txy201-51 data]<span class="comment"># getfacl acltest</span></span><br><span class="line"><span class="comment"># file: acltest</span></span><br><span class="line"><span class="comment"># owner: user01</span></span><br><span class="line"><span class="comment"># group: user01</span></span><br><span class="line">user::rw-</span><br><span class="line">group::---</span><br><span class="line">mask::r--</span><br><span class="line">other::---</span><br></pre></td></tr></table></figure><h2 id="组权限">组权限</h2><p>setfacl默认对用户acl进行管理，如果要为组设置acl，只需要加上一个组的标识<code>g:</code>即可。</p><ul class="lvl-0"><li class="lvl-2"><p>当前user03没有访问权限</p></li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[root@txy201-51 data]<span class="comment"># id user03</span></span><br><span class="line">uid=1005(user03) gid=1006(user03) 组=1006(user03),1004(user01)</span><br><span class="line">[root@txy201-51 data]<span class="comment"># su user03</span></span><br><span class="line">[user03@txy201-51 data]$ <span class="built_in">cat</span> acltest</span><br><span class="line"><span class="built_in">cat</span>: acltest: 权限不够</span><br></pre></td></tr></table></figure><ul class="lvl-0"><li class="lvl-2"><p>给user01组设置权限后，user03就能访问文件了（user03也在user01组）</p></li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[root@txy201-51 data]<span class="comment"># setfacl -m g:user01:r acltest</span></span><br><span class="line">[root@txy201-51 data]<span class="comment"># su user03</span></span><br><span class="line">[user03@txy201-51 data]$ <span class="built_in">cat</span> acltest</span><br><span class="line">51yunwei.top</span><br><span class="line">www.51yunwei.top</span><br></pre></td></tr></table></figure><h1>系统文件权限的备份与恢复</h1><p>在运维过程中，最怕误操作将全局的文件权限给修改了，比如执行了<code>chmod 777 -R /</code>或<code>chown -R user01:user01 /</code>，那如果真的遇到了这种情况我们应该怎么做呢？在日常运维中，我们可以把系统权限信息进行备份，在必要时进行恢复。</p><ul class="lvl-0"><li class="lvl-2"><p>备份文件权限</p></li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">getfacl -p &gt; 备份文件</span><br></pre></td></tr></table></figure><ul class="lvl-0"><li class="lvl-2"><p>恢复文件权限</p></li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">setfacl --restore=备份的文件</span><br></pre></td></tr></table></figure><h2 id="实战篇">实战篇</h2><ul class="lvl-0"><li class="lvl-2"><p>实验目录<code>/tmp/data</code>，文件结构如下</p></li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">[root@txy201-51 data]<span class="comment"># ls -lR</span></span><br><span class="line">.:</span><br><span class="line">总用量 8</span><br><span class="line">-rw-r-----+ 1 user01 user01   30 6月  20 16:13 acltest</span><br><span class="line">drwxr-xr-x  2 root   root   4096 6月  20 16:30 yunwei</span><br><span class="line"></span><br><span class="line">./yunwei:</span><br><span class="line">总用量 0</span><br><span class="line">-rw-r--r-- 1 root root 0 6月  20 16:30 51yunwei</span><br><span class="line">-rw-r--r-- 1 root root 0 6月  20 16:30 top</span><br><span class="line">-rw-r--r-- 1 root root 0 6月  20 16:30 www</span><br><span class="line">[root@txy201-51 data]<span class="comment">#</span></span><br></pre></td></tr></table></figure><ul class="lvl-0"><li class="lvl-2"><p>将目录的权限备份到<code>tmp_data_acl.bak下</code></p></li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@txy201-51 data]<span class="comment"># getfacl -R -p /tmp/data &gt; tmp_data_acl.bak</span></span><br></pre></td></tr></table></figure><ul class="lvl-0"><li class="lvl-2"><p>模拟误操作，修改目录下的所有权限和属主</p></li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">[root@txy201-51 data]<span class="comment"># chown user01:user01 -R /tmp/data</span></span><br><span class="line">[root@txy201-51 data]<span class="comment"># chmod 400 -R /tmp/data</span></span><br><span class="line">[root@txy201-51 data]<span class="comment"># ls -lR</span></span><br><span class="line">.:</span><br><span class="line">总用量 12</span><br><span class="line">-r--------+ 1 user01 user01   30 6月  20 16:13 acltest</span><br><span class="line">-r--------  1 user01 user01  670 6月  20 17:24 tmp_data_acl.bak</span><br><span class="line">dr--------  2 user01 user01 4096 6月  20 16:30 yunwei</span><br><span class="line"></span><br><span class="line">./yunwei:</span><br><span class="line">总用量 0</span><br><span class="line">-r-------- 1 user01 user01 0 6月  20 16:30 51yunwei</span><br><span class="line">-r-------- 1 user01 user01 0 6月  20 16:30 top</span><br><span class="line">-r-------- 1 user01 user01 0 6月  20 16:30 www</span><br><span class="line">[root@txy201-51 data]<span class="comment">#</span></span><br></pre></td></tr></table></figure><ul class="lvl-0"><li class="lvl-2"><p>恢复权限，可以看到权限已恢复正常。</p></li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">[root@txy201-51 data]<span class="comment"># setfacl --restore=tmp_data_acl.bak</span></span><br><span class="line">[root@txy201-51 data]<span class="comment"># ls -lR</span></span><br><span class="line">.:</span><br><span class="line">总用量 12</span><br><span class="line">-rw-rw----+ 1 user01 user01   30 6月  20 16:13 acltest</span><br><span class="line">-rw-r--r--  1 root   root    670 6月  20 17:24 tmp_data_acl.bak</span><br><span class="line">drwxr-xr-x  2 root   root   4096 6月  20 16:30 yunwei</span><br><span class="line"></span><br><span class="line">./yunwei:</span><br><span class="line">总用量 0</span><br><span class="line">-rw-r--r-- 1 root root 0 6月  20 16:30 51yunwei</span><br><span class="line">-rw-r--r-- 1 root root 0 6月  20 16:30 top</span><br><span class="line">-rw-r--r-- 1 root root 0 6月  20 16:30 www</span><br><span class="line">[root@txy201-51 data]<span class="comment">#</span></span><br></pre></td></tr></table></figure><blockquote><p>如果没有提前备份的话，可以同其它相同系统做一次备份，将文件拷贝过来做恢复，对于没在备份中的文件，权限不会被修改。</p></blockquote>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;在Linux中，一般使用&lt;code&gt;chmod&lt;/code&gt;命令对属主、用户组、其它用户为类别对文件权限进行控制，这种方式较为粗略，但也能满足日常需求。在一些特殊的场景中，如只允许某些用户能访问文件的场景，如果使用&lt;code&gt;chmod&lt;/code&gt;命令进行配置，一般是将这</summary>
      
    
    
    
    <category term="Linux" scheme="https://www.esearch.top/categories/Linux/"/>
    
    
    <category term="Linux" scheme="https://www.esearch.top/tags/Linux/"/>
    
    <category term="权限" scheme="https://www.esearch.top/tags/%E6%9D%83%E9%99%90/"/>
    
  </entry>
  
  <entry>
    <title>Linux中的用户ID会不会重复？</title>
    <link href="https://www.esearch.top/posts/a0e0543a/"/>
    <id>https://www.esearch.top/posts/a0e0543a/</id>
    <published>2024-06-18T03:13:16.000Z</published>
    <updated>2024-06-20T09:30:53.493Z</updated>
    
    <content type="html"><![CDATA[<p><code>UID</code>指的是用户的<code>ID</code>(User ID)，一个用户的UID标识一个给定用户，UID是用户的唯一标识符，通过UID可以区分不同的用户类别，比如UID为0的是超级用户，UID为1000-600000之间的是普通用户，而UID为1-999之间的是虚拟用户。</p><ul class="lvl-0"><li class="lvl-2">超级用户：也称为root用户，UID为0，拥有系统的完全控制权限，可以进行修改、删除文件等操作。</li><li class="lvl-2">普通用户：也成为一般用户，UID为1000-60000之间，可以对自己目录下的文件进行访问和修改，也可以对经过授权的文件进行访问。</li><li class="lvl-2">虚拟用户：也称为系统用户，UID为1-999之间，不提供密码登录系统，它们的存在主要是为了方便系统的管理。</li></ul><p>Linux中的用户ID会不会重复？会，可以人为将多个不用户的ID配置为重复的ID。</p><p><strong>用户在登录系统时，是通过UID来区分用户，而不是通过用户名来区分</strong><br>实验步骤：<br>1、创建一个UID为1000的用户user02，再创建一个相同id的user01，通过id命令，发现两个用户都显示为user02</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[root@kvm-hkcloud01 ~]<span class="comment"># useradd -u 1000 user02</span></span><br><span class="line">[root@kvm-hkcloud01 ~]<span class="comment"># useradd -u 1000 -o user01</span></span><br><span class="line">[root@kvm-hkcloud01 ~]<span class="comment"># id user01</span></span><br><span class="line">uid=1000(user02) gid=1002(user02) <span class="built_in">groups</span>=1002(user02)</span><br><span class="line">[root@kvm-hkcloud01 ~]<span class="comment"># id user02</span></span><br><span class="line">uid=1000(user02) gid=1002(user02) <span class="built_in">groups</span>=1002(user02)</span><br></pre></td></tr></table></figure><p>2、切换到user01下，发现名称还是user02，但是组信息变为了user01的</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[root@kvm-hkcloud01 ~]<span class="comment"># su - user01</span></span><br><span class="line">Last login: Tue Jun 18 11:35:27 CST 2024 on pts/0</span><br><span class="line">[user02@kvm-hkcloud01 ~]$ <span class="built_in">id</span></span><br><span class="line">uid=1000(user02) gid=1003(user01) <span class="built_in">groups</span>=1003(user01)</span><br><span class="line">[user02@kvm-hkcloud01 ~]$</span><br></pre></td></tr></table></figure><p>3、当user02的uid发生改变时，再查看user01的信息，因为没有重复的id的情况下，用户名就能正常的显示user01了</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[root@kvm-hkcloud01 ~]<span class="comment"># usermod -u 1001 user02</span></span><br><span class="line">[root@kvm-hkcloud01 ~]<span class="comment"># id user02</span></span><br><span class="line">uid=1001(user02) gid=1002(user02) <span class="built_in">groups</span>=1002(user02)</span><br><span class="line">[root@kvm-hkcloud01 ~]<span class="comment"># id user01</span></span><br><span class="line">uid=1000(user01) gid=1003(user01) <span class="built_in">groups</span>=1003(user01)</span><br></pre></td></tr></table></figure><p>4、当我再将user02的uid修改为1000的时候，再查看user01的信息，发现user01的用户名又显示为user02了</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[root@kvm-hkcloud01 ~]<span class="comment"># usermod -u 1000 -o user02</span></span><br><span class="line">[root@kvm-hkcloud01 ~]<span class="comment"># id user02</span></span><br><span class="line">uid=1000(user02) gid=1002(user02) <span class="built_in">groups</span>=1002(user02)</span><br><span class="line">[root@kvm-hkcloud01 ~]<span class="comment"># id user01</span></span><br><span class="line">uid=1000(user02) gid=1002(user02) <span class="built_in">groups</span>=1002(user02)</span><br></pre></td></tr></table></figure><p><strong>那么，当UID重复的时候，是谁决定了用哪个用户名作为显示呢？</strong><br>想一想，哪个文件记录了UID信息？没错,是<code>/etc/passwd</code>当我将user01和user02的行进行调转之后（user01）在前，使用id查看的时候，显示的用户名就是user01了</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 修改前</span></span><br><span class="line">[root@kvm-hkcloud01 ~]<span class="comment"># tail -n 2 /etc/passwd</span></span><br><span class="line">user02:x:1000:1002::/home/user02:/bin/bash</span><br><span class="line">user01:x:1000:1003::/home/user01:/bin/bash</span><br><span class="line">[root@kvm-hkcloud01 ~]<span class="comment"># id user01</span></span><br><span class="line">uid=1000(user02) gid=1002(user02) <span class="built_in">groups</span>=1002(user02)</span><br><span class="line">[root@kvm-hkcloud01 ~]<span class="comment"># id user02</span></span><br><span class="line">uid=1000(user02) gid=1002(user02) <span class="built_in">groups</span>=1002(user02)</span><br><span class="line">[root@kvm-hkcloud01 ~]<span class="comment"># vi /etc/passwd</span></span><br><span class="line"><span class="comment"># 修改后</span></span><br><span class="line">[root@kvm-hkcloud01 ~]<span class="comment"># tail -n 2 /etc/passwd</span></span><br><span class="line">user01:x:1000:1003::/home/user01:/bin/bash</span><br><span class="line">user02:x:1000:1002::/home/user02:/bin/bash</span><br><span class="line">[root@kvm-hkcloud01 ~]<span class="comment"># id user01</span></span><br><span class="line">uid=1000(user01) gid=1003(user01) <span class="built_in">groups</span>=1003(user01)</span><br><span class="line">[root@kvm-hkcloud01 ~]<span class="comment"># id user02</span></span><br><span class="line">uid=1000(user01) gid=1003(user01) <span class="built_in">groups</span>=1003(user01)</span><br><span class="line"></span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;&lt;code&gt;UID&lt;/code&gt;指的是用户的&lt;code&gt;ID&lt;/code&gt;(User ID)，一个用户的UID标识一个给定用户，UID是用户的唯一标识符，通过UID可以区分不同的用户类别，比如UID为0的是超级用户，UID为1000-600000之间的是普通用户，而UID为</summary>
      
    
    
    
    <category term="Linux" scheme="https://www.esearch.top/categories/Linux/"/>
    
    
    <category term="Linux基础" scheme="https://www.esearch.top/tags/Linux%E5%9F%BA%E7%A1%80/"/>
    
  </entry>
  
  <entry>
    <title>怎么判断多台虚拟机上的磁盘是不是同一块磁盘呢？</title>
    <link href="https://www.esearch.top/posts/b6ae4c2c/"/>
    <id>https://www.esearch.top/posts/b6ae4c2c/</id>
    <published>2024-05-31T08:30:15.000Z</published>
    <updated>2024-05-31T08:34:46.812Z</updated>
    
    <content type="html"><![CDATA[<p>在虚拟化环境上，有普通磁盘和共享磁盘，有时候进行扩容后，多台虚拟机上的磁盘大小一样，那怎么判断某个盘是不是共享磁盘呢？这时候我们可以使用<code>blkid</code>命令来查看。</p><p>命令输出结果如下，如果多台虚拟机输出的<code>uuid</code>是一样的，那这个磁盘就是共享磁盘了。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@txy201-51 tmp]<span class="comment"># blkid /dev/vda1</span></span><br><span class="line">/dev/vda1: UUID=<span class="string">&quot;4b499d76-769a-40a0-93dc-4a31a59add28&quot;</span> TYPE=<span class="string">&quot;ext4&quot;</span></span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;在虚拟化环境上，有普通磁盘和共享磁盘，有时候进行扩容后，多台虚拟机上的磁盘大小一样，那怎么判断某个盘是不是共享磁盘呢？这时候我们可以使用&lt;code&gt;blkid&lt;/code&gt;命令来查看。&lt;/p&gt;
&lt;p&gt;命令输出结果如下，如果多台虚拟机输出的&lt;code&gt;uuid&lt;/code&gt;是</summary>
      
    
    
    
    <category term="Linux" scheme="https://www.esearch.top/categories/Linux/"/>
    
    
    <category term="Linux基础" scheme="https://www.esearch.top/tags/Linux%E5%9F%BA%E7%A1%80/"/>
    
  </entry>
  
  <entry>
    <title>Linux中的软链接和硬链接</title>
    <link href="https://www.esearch.top/posts/83a68e5f/"/>
    <id>https://www.esearch.top/posts/83a68e5f/</id>
    <published>2024-05-31T07:48:29.000Z</published>
    <updated>2024-05-31T08:29:27.720Z</updated>
    
    <content type="html"><![CDATA[<p>在Linux中，可以使<code>ln</code>命令创建链接文件，默认是硬链接，如果加<code>-s</code>参数，就是创建软连接。</p><ul class="lvl-0"><li class="lvl-2">软链接：和Windows中的快捷方式差不多，这个链接文件指向源文件，和源文件不同，源文件被删除时，软链接文件无法访问。</li><li class="lvl-2">硬链接：硬链接更像是源文件的副本，这两个文件指向了相同的inode，源文件被删除时，inode的硬链接数不为0，数据不会删除，此时访问硬链接文件正常。</li></ul><h1>一、软链接和硬链接文件信息</h1><p>1、创建链接文件</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[root@txy201-51 tmp]<span class="comment"># echo 123 &gt; passwd</span></span><br><span class="line">[root@txy201-51 tmp]<span class="comment"># ln passwd link_h_passwd</span></span><br><span class="line">[root@txy201-51 tmp]<span class="comment"># ln -s passwd link_s_passwd</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><p>2、查看源文件信息，inode为51380</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">[root@txy201-51 tmp]<span class="comment"># stat passwd</span></span><br><span class="line">  文件：<span class="string">&quot;passwd&quot;</span></span><br><span class="line">  大小：16              块：8          IO 块：4096   普通文件</span><br><span class="line">设备：fd01h/64769d      Inode：51380       硬链接：2</span><br><span class="line">权限：(0644/-rw-r--r--)  Uid：(    0/    root)   Gid：(    0/    root)</span><br><span class="line">最近访问：2024-05-31 15:45:22.174997597 +0800</span><br><span class="line">最近更改：2024-05-31 15:45:21.844997227 +0800</span><br><span class="line">最近改动：2024-05-31 15:45:21.844997227 +0800</span><br><span class="line">创建时间：-</span><br><span class="line">[root@txy201-51 tmp]<span class="comment">#</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><p>3、查看硬链接文件，inode也是51380，和源文件指向了相同的inode，而且文件属性为普通文件，而不是链接文件。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">[root@txy201-51 tmp]<span class="comment"># stat link_h_passwd</span></span><br><span class="line">  文件：<span class="string">&quot;link_h_passwd&quot;</span></span><br><span class="line">  大小：16              块：8          IO 块：4096   普通文件</span><br><span class="line">设备：fd01h/64769d      Inode：51380       硬链接：2</span><br><span class="line">权限：(0644/-rw-r--r--)  Uid：(    0/    root)   Gid：(    0/    root)</span><br><span class="line">最近访问：2024-05-31 15:45:22.174997597 +0800</span><br><span class="line">最近更改：2024-05-31 15:45:21.844997227 +0800</span><br><span class="line">最近改动：2024-05-31 15:45:21.844997227 +0800</span><br><span class="line">创建时间：-</span><br><span class="line">[root@txy201-51 tmp]<span class="comment">#</span></span><br></pre></td></tr></table></figure><p>4、再看看软连接的状态,文件的大小、指向的inode和源文件不同，文件类型为符号链接</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">[root@txy201-51 tmp]<span class="comment"># stat link_s_passwd</span></span><br><span class="line">  文件：<span class="string">&quot;link_s_passwd&quot;</span> -&gt; <span class="string">&quot;passwd&quot;</span></span><br><span class="line">  大小：6               块：0          IO 块：4096   符号链接</span><br><span class="line">设备：fd01h/64769d      Inode：51379       硬链接：1</span><br><span class="line">权限：(0777/lrwxrwxrwx)  Uid：(    0/    root)   Gid：(    0/    root)</span><br><span class="line">最近访问：2024-05-31 15:38:40.578545132 +0800</span><br><span class="line">最近更改：2024-05-31 15:38:39.634544066 +0800</span><br><span class="line">最近改动：2024-05-31 15:38:39.634544066 +0800</span><br><span class="line">创建时间：-</span><br><span class="line">[root@txy201-51 tmp]<span class="comment">#</span></span><br></pre></td></tr></table></figure><h1>二、修改源文件，链接文件的变化</h1><p>1、修改源源文件，可以看到软链接和硬链接文件的内容也随之改变了</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">[root@txy201-51 tmp]<span class="comment"># echo 456 &gt; passwd</span></span><br><span class="line">[root@txy201-51 tmp]<span class="comment"># cat link_s_passwd</span></span><br><span class="line">456</span><br><span class="line">[root@txy201-51 tmp]<span class="comment"># cat link_h_passwd</span></span><br><span class="line">456</span><br><span class="line">[root@txy201-51 tmp]<span class="comment">#</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><p>2、修改软连接文件，可以看到源文件和硬链接文件也都发生了变化，因为软连接就是指向源文件的，可以理解为对源文件的修改。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[root@txy201-51 tmp]<span class="comment"># echo 789 &gt; link_s_passwd</span></span><br><span class="line">[root@txy201-51 tmp]<span class="comment"># cat passwd</span></span><br><span class="line">789</span><br><span class="line">[root@txy201-51 tmp]<span class="comment"># cat link_h_passwd</span></span><br><span class="line">789</span><br><span class="line">[root@txy201-51 tmp]<span class="comment">#</span></span><br></pre></td></tr></table></figure><p>3、修改硬链接文件，可以看到软链接和源文件的数据也发生了变化，因为修改硬链接，实际上修改的是inode块的数据，源文件指向的也是这个数据块，所以内容也会发生变化。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[root@txy201-51 tmp]<span class="comment"># echo &#x27;abc&#x27; &gt; link_h_passwd</span></span><br><span class="line">[root@txy201-51 tmp]<span class="comment"># cat passwd</span></span><br><span class="line">abc</span><br><span class="line">[root@txy201-51 tmp]<span class="comment"># cat link_s_passwd</span></span><br><span class="line">abc</span><br><span class="line">[root@txy201-51 tmp]<span class="comment">#</span></span><br></pre></td></tr></table></figure><h1>三、删除源文件对链接文件的影响</h1><p>1、删除源文件，软链接文件无法访问，硬链接文件访问正常</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[root@txy201-51 tmp]<span class="comment"># rm -f passwd</span></span><br><span class="line">[root@txy201-51 tmp]<span class="comment"># cat link_s_passwd</span></span><br><span class="line"><span class="built_in">cat</span>: link_s_passwd: 没有那个文件或目录</span><br><span class="line">[root@txy201-51 tmp]<span class="comment"># cat link_h_passwd</span></span><br><span class="line">abc</span><br><span class="line">[root@txy201-51 tmp]<span class="comment">#</span></span><br></pre></td></tr></table></figure><p>2、如果再创建一个和源文件一样的文件，可以看到软链接文件可以正常访问了，但是硬链接的数据和源文件不一致，你知道这是为什么吗？</p><blockquote><p>因为再次创建‘源’文件之后，‘源’文件的inode发生了变化，所以数据肯定不一致。而软连接是对路径的链接，只要这个路径在，就可以访问。</p></blockquote><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[root@txy201-51 tmp]<span class="comment"># echo 123 &gt; passwd</span></span><br><span class="line">[root@txy201-51 tmp]<span class="comment"># cat link_h_passwd</span></span><br><span class="line">abc</span><br><span class="line">[root@txy201-51 tmp]<span class="comment"># cat link_s_passwd</span></span><br><span class="line">123</span><br><span class="line">[root@txy201-51 tmp]<span class="comment">#</span></span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;在Linux中，可以使&lt;code&gt;ln&lt;/code&gt;命令创建链接文件，默认是硬链接，如果加&lt;code&gt;-s&lt;/code&gt;参数，就是创建软连接。&lt;/p&gt;
&lt;ul class=&quot;lvl-0&quot;&gt;
&lt;li class=&quot;lvl-2&quot;&gt;软链接：和Windows中的快捷方式差不多，这个</summary>
      
    
    
    
    <category term="Linux" scheme="https://www.esearch.top/categories/Linux/"/>
    
    
    <category term="Linux基础" scheme="https://www.esearch.top/tags/Linux%E5%9F%BA%E7%A1%80/"/>
    
  </entry>
  
  <entry>
    <title>openEuler中奇怪的网络管理服务</title>
    <link href="https://www.esearch.top/posts/4cf37030/"/>
    <id>https://www.esearch.top/posts/4cf37030/</id>
    <published>2024-05-30T09:11:31.000Z</published>
    <updated>2024-05-30T09:26:29.296Z</updated>
    
    <content type="html"><![CDATA[<p>openEuler中的网络服务</p><h1>管理网络服务</h1><p>openEuler没有network服务，当我修改了网卡配置文件之后，使用以下命令进行重启，报错<code>Failed to restart network.service: Unit network.service not found.</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost sshuser]<span class="comment"># systemctl restart network</span></span><br><span class="line">Failed to restart network.service: Unit network.service not found.</span><br><span class="line">[root@localhost sshuser]<span class="comment"># </span></span><br></pre></td></tr></table></figure><p>经过查询才知道，<code>EulerOS</code>没有<code>network</code>服务，而是使用<code>NetworkManager</code>管理网络服务，所以直接重启这个服务即可。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost sshuser]<span class="comment"># systemctl restart NetworkManager</span></span><br></pre></td></tr></table></figure><p>让我感觉到奇怪的点是，在系统中是可以查到<code>network</code>服务的，但用<code>systemctl</code>和<code>service</code>命令却管理不了它。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost sshuser]<span class="comment"># systemctl | grep network</span></span><br><span class="line">  sys-devices-pci0000:00-0000:00:12.0-virtio1-net-ens18.device                                             loaded active plugged   Virtio network device</span><br><span class="line">  sys-subsystem-net-devices-ens18.device                                                                   loaded active plugged   Virtio network device</span><br><span class="line">  network-online.target                                                                                    loaded active active    Network is Online</span><br><span class="line">  network-pre.target                                                                                       loaded active active    Preparation <span class="keyword">for</span> Network</span><br><span class="line">  network.target                                                                                           loaded active active    Network</span><br><span class="line">[root@localhost sshuser]<span class="comment"># </span></span><br></pre></td></tr></table></figure><h1>修改网卡配置</h1><p>第二个奇怪的点是，修改网卡配置文件，掩码只能使用<code>PEREFIX</code>来表示，不能使用<code>NETMASK</code>，不然IP地址修改不成功了</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">IPADDR=192.168.3.138</span><br><span class="line">PREFIX=24</span><br><span class="line">GATEWAY=192.168.3.1</span><br></pre></td></tr></table></figure><h1>查看IP的命令</h1><p>在<code>openEuler</code>中，除了可以使用<code>ip add</code>命令查看地址外，还可以使用<code>nmcli</code>命令查看，默认自带了这两个命令。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost network-scripts]<span class="comment"># nmcli dev show</span></span><br><span class="line">GENERAL.DEVICE:                         ens18</span><br><span class="line">GENERAL.TYPE:                           ethernet</span><br><span class="line">GENERAL.HWADDR:                         8E:F7:F5:E9:2A:78</span><br><span class="line">GENERAL.MTU:                            1500</span><br><span class="line">GENERAL.STATE:                          100 (connected)</span><br><span class="line">GENERAL.CONNECTION:                     ens18</span><br><span class="line">GENERAL.CON-PATH:                       /org/freedesktop/NetworkManager/ActiveConnection/1</span><br><span class="line">WIRED-PROPERTIES.CARRIER:               on</span><br><span class="line">IP4.ADDRESS[1]:                         192.168.3.138/24</span><br><span class="line">IP4.GATEWAY:                            192.168.3.1</span><br><span class="line">IP4.ROUTE[1]:                           dst = 0.0.0.0/0, nh = 192.168.3.1, mt = 100</span><br><span class="line">IP4.ROUTE[2]:                           dst = 192.168.3.0/24, nh = 0.0.0.0, mt = 100</span><br><span class="line">IP6.ADDRESS[1]:                         2409:8a55:8f2:xxa4:8cf7:fxxf:fxe9:xxx/64</span><br><span class="line">IP6.ADDRESS[2]:                         2409:8a55:8f2:xxa4:d4bb:e68f:cx3x:x/128</span><br><span class="line">IP6.ADDRESS[3]:                         fe80::8cf7:f5ff:fee9:2a78/64</span><br><span class="line">IP6.GATEWAY:                            fe80::1</span><br><span class="line">IP6.ROUTE[1]:                           dst = 2409:8a55:8f2:bca4::/64, nh = ::, mt = 100</span><br><span class="line">IP6.ROUTE[2]:                           dst = ::/0, nh = fe80::1, mt = 100</span><br><span class="line">IP6.ROUTE[3]:                           dst = 2409:8a55:8f2:bca4:d4bb:e68f:cb34:3/128, nh = ::, mt = 100</span><br><span class="line">IP6.ROUTE[4]:                           dst = fe80::/64, nh = ::, mt = 100</span><br><span class="line">IP6.DNS[1]:                             fe80::1</span><br><span class="line"></span><br><span class="line">GENERAL.DEVICE:                         lo</span><br><span class="line">GENERAL.TYPE:                           loopback</span><br><span class="line">GENERAL.HWADDR:                         00:00:00:00:00:00</span><br><span class="line">GENERAL.MTU:                            65536</span><br><span class="line">GENERAL.STATE:                          10 (unmanaged)</span><br><span class="line">GENERAL.CONNECTION:                     --</span><br><span class="line">GENERAL.CON-PATH:                       --</span><br><span class="line">IP4.ADDRESS[1]:                         127.0.0.1/8</span><br><span class="line">IP4.GATEWAY:                            --</span><br><span class="line">IP6.ADDRESS[1]:                         ::1/128</span><br><span class="line">IP6.GATEWAY:                            --</span><br><span class="line">IP6.ROUTE[1]:                           dst = ::1/128, nh = ::, mt = 256</span><br><span class="line">[root@localhost network-scripts]<span class="comment"># </span></span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;openEuler中的网络服务&lt;/p&gt;
&lt;h1&gt;管理网络服务&lt;/h1&gt;
&lt;p&gt;openEuler没有network服务，当我修改了网卡配置文件之后，使用以下命令进行重启，报错&lt;code&gt;Failed to restart network.service: Unit netw</summary>
      
    
    
    
    <category term="Linux" scheme="https://www.esearch.top/categories/Linux/"/>
    
    
    <category term="openEuler" scheme="https://www.esearch.top/tags/openEuler/"/>
    
  </entry>
  
  <entry>
    <title>给hexo主题添加代码块复制功能</title>
    <link href="https://www.esearch.top/posts/6646bad2/"/>
    <id>https://www.esearch.top/posts/6646bad2/</id>
    <published>2024-05-29T07:32:02.000Z</published>
    <updated>2024-08-29T02:15:44.948Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>适用于所有的Hexo主题</p></blockquote><h1>创建clipboard_use.js</h1><p>在<code>themes/xxx/source/js</code> 目录下，创建<code>clipboard_use.js</code>，添加内容如下</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">$(<span class="string">&quot;.highlight&quot;</span>).<span class="title function_">wrap</span>(<span class="string">&quot;&lt;div class=&#x27;code-wrapper&#x27; style=&#x27;position:relative&#x27;&gt;&lt;/div&gt;&quot;</span>);</span><br><span class="line"><span class="comment">/*页面载入完成后，创建复制按钮*/</span></span><br><span class="line">!<span class="keyword">function</span> (<span class="params">e, t, a</span>) &#123;</span><br><span class="line">    <span class="comment">/* code */</span></span><br><span class="line">    <span class="keyword">var</span> initCopyCode = <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">var</span> copyHtml = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">        copyHtml += <span class="string">&#x27;&lt;button class=&quot;btn-copy&quot; data-clipboard-snippet=&quot;&quot;&gt;&#x27;</span>;</span><br><span class="line">        copyHtml += <span class="string">&#x27;  &lt;i class=&quot;fa fa-clipboard&quot;&gt;&lt;/i&gt;&lt;span&gt;复制&lt;/span&gt;&#x27;</span>;</span><br><span class="line">        copyHtml += <span class="string">&#x27;&lt;/button&gt;&#x27;</span>;</span><br><span class="line">        <span class="comment">/* $(&quot;.highlight .code&quot;).before(copyHtml); */</span></span><br><span class="line"></span><br><span class="line">        $(<span class="string">&quot;.code-wrapper .highlight table&quot;</span>).<span class="title function_">before</span>(copyHtml);</span><br><span class="line">        <span class="keyword">var</span> clipboard = <span class="keyword">new</span> <span class="title class_">ClipboardJS</span>(<span class="string">&#x27;.btn-copy&#x27;</span>, &#123;</span><br><span class="line">            <span class="attr">target</span>: <span class="keyword">function</span> (<span class="params">trigger</span>) &#123;</span><br><span class="line">                <span class="keyword">var</span> tablee = trigger.<span class="property">nextElementSibling</span>;</span><br><span class="line">               &lt;!--  <span class="keyword">return</span> trigger.<span class="property">nextElementSibling</span>; --&gt;</span><br><span class="line">                <span class="keyword">return</span> tablee.<span class="property">firstElementChild</span>.<span class="property">firstElementChild</span>.<span class="property">firstElementChild</span>.<span class="property">nextElementSibling</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">        clipboard.<span class="title function_">on</span>(<span class="string">&#x27;success&#x27;</span>, <span class="keyword">function</span> (<span class="params">e</span>) &#123;</span><br><span class="line">            e.<span class="property">trigger</span>.<span class="property">innerHTML</span> = <span class="string">&quot;&lt;i class=&#x27;fa fa-clipboard&#x27;&gt;&lt;/i&gt;&lt;span&gt;复制成功&lt;/span&gt;&quot;</span></span><br><span class="line">            <span class="built_in">setTimeout</span>(<span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">                e.<span class="property">trigger</span>.<span class="property">innerHTML</span> = <span class="string">&quot;&lt;i class=&#x27;fa fa-clipboard&#x27;&gt;&lt;/i&gt;&lt;span&gt;复制&lt;/span&gt;&quot;</span></span><br><span class="line">            &#125;, <span class="number">1000</span>)</span><br><span class="line">           </span><br><span class="line">            e.<span class="title function_">clearSelection</span>();</span><br><span class="line">        &#125;);</span><br><span class="line">        clipboard.<span class="title function_">on</span>(<span class="string">&#x27;error&#x27;</span>, <span class="keyword">function</span> (<span class="params">e</span>) &#123;</span><br><span class="line">            e.<span class="property">trigger</span>.<span class="property">innerHTML</span> = <span class="string">&quot;&lt;i class=&#x27;fa fa-clipboard&#x27;&gt;&lt;/i&gt;&lt;span&gt;复制失败&lt;/span&gt;&quot;</span></span><br><span class="line">            <span class="built_in">setTimeout</span>(<span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">                e.<span class="property">trigger</span>.<span class="property">innerHTML</span> = <span class="string">&quot;&lt;i class=&#x27;fa fa-clipboard&#x27;&gt;&lt;/i&gt;&lt;span&gt;复制&lt;/span&gt;&quot;</span></span><br><span class="line">            &#125;, <span class="number">1000</span>)</span><br><span class="line">            e.<span class="title function_">clearSelection</span>();</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="title function_">initCopyCode</span>();</span><br><span class="line">&#125;(<span class="variable language_">window</span>, <span class="variable language_">document</span>);</span><br></pre></td></tr></table></figure><h1>添加CSS</h1><p>在<code>theme/xxx/source/css/style.css</code>样式中添加如下代码：</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* 代码块复制按钮 */</span></span><br><span class="line"><span class="selector-class">.btn-copy</span> &#123;</span><br><span class="line">    <span class="attribute">display</span>: inline-block;</span><br><span class="line">    <span class="attribute">cursor</span>: pointer;</span><br><span class="line">    <span class="attribute">background-color</span>: <span class="number">#eee</span>;</span><br><span class="line">    <span class="attribute">background-image</span>: <span class="built_in">linear-gradient</span>(<span class="number">#fcfcfc</span>, <span class="number">#eee</span>);</span><br><span class="line">    <span class="attribute">border</span>: <span class="number">1px</span> solid <span class="number">#d5d5d5</span>;</span><br><span class="line">    <span class="attribute">border-radius</span>: <span class="number">3px</span>;</span><br><span class="line">    -webkit-user-select: none;</span><br><span class="line">    -moz-user-select: none;</span><br><span class="line">    -ms-user-select: none;</span><br><span class="line">    user-select: none;</span><br><span class="line">    -webkit-appearance: none;</span><br><span class="line">    <span class="attribute">font-size</span>: <span class="number">13px</span>;</span><br><span class="line">    <span class="attribute">font-weight</span>: <span class="number">700</span>;</span><br><span class="line">    <span class="attribute">line-height</span>: <span class="number">20px</span>;</span><br><span class="line">    <span class="attribute">color</span>: <span class="number">#333</span>;</span><br><span class="line">    -webkit-<span class="attribute">transition</span>: opacity .<span class="number">3s</span> ease-in-out;</span><br><span class="line">    -o-<span class="attribute">transition</span>: opacity .<span class="number">3s</span> ease-in-out;</span><br><span class="line">    <span class="attribute">transition</span>: opacity .<span class="number">3s</span> ease-in-out;</span><br><span class="line">    <span class="attribute">padding</span>: <span class="number">2px</span> <span class="number">6px</span>;</span><br><span class="line">    <span class="attribute">position</span>: absolute;</span><br><span class="line">    <span class="attribute">right</span>: <span class="number">5px</span>;</span><br><span class="line">    <span class="attribute">top</span>: <span class="number">5px</span>;</span><br><span class="line">    <span class="attribute">opacity</span>: <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.btn-copy</span> <span class="selector-tag">span</span> &#123;</span><br><span class="line">    <span class="attribute">margin-left</span>: <span class="number">5px</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.code-wrapper</span><span class="selector-pseudo">:hover</span> <span class="selector-class">.btn-copy</span> &#123;</span><br><span class="line">    <span class="attribute">opacity</span>: <span class="number">1</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1>引入font-awesome</h1><p>按钮上面添加了一个小图标美化，需要引入font-awesome.<br>在<code>themes\xxx\layout\_partial\head.ejs</code>或<code>themes\xxx\layout\_common\head.ejs</code>中的<code>&lt;/head&gt;</code>之前添加</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">&quot;stylesheet&quot;</span> <span class="attr">type</span>=<span class="string">&quot;text/css&quot;</span> <span class="attr">href</span>=<span class="string">&quot;//cdn.bootcss.com/font-awesome/4.6.3/css/font-awesome.min.css&quot;</span>&gt;</span></span><br></pre></td></tr></table></figure><h1>引用其他js</h1><p>在<code>themes\xxx\layout\layout.ejs</code>文件中的<code>&lt;/body&gt;</code>标签前也就是<code>body</code>标签之间的最后加入如下代码,这里是将<code>clipboard.min.js</code>和<code>clipboard-use.js</code>保存到CDN上，通过远程引用 或者将他们直接下载到本地直接引用也可</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 代码块复制功能 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">&quot;text/javascript&quot;</span> <span class="attr">src</span>=<span class="string">&quot;https://cdn.jsdelivr.net/npm/clipboard@2.0.4/dist/clipboard.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">&quot;text/javascript&quot;</span> <span class="attr">src</span>=<span class="string">&quot;https://apps.bdimg.com/libs/jquery/2.1.4/jquery.min.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">&quot;text/javascript&quot;</span> <span class="attr">src</span>=<span class="string">&quot;/js/clipboard_use.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure><h1>部署</h1><p>最后就可以使用hexo提交就行啦</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hexo g -d</span><br></pre></td></tr></table></figure><p>参考资料</p><blockquote><ul class="lvl-1"><li class="lvl-2"><p><a href="https://www.ikaqiu.top/posts/f623adca.html">为Hexo主题增加代码块复制功能</a></p></li></ul></blockquote>]]></content>
    
    
      
      
    <summary type="html">&lt;blockquote&gt;
&lt;p&gt;适用于所有的Hexo主题&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h1&gt;创建clipboard_use.js&lt;/h1&gt;
&lt;p&gt;在&lt;code&gt;themes/xxx/source/js&lt;/code&gt; 目录下，创建&lt;code&gt;clipboard_use.j</summary>
      
    
    
    
    <category term="博客搭建" scheme="https://www.esearch.top/categories/%E5%8D%9A%E5%AE%A2%E6%90%AD%E5%BB%BA/"/>
    
    
    <category term="hexo" scheme="https://www.esearch.top/tags/hexo/"/>
    
  </entry>
  
  <entry>
    <title>当前博客使用主题及部署方式</title>
    <link href="https://www.esearch.top/posts/6646bad1/"/>
    <id>https://www.esearch.top/posts/6646bad1/</id>
    <published>2024-05-29T03:39:06.000Z</published>
    <updated>2024-08-29T02:15:26.563Z</updated>
    
    <content type="html"><![CDATA[<p>当前使用的主题是<code>Wikitten</code></p><p>部署文档链接如下：</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://github.com/zthxxx/hexo-theme-Wikitten/blob/master/README_zh-CN.md</span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;当前使用的主题是&lt;code&gt;Wikitten&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;部署文档链接如下：&lt;/p&gt;
&lt;figure class=&quot;highlight html&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1</summary>
      
    
    
    
    <category term="博客搭建" scheme="https://www.esearch.top/categories/%E5%8D%9A%E5%AE%A2%E6%90%AD%E5%BB%BA/"/>
    
    
  </entry>
  
  <entry>
    <title>清除模态框form的内容</title>
    <link href="https://www.esearch.top/posts/6646bac7/"/>
    <id>https://www.esearch.top/posts/6646bac7/</id>
    <published>2024-04-19T00:38:14.000Z</published>
    <updated>2024-08-29T02:14:15.786Z</updated>
    
    <content type="html"><![CDATA[<p>在模态框提交数据后，页面不刷新的情况下，再次点击模态框，上次输入的内容还保留着，可以通过下面的方式清除模态框内容</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 在ajax返回成功时可以执行</span></span><br><span class="line">$(<span class="string">&#x27;.modal-body&#x27;</span>).<span class="title function_">find</span>(<span class="string">&#x27;form&#x27;</span>).<span class="title function_">trigger</span>(<span class="string">&#x27;reset&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 如果在用户点击关闭时也要执行，可以在show.bs.modal事件里设置</span></span><br><span class="line"> $(<span class="string">&#x27;#updatemodal&#x27;</span>).<span class="title function_">on</span>(<span class="string">&#x27;show.bs.modal&#x27;</span>, <span class="keyword">function</span> (<span class="params">event</span>) &#123;</span><br><span class="line">    $(<span class="string">&#x27;.modal-body&#x27;</span>).<span class="title function_">find</span>(<span class="string">&#x27;form&#x27;</span>).<span class="title function_">trigger</span>(<span class="string">&#x27;reset&#x27;</span>);</span><br><span class="line">    <span class="comment">// 其他内容</span></span><br><span class="line"> &#125;)</span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;在模态框提交数据后，页面不刷新的情况下，再次点击模态框，上次输入的内容还保留着，可以通过下面的方式清除模态框内容&lt;/p&gt;
&lt;figure class=&quot;highlight javascript&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;spa</summary>
      
    
    
    
    <category term="前端学习" scheme="https://www.esearch.top/categories/%E5%89%8D%E7%AB%AF%E5%AD%A6%E4%B9%A0/"/>
    
    
    <category term="adminlte" scheme="https://www.esearch.top/tags/adminlte/"/>
    
  </entry>
  
  <entry>
    <title>modal中使用form</title>
    <link href="https://www.esearch.top/posts/6646bac6/"/>
    <id>https://www.esearch.top/posts/6646bac6/</id>
    <published>2024-04-18T02:14:04.000Z</published>
    <updated>2024-08-29T02:13:59.277Z</updated>
    
    <content type="html"><![CDATA[<ul class="lvl-0"><li class="lvl-2"><p>html</p></li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 更新进展Modal --&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;modal fade&quot;</span> <span class="attr">id</span>=<span class="string">&quot;updatemodal&quot;</span> <span class="attr">data-backdrop</span>=<span class="string">&quot;static&quot;</span> <span class="attr">tabindex</span>=<span class="string">&quot;-1&quot;</span> <span class="attr">role</span>=<span class="string">&quot;dialog&quot;</span> <span class="attr">aria-labelledby</span>=<span class="string">&quot;staticBackdropLabel&quot;</span> <span class="attr">aria-hidden</span>=<span class="string">&quot;true&quot;</span> <span class="attr">name</span>=<span class="string">&quot;updatemodal&quot;</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;modal-dialog modal-xl&quot;</span> <span class="attr">role</span>=<span class="string">&quot;document&quot;</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;modal-content&quot;</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;modal-header&quot;</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">h5</span> <span class="attr">class</span>=<span class="string">&quot;modal-title&quot;</span> <span class="attr">id</span>=<span class="string">&quot;staticBackdropLabel&quot;</span>&gt;</span>更新代办事件<span class="tag">&lt;/<span class="name">h5</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">button</span> <span class="attr">type</span>=<span class="string">&quot;button&quot;</span> <span class="attr">class</span>=<span class="string">&quot;close&quot;</span> <span class="attr">data-dismiss</span>=<span class="string">&quot;modal&quot;</span> <span class="attr">aria-label</span>=<span class="string">&quot;Close&quot;</span>&gt;</span></span><br><span class="line">             <span class="tag">&lt;<span class="name">span</span> <span class="attr">aria-hidden</span>=<span class="string">&quot;true&quot;</span>&gt;</span><span class="symbol">&amp;times;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;modal-body&quot;</span>&gt;</span></span><br><span class="line">          <span class="comment">&lt;!--编辑框开始--&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;card card-primary&quot;</span>&gt;</span></span><br><span class="line">             <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;card-header&quot;</span>&gt;</span></span><br><span class="line">               <span class="tag">&lt;<span class="name">h3</span> <span class="attr">class</span>=<span class="string">&quot;card-title&quot;</span>&gt;</span>更新代办事件<span class="tag">&lt;/<span class="name">h3</span>&gt;</span></span><br><span class="line">             <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">             <span class="comment">&lt;!-- /.card-header --&gt;</span></span><br><span class="line">             <span class="comment">&lt;!-- form start --&gt;</span></span><br><span class="line">             <span class="tag">&lt;<span class="name">form</span> <span class="attr">id</span>=<span class="string">&quot;updateForm&quot;</span> <span class="attr">name</span>=<span class="string">&quot;updateForm&quot;</span> <span class="attr">novalidate</span>=<span class="string">&quot;novalidate&quot;</span>&gt;</span></span><br><span class="line">               <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;card-body&quot;</span>&gt;</span></span><br><span class="line">                 <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;form-group&quot;</span>&gt;</span></span><br><span class="line">                   <span class="tag">&lt;<span class="name">label</span> <span class="attr">for</span>=<span class="string">&quot;detail_title&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">style</span>=<span class="string">&quot;color: red;&quot;</span>&gt;</span>*<span class="tag">&lt;/<span class="name">a</span>&gt;</span>进展标题<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">                   <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">name</span>=<span class="string">&quot;detail_title&quot;</span> <span class="attr">class</span>=<span class="string">&quot;form-control&quot;</span> <span class="attr">id</span>=<span class="string">&quot;detail_title&quot;</span>&gt;</span></span><br><span class="line">                 <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">                 <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;form-group&quot;</span> <span class="attr">data-select2-id</span>=<span class="string">&quot;29&quot;</span>&gt;</span></span><br><span class="line">                 <span class="tag">&lt;<span class="name">label</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">style</span>=<span class="string">&quot;color: red;&quot;</span>&gt;</span>*<span class="tag">&lt;/<span class="name">a</span>&gt;</span>事件状态<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">                 <span class="tag">&lt;<span class="name">select</span> <span class="attr">class</span>=<span class="string">&quot;form-control select2 select2-danger select2-hidden-accessible&quot;</span> <span class="attr">data-dropdown-css-class</span>=<span class="string">&quot;select2-danger&quot;</span> <span class="attr">style</span>=<span class="string">&quot;width: 100%;&quot;</span> <span class="attr">data-select2-id</span>=<span class="string">&quot;12&quot;</span> <span class="attr">tabindex</span>=<span class="string">&quot;-1&quot;</span> <span class="attr">aria-hidden</span>=<span class="string">&quot;true&quot;</span> <span class="attr">id</span>=<span class="string">&quot;event_status&quot;</span> <span class="attr">name</span>=<span class="string">&quot;event_status&quot;</span>&gt;</span></span><br><span class="line">                   <span class="tag">&lt;<span class="name">option</span> <span class="attr">selected</span>=<span class="string">&quot;selected&quot;</span> <span class="attr">data-select2-id</span>=<span class="string">&quot;14&quot;</span> <span class="attr">value</span>=<span class="string">&#x27;0&#x27;</span>&gt;</span>未完成<span class="tag">&lt;/<span class="name">option</span>&gt;</span></span><br><span class="line">                   <span class="tag">&lt;<span class="name">option</span> <span class="attr">data-select2-id</span>=<span class="string">&quot;35&quot;</span> <span class="attr">value</span>=<span class="string">&#x27;1&#x27;</span>&gt;</span>完成<span class="tag">&lt;/<span class="name">option</span>&gt;</span></span><br><span class="line">                   <span class="tag">&lt;<span class="name">option</span> <span class="attr">data-select2-id</span>=<span class="string">&quot;36&quot;</span> <span class="attr">value</span>=<span class="string">&#x27;2&#x27;</span>&gt;</span>终止<span class="tag">&lt;/<span class="name">option</span>&gt;</span></span><br><span class="line">                 <span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line">               <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">                 <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;form-group&quot;</span>&gt;</span></span><br><span class="line">                   <span class="tag">&lt;<span class="name">label</span> <span class="attr">for</span>=<span class="string">&quot;detail_content&quot;</span>&gt;</span>详细信息(选填)<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">                   <span class="tag">&lt;<span class="name">textarea</span> <span class="attr">id</span>=<span class="string">&quot;detail_content&quot;</span> <span class="attr">class</span>=<span class="string">&quot;form-control&quot;</span> <span class="attr">name</span>=<span class="string">&quot;detail_content&quot;</span> <span class="attr">rows</span>=<span class="string">&quot;4&quot;</span> <span class="attr">cols</span>=<span class="string">&quot;50&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">textarea</span>&gt;</span></span><br><span class="line">                 <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">               <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">               <span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line">               <span class="comment">&lt;!-- /.card-body --&gt;</span></span><br><span class="line">           <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">          <span class="comment">&lt;!--编辑框结束--&gt;</span></span><br><span class="line">         <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;modal-footer&quot;</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">button</span> <span class="attr">type</span>=<span class="string">&quot;button&quot;</span> <span class="attr">class</span>=<span class="string">&quot;btn btn-secondary&quot;</span> <span class="attr">data-dismiss</span>=<span class="string">&quot;modal&quot;</span>&gt;</span>取消<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">button</span> <span class="attr">type</span>=<span class="string">&quot;submit&quot;</span> <span class="attr">class</span>=<span class="string">&quot;btn btn-primary&quot;</span>&gt;</span>更新<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        </span><br><span class="line">       <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">       </span><br><span class="line">     <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">   <span class="comment">&lt;!-- 更新进展Modal END Modal --&gt;</span></span><br></pre></td></tr></table></figure><ul class="lvl-0"><li class="lvl-2">js内容</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br></pre></td><td class="code"><pre><span class="line">  <span class="keyword">var</span> updateurl</span><br><span class="line">  $(<span class="string">&#x27;#updatemodal&#x27;</span>).<span class="title function_">on</span>(<span class="string">&#x27;show.bs.modal&#x27;</span>, <span class="keyword">function</span> (<span class="params">event</span>) &#123;</span><br><span class="line">    <span class="keyword">var</span> button = $(event.<span class="property">relatedTarget</span>) <span class="comment">// Button that triggered the modal</span></span><br><span class="line">    <span class="comment">//注意这里的whatever对应前面html代码中button标签下data-whatever属性的后半段</span></span><br><span class="line">    updateurl = button.<span class="title function_">data</span>(<span class="string">&#x27;url&#x27;</span>) <span class="comment">// Extract info from data-* attributes</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// var user = button.data(&#x27;user&#x27;)</span></span><br><span class="line">    <span class="comment">// If necessary, you could initiate an AJAX request here (and then do the updating in a callback).</span></span><br><span class="line">    <span class="comment">// Update the modal&#x27;s content. We&#x27;ll use jQuery here, but you could use a data binding library or other methods instead.</span></span><br><span class="line">    <span class="keyword">var</span> modal = $(<span class="variable language_">this</span>)</span><br><span class="line">    <span class="comment">//此处即为修改modal的标题</span></span><br><span class="line">    <span class="comment">// modal.find(&#x27;.modal-title&#x27;).text(&#x27;New message to &#x27; + recipient)</span></span><br><span class="line">    <span class="comment">// modal.find(&#x27;.modal-body input&#x27;).val(recipient)</span></span><br><span class="line">    <span class="comment">//modal.find(&#x27;.card-primary form&#x27;).attr(&quot;action&quot;,url)</span></span><br><span class="line">  &#125;)</span><br><span class="line">  $(<span class="string">&quot;.modal-footer button[type=&#x27;submit&#x27;]&quot;</span>).<span class="title function_">click</span>(<span class="keyword">function</span>(<span class="params">e</span>)&#123;</span><br><span class="line">    e.<span class="title function_">preventDefault</span>(); <span class="comment">// 阻止表单的默认提交行为</span></span><br><span class="line">    <span class="keyword">if</span> (!$(<span class="string">&quot;#updateForm&quot;</span>).<span class="title function_">valid</span>()) &#123;</span><br><span class="line">        <span class="comment">// 如果验证失败，返回false，不提交数据</span></span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="keyword">var</span> formData = $(<span class="string">&quot;#updateForm&quot;</span>).<span class="title function_">serialize</span>();</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;updateurl&#x27;</span>+updateurl)</span><br><span class="line">    $.<span class="title function_">ajax</span>(&#123;</span><br><span class="line">        <span class="attr">url</span>: updateurl, <span class="comment">// 你的请求地址</span></span><br><span class="line">        <span class="attr">type</span>: <span class="string">&quot;POST&quot;</span>, <span class="comment">// 请求类型，必须是POST</span></span><br><span class="line">        <span class="attr">data</span>: formData, <span class="comment">// 你的表单数据</span></span><br><span class="line">        <span class="attr">dataType</span>: <span class="string">&quot;json&quot;</span>, <span class="comment">// 返回的数据类型，必须是json</span></span><br><span class="line">        <span class="attr">success</span>: <span class="keyword">function</span>(<span class="params">data</span>)&#123;</span><br><span class="line">            <span class="keyword">if</span> (data.<span class="property">result</span> === <span class="number">0</span>) &#123;</span><br><span class="line">                <span class="comment">// 请求成功，显示消息</span></span><br><span class="line">                $(<span class="string">&quot;#updatemodal&quot;</span>).<span class="title function_">modal</span>(<span class="string">&#x27;hide&#x27;</span>)</span><br><span class="line">                toastr.<span class="title function_">success</span>(<span class="string">&#x27;成功：&#x27;</span>+data.<span class="property">message</span>)</span><br><span class="line">                <span class="built_in">setTimeout</span>(<span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">                    $(<span class="string">&#x27;#eventtable&#x27;</span>).<span class="title class_">DataTable</span>().<span class="property">ajax</span>.<span class="title function_">reload</span>();</span><br><span class="line"></span><br><span class="line">                &#125;, <span class="number">1000</span>)</span><br><span class="line">                </span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span> (data.<span class="property">result</span> === <span class="number">1</span>) &#123;</span><br><span class="line">                toastr.<span class="title function_">error</span>(<span class="string">&#x27;失败：&#x27;</span>+data.<span class="property">message</span>)</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">error</span>: <span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">            <span class="comment">// 请求失败的回调函数</span></span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;Error&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">$(<span class="string">&#x27;#updateForm&#x27;</span>).<span class="title function_">validate</span>(&#123;</span><br><span class="line">    <span class="attr">rules</span>: &#123;</span><br><span class="line">    </span><br><span class="line">    <span class="attr">detail_title</span>: &#123;</span><br><span class="line">        <span class="attr">required</span>: <span class="literal">true</span>,</span><br><span class="line">        <span class="attr">minlength</span>: <span class="number">5</span></span><br><span class="line">    &#125;,</span><br><span class="line">    </span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">messages</span>: &#123;</span><br><span class="line">    <span class="attr">detail_title</span>: &#123;</span><br><span class="line">        <span class="attr">required</span>: <span class="string">&quot;请输入更新标题&quot;</span>,</span><br><span class="line">    &#125;,</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">errorElement</span>: <span class="string">&#x27;span&#x27;</span>,</span><br><span class="line">    <span class="attr">errorPlacement</span>: <span class="keyword">function</span> (<span class="params">error, element</span>) &#123;</span><br><span class="line">    error.<span class="title function_">addClass</span>(<span class="string">&#x27;invalid-feedback&#x27;</span>);</span><br><span class="line">    element.<span class="title function_">closest</span>(<span class="string">&#x27;.form-group&#x27;</span>).<span class="title function_">append</span>(error);</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">highlight</span>: <span class="keyword">function</span> (<span class="params">element, errorClass, validClass</span>) &#123;</span><br><span class="line">    $(element).<span class="title function_">addClass</span>(<span class="string">&#x27;is-invalid&#x27;</span>);</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">unhighlight</span>: <span class="keyword">function</span> (<span class="params">element, errorClass, validClass</span>) &#123;</span><br><span class="line">    $(element).<span class="title function_">removeClass</span>(<span class="string">&#x27;is-invalid&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><ul class="lvl-0"><li class="lvl-2"><p>django内容</p></li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;a <span class="keyword">class</span>=<span class="string">&quot;btn btn-primary btn-sm &#123;disabled&#125;&quot;</span> data-url=<span class="string">&quot;&#123;reverse(&#x27;event:eventupdate&#x27;,kwargs=&#123;&#x27;id&#x27;:Event.id&#125;)&#125;&quot;</span> data-toggle=<span class="string">&quot;modal&quot;</span> data-target=<span class="string">&quot;#updatemodal&quot;</span>&gt;</span><br><span class="line">    &lt;i <span class="keyword">class</span>=<span class="string">&quot;fas fa-history&quot;</span>&gt;&lt;/i&gt;</span><br><span class="line">    &lt;/i&gt;</span><br><span class="line">    更新进展</span><br><span class="line">&lt;/a&gt;</span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;ul class=&quot;lvl-0&quot;&gt;
&lt;li class=&quot;lvl-2&quot;&gt;
&lt;p&gt;html&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;figure class=&quot;highlight html&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=</summary>
      
    
    
    
    <category term="前端" scheme="https://www.esearch.top/categories/%E5%89%8D%E7%AB%AF/"/>
    
    
    <category term="adminlte" scheme="https://www.esearch.top/tags/adminlte/"/>
    
  </entry>
  
  <entry>
    <title>adminlte中使用时间插件</title>
    <link href="https://www.esearch.top/posts/6646bac8/"/>
    <id>https://www.esearch.top/posts/6646bac8/</id>
    <published>2024-04-17T09:29:02.000Z</published>
    <updated>2024-08-29T02:14:33.667Z</updated>
    
    <content type="html"><![CDATA[<h1>daterangepicker</h1><ul class="lvl-0"><li class="lvl-2">引入文件，语言是由moment控制的</li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">&quot;stylesheet&quot;</span> <span class="attr">href</span>=<span class="string">&quot;&#123;% static &#x27;adminlte/plugins/daterangepicker/daterangepicker.css&#x27; %&#125;&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">&quot;stylesheet&quot;</span> <span class="attr">href</span>=<span class="string">&quot;&#123;% static &#x27;adminlte/plugins/tempusdominus-bootstrap-4/css/tempusdominus-bootstrap-4.min.css&#x27; %&#125;&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;&#123;% static &#x27;adminlte/plugins/moment/moment.min.js&#x27; %&#125;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;&#123;% static &#x27;adminlte/plugins/moment/locale/zh-cn.js&#x27; %&#125;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;&#123;% static &#x27;adminlte/plugins/tempusdominus-bootstrap-4/js/tempusdominus-bootstrap-4.min.js&#x27; %&#125;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;&#123;% static &#x27;adminlte/plugins/daterangepicker/daterangepicker.js&#x27; %&#125;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure><ul class="lvl-0"><li class="lvl-2">html</li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;form-group&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">label</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">style</span>=<span class="string">&quot;color: red;&quot;</span>&gt;</span>*<span class="tag">&lt;/<span class="name">a</span>&gt;</span>计划完成时间:<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;input-group date&quot;</span> <span class="attr">id</span>=<span class="string">&quot;reservationdatetime&quot;</span> <span class="attr">data-target-input</span>=<span class="string">&quot;nearest&quot;</span> &gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">class</span>=<span class="string">&quot;form-control datetimepicker-input&quot;</span> <span class="attr">data-target</span>=<span class="string">&quot;#reservationdatetime&quot;</span> <span class="attr">name</span>=<span class="string">&quot;event_deadline&quot;</span> <span class="attr">id</span>=<span class="string">&quot;event_deadline&quot;</span> <span class="attr">value</span>=<span class="string">&quot;&#123;&#123; event_deadline &#125;&#125;&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;input-group-append&quot;</span> <span class="attr">data-target</span>=<span class="string">&quot;#reservationdatetime&quot;</span> <span class="attr">data-toggle</span>=<span class="string">&quot;datetimepicker&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;input-group-text&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">i</span> <span class="attr">class</span>=<span class="string">&quot;fa fa-calendar&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">i</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure><ul class="lvl-0"><li class="lvl-2"><p>验证，选择的时间不能大于当前时间</p></li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 比较时间</span></span><br><span class="line">     $.validator.<span class="title function_">addMethod</span>(<span class="string">&quot;compareDate&quot;</span>, <span class="keyword">function</span>(<span class="params">value, element</span>) &#123;  </span><br><span class="line">         <span class="keyword">var</span> event_deadline = $(<span class="string">&quot;#event_deadline&quot;</span>).<span class="title function_">val</span>();                        </span><br><span class="line">         <span class="keyword">var</span> date1 = <span class="keyword">new</span> <span class="title class_">Date</span>(<span class="title class_">Date</span>.<span class="title function_">parse</span>(event_deadline.<span class="title function_">replace</span>(<span class="string">&quot;-&quot;</span>, <span class="string">&quot;/&quot;</span>))); </span><br><span class="line">         <span class="comment">// 和当前时间比较           </span></span><br><span class="line">         <span class="keyword">var</span> date2 = <span class="keyword">new</span> <span class="title class_">Date</span>();     </span><br><span class="line">         <span class="keyword">return</span> date1 &gt;= date2;        </span><br><span class="line">     &#125;,<span class="string">&quot;结束时间不能早于当前时间&quot;</span>);</span><br><span class="line">       <span class="comment">// 表单验证</span></span><br><span class="line">       $(<span class="string">&#x27;#editEventForm&#x27;</span>).<span class="title function_">validate</span>(&#123;</span><br><span class="line">         <span class="attr">rules</span>: &#123;</span><br><span class="line">           <span class="attr">event_deadline</span>: &#123;</span><br><span class="line">               <span class="attr">required</span>: <span class="literal">true</span>,</span><br><span class="line">               <span class="attr">compareDate</span>: <span class="literal">true</span>,</span><br><span class="line">           &#125;,</span><br><span class="line">         &#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h1&gt;daterangepicker&lt;/h1&gt;
&lt;ul class=&quot;lvl-0&quot;&gt;
&lt;li class=&quot;lvl-2&quot;&gt;引入文件，语言是由moment控制的&lt;/li&gt;
&lt;/ul&gt;
&lt;figure class=&quot;highlight html&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td cl</summary>
      
    
    
    
    <category term="前端学习" scheme="https://www.esearch.top/categories/%E5%89%8D%E7%AB%AF%E5%AD%A6%E4%B9%A0/"/>
    
    
    <category term="adminlte" scheme="https://www.esearch.top/tags/adminlte/"/>
    
  </entry>
  
</feed>
